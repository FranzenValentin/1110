!function(){var a={};let e;$(document).ready((function(){folderViewEnabled||disableFolders(),e=$("#campaigns").DataTable({language:dataTablesLanguage,serverSide:!0,stateSave:!0,stateDuration:0,responsive:!0,dom:dataTablesTemplate,stateLoadCallback:dataTableStateLoadCallback,stateSaveCallback:dataTableStateSaveCallback,filter:!1,searchDelay:3e3,order:[[0,"asc"]],ajax:{url:campaignSearchURL,data:function(a){$.extend(a,$("#campaigns").closest(".XiboGrid").find(".FilterDiv form").serializeObject())}},columns:[{data:"campaign",responsivePriority:2,render:dataTableSpacingPreformatted},...adCampaignEnabled?[{data:"type",responsivePriority:2,render:function(a,e){return"display"!==e?a:"list"===a?campaignPageTrans.list:"ad"===a?campaignPageTrans.ad:a}},{data:"startDt",responsivePriority:2,render:dataTableDateFromUnix},{data:"endDt",responsivePriority:2,render:dataTableDateFromUnix}]:[],{data:"numberLayouts",responsivePriority:2},...taggingEnabled?[{sortable:!1,responsivePriority:2,data:dataTableCreateTags}]:[],{data:"totalDuration",responsivePriority:2,render:dataTableTimeFromSeconds},{name:"cyclePlaybackEnabled",responsivePriority:3,data:function(a,e){if("display"!=e)return a.cyclePlaybackEnabled;let t="";return t=1==a.cyclePlaybackEnabled?"fa-check":"fa-times",'<span class="fa '+t+'"></span>'}},{name:"playCount",responsivePriority:3,data:function(a,e){return"display"!==e||a.playCount?a.playCount:""}},...adCampaignEnabled?[{data:"targetType",responsivePriority:3,render:function(a,e){return"plays"===a?campaignPageTrans.plays:"budget"===a?campaignPageTrans.budget:"imp"===a?campaignPageTrans.impressions:a}},{data:"target",responsivePriority:3},{data:"plays",responsivePriority:6},{data:"spend",responsivePriority:6},{data:"impressions",responsivePriority:6}]:[],{data:"ref1",responsivePriority:10,visible:!1},{data:"ref2",responsivePriority:10,visible:!1},{data:"ref3",responsivePriority:10,visible:!1},{data:"ref4",responsivePriority:10,visible:!1},{data:"ref5",responsivePriority:10,visible:!1},{data:"createdAt",responsivePriority:5,render:dataTableDateFromIso,visible:!1},{data:"modifiedAt",responsivePriority:5,render:dataTableDateFromIso,visible:!1},{data:"modifiedByName",responsivePriority:5,visible:!1},{orderable:!1,responsivePriority:1,data:dataTableButtonsColumn}]}),e.on("draw",dataTableDraw),e.on("draw",{form:$("#campaigns").closest(".XiboGrid").find(".FilterDiv form")},dataTableCreateTagEvents),e.on("processing.dt",dataTableProcessing),dataTableAddButtons(e,$("#campaigns_wrapper").find(".dataTables_buttons")),$("#refreshGrid").click((function(){e.ajax.reload()}))})),window.campaignAssignLayoutsFormOpen=function(a){formHelpers.setupCheckboxInputFields($(a).find("form:not(.form-inline)"),'input[name="cyclePlaybackEnabled"]',".cycle-based-playback",".no-cycle-based-playback");const e=templates.campaign.campaignAssignLayout,t=$(a).find(".layoutAssignFilterOptions");t.find("input#tags").attr("id","tagsFilter");const n=$("#layoutAssignments"),i=$("#LayoutAssignSortable"),s=function(){a.find('input[name="manageLayouts"]').val(1),i.find("li").each((function(a,e){$(e).find(".layout-order").html(a+1)}))},r=i.data("layouts");for(layoutIndex=0;layoutIndex<r.length;layoutIndex++){const a=r[layoutIndex],t=e({index:layoutIndex+1,layoutId:a.layoutId,layoutName:a.layout,locked:a.locked});$(t).appendTo("#LayoutAssignSortable")}const o=n.DataTable({language:dataTablesLanguage,serverSide:!0,stateSave:!0,stateDuration:0,pageLength:5,lengthMenu:[5,10,25,50],stateLoadCallback:dataTableStateLoadCallback,stateSaveCallback:dataTableStateSaveCallback,searchDelay:3e3,order:[[0,"asc"]],filter:!1,ajax:{url:layoutSearchURL+"?retired=0",data:function(a){$.extend(a,n.closest(".XiboGrid").find(".layoutAssignFilterOptions").find("input, select").serializeObject())}},columns:[{data:"layoutId"},{data:"layout",render:dataTableSpacingPreformatted},{name:"status",data:function(a,e){if("display"!=e)return a.status;let t="";return t=1==a.status?"fa-check":2==a.status?"fa-exclamation":3==a.status?"fa-cogs":"fa-times","<span class='fa "+t+"' title='"+a.statusDescription+(null==a.statusMessage?"":" - "+a.statusMessage)+"'></span>"}},{sortable:!1,data:function(a,e,t,n){return"display"!==e?"":'<a href="#" class="assignItem"><span class="fa fa-plus"></a>'}}]});o.on("draw",{form:n.closest(".XiboGrid").find("form")},(function(t,i){dataTableDraw(t,i),dataTableCreateTagEvents(t,i),n.find(".assignItem").on("click",(function(t){const n=o.row($(t.currentTarget).closest("tr")).data(),i=e({index:$("#LayoutAssignSortable").find("li").length+1,layoutId:n.layoutId,layoutName:n.layout,locked:!1});$(i).appendTo("#LayoutAssignSortable"),a.find('input[name="manageLayouts"]').val(1)}))})),o.on("processing.dt",dataTableProcessing),i.sortable({cancel:".ui-state-disabled",update:function(a,e){s()}}),i.on("click",".layout-remove",(function(a){$(a.currentTarget).parent().remove(),s()})),t.find("input, select").change((function(){o.ajax.reload()})),$(a).find(".nav-tabs a").on("shown.bs.tab",(function(a){"#tab-layouts"===$(a.target).attr("href")&&(t.find("input, select").prop("disabled",!1),o.columns.adjust().draw())}))},window.campaignFormSubmit=function(a){!function(a){if(1===parseInt(a.find('input[name="manageLayouts"]').val())){const e=[];$("#LayoutAssignSortable").find("li").each((function(a,t){e.push($(t).data("layoutId"))}));for(let t=0;t<e.length;t++)$("<input>").attr({type:"hidden",name:"layoutIds["+t+"]"}).val(e[t]).appendTo(a.find("#assignLayouts"))}}(a),$(".layoutAssignFilterOptions").find("input, select").prop("disabled",!0),a.submit()},window.campaignAddFormOpen=function(a){formHelpers.setupCheckboxInputFields($(a).find("form"),'input[name="cyclePlaybackEnabled"]',".cycle-based-playback",".no-cycle-based-playback");const e=$(a).find("select[name=type]"),t=$('input[name="cyclePlaybackEnabled"]');$(a).find(".campaign-type-ad").toggle("ad"===e.val()),e.on("change",(function(){$(a).find(".campaign-type-list").toggle("ad"!==e.val()),$(a).find(".campaign-type-ad").toggle("ad"===e.val()),$(a).find(".cycle-based-playback").toggle(t.is(":checked")&&"ad"!==e.val()),$(a).find(".no-cycle-based-playback").toggle(!t.is(":checked")&&"ad"!==e.val())}))},window.campaignAddFormSubmitCallback=function(a,e){a.success&&("ad"===a.data.type||XiboFormRender($(e).data("editFormUrl").replace(":id",a.data.campaignId)))};var t=window;for(var n in a)t[n]=a[n];a.__esModule&&Object.defineProperty(t,"__esModule",{value:!0})}();