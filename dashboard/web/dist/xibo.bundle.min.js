(function(){var __webpack_modules__={64720:function(e,t,a){const n=a(15234),o=a(95061);function i(e,t,a){let n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return"ne"===e&&""===t||"eq"===e&&a==t||"neq"===e&&a!=t||"gt"===e&&!Number.isNaN(parseInt(a))&&!Number.isNaN(parseInt(t))&&parseInt(a)>parseInt(t)||"lt"===e&&!Number.isNaN(parseInt(a))&&!Number.isNaN(parseInt(t))&&parseInt(a)<parseInt(t)||"egt"===e&&!Number.isNaN(parseInt(a))&&!Number.isNaN(parseInt(t))&&parseInt(a)>=parseInt(t)||"elt"===e&&!Number.isNaN(parseInt(a))&&!Number.isNaN(parseInt(t))&&parseInt(a)<=parseInt(t)||"isTopLevel"===e&&t==n}function r(e,t){const a=$(e).find(".controlDiv"),n=t.columns;n.push({name:"member",responsivePriority:2,data:function(n,o,i){if("display"!=o)return n;let r="";return void 0!==a.data().members&&null!=t.members[n[t.id]]?r=t.members[n[t.id]]?"checked":"":e.data().extra&&t.extra.forEach((function(e){e[t.id]==n[t.id]&&(r="checked")})),'<input type="checkbox" class="checkbox" data-member-id='+n[t.id]+' data-member-type="'+t.type+'" '+r+">"}});const o=$(t.tableName).DataTable({language:dataTablesLanguage,serverSide:!0,stateSave:!0,stateDuration:0,filter:!1,responsive:!0,searchDelay:3e3,order:[[1,"asc"]],ajax:{url:t.getUrl??a.data().getUrl,data:function(e){return $.extend(e,$(t.tableName).closest(".XiboGrid").find(".FilterDiv form").serializeObject()),e}},columns:n});o.on("draw",dataTableDraw),o.on("processing.dt",dataTableProcessing)}function l(e){const t=e.closest("tbody.feature-group");s(t.find("input[name='features[]']:checked").length,t.find("input[name='features[]']").length,t,".feature-select-all"),s(t.find("input.inherit-group:checked").length,t.find("input.inherit-group").length,t,".inherit-group-all")}function s(e,t,a,n){e<=0?a.find(n).prop("checked",!1).prop("indeterminate",!1):e===t?a.find(n).prop("checked",!0).prop("indeterminate",!1):a.find(n).prop("checked",!1).prop("indeterminate",!0)}window.forms={createFields:function(e,t,a,o){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],r=arguments.length>5?arguments[5]:void 0,l=arguments.length>6&&void 0!==arguments[6]&&arguments[6];for(const n in e)if(e.hasOwnProperty(n)){const s=e[n];if(!0===s.skip)continue;if(null===s.value&&void 0!==s.default&&(s.value=s.default),s.visibility.length){const e=[];for(let t=0;t<s.visibility.length;t++){const a=s.visibility[t],n={type:a.type,conditions:[]};for(let e=0;e<a.conditions.length;e++){const t=a.conditions[e];n.conditions.push({field:t.field,type:t.type,value:t.value})}e.push(n)}s.visibility=JSON.stringify(e)}if("datasetSelector"===s.type&&(s.datasetSearchUrl=urlsForApi.dataset.search.url,""==s.value?(s.initialValue=null,s.initialKey=null):(s.initialValue=s.value,s.initialKey="dataSetId")),"datasetField"===s.type&&(""==s.value?(s.initialValue=null,s.initialKey=null):(s.initialValue=s.value,s.initialKey="datasetField")),"menuBoardSelector"===s.type&&(s.menuBoardSearchUrl=urlsForApi.menuBoard.search.url,""==s.value?(s.initialValue=null,s.initialKey=null):(s.initialValue=s.value,s.initialKey="menuId")),"menuBoardCategorySelector"===s.type&&(s.menuBoardCategorySearchUrl=urlsForApi.menuBoard.categorySearch.url,""==s.value?(s.initialValue=null,s.initialKey=null):(s.initialValue=s.value,s.initialKey="menuCategoryId")),"mediaSelector"===s.type&&(s.mediaSearchUrl=urlsForApi.library.get.url,""==s.value?(s.initialValue=null,s.initialKey=null):(s.initialValue=s.value,s.initialKey="mediaId")),"fontSelector"===s.type&&(s.fontsSearchUrl=getFontsUrl+"?length=10000"),"commandSelector"===s.type&&(s.commandSearchUrl=urlsForApi.command.search.url,""==s.value?(s.initialValue=null,s.initialKey=null):(s.initialValue=s.value,s.initialKey="code")),"playlistMixer"===s.type&&(s.playlistId=o),"color"===s.type&&""!=s.format&&(s.colorFormat=s.format),"connectorProperties"===s.type&&(s.connectorPropertiesUrl=urlsForApi.connectorProperties.search.url.replace(":id",a)+"?propertyId="+s.id,""==s.value?(s.initialValue=null,s.initialKey=null):(s.initialValue=s.value,s.initialKey=s.id)),s.name=s.id,a&&(s.id=a+"_"+s.id),s.variant&&"autocomplete"===s.variant&&(s.isAutoComplete=!0),templates.forms.hasOwnProperty(s.type)){const e=$(templates.forms[s.type](Object.assign({},s,{trans:"undefined"==typeof propertiesPanelTrans?{}:propertiesPanelTrans})));let a=$(t);if(s.propertyGroupId){const e=i.find((e=>e.id===s.propertyGroupId));e&&($(t).find("#"+s.propertyGroupId).length?a=$(t).find("#"+s.propertyGroupId+" .field-container"):(a.append($(templates.forms.group({id:e.id,title:e.title,helpText:e.helpText,expanded:e.expanded}))),a=$($(t).find("#"+s.propertyGroupId)).find(".field-container")))}if(l?a.prepend(e):a.append(e),s.helpText&&0===e.find(".input-info-container .xibo-help-text").length&&e.find(".input-info-container").append($(templates.forms.addOns.helpText({helpText:s.helpText}))),s.customPopOver&&e.find(".input-info-container").append($(templates.forms.addOns.customPopOver({content:s.customPopOver}))),s.playerCompatibility&&e.find(".input-info-container").append($(templates.forms.addOns.playerCompatibility(s.playerCompatibility))),s.variant&&"dateFormat"===s.variant&&(e.find("label.control-label").append($(templates.forms.addOns.dateFormatHelperPopup({content:templates["php-date-format-table"]}))),e.find('[data-toggle="popover"]').popover({sanitize:!1,trigger:"manual"}).on("mouseenter",(function(e){$(e.currentTarget).popover("show")}))),"datasetField"===s.type&&void 0!==s.value&&String(s.value).length>0&&e.find("select").attr("data-value",s.value),s.dependsOn&&!e.attr("data-depends-on")&&e.attr("data-depends-on",s.dependsOn),s.visibility.length&&!e.attr("data-visibility")&&e.attr("data-visibility",s.visibility),s?.validation?.tests?.length&&!e.attr("data-is-required")){let t=!1;$.each(s.validation.tests,(function(a,n){$.each(n.conditions,(function(a,n){"required"!==n?.type||t||(e.attr("data-is-required",!0),s.isRequired=!0,t=!0)}))}))}r&&e.find("[name]").addClass(r)}else console.error("Form type not found: "+s.type)}n.reloadTooltips($(t),{position:"left"})},initFields:function(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=this,r=function(t,a){return a?$(a).is(t)?$(a):$():$(e).find(t)};r(".dropdown-input-group",t).each((function(e,t){$(t).find("select").find("option[data-content]").each((function(e,t){const a=$(t),n=$(a.data("content")),o=n.find("img");o.attr("src",assetDownloadUrl.replace(":assetId",o.attr("src"))),a.data("content",n.html())}))})),r(".button-switch-input-group",t).each((function(e,t){const a=$(t).find(".btn-group"),n=$(t).find('input[type="hidden"]');a.find("button").on("click",(function(e){const t=$(e.currentTarget);a.find("button").removeClass("selected"),t.addClass("selected"),n.val(t.data("value")).trigger("change")}))})),r(".dataset-order-clause",t).each((function(e,t){const a=$(t),o=a.data("depends-on-value");o&&$.ajax({url:urlsForApi.dataset.search.url,type:"GET",data:{dataSetId:o}}).done((function(e){const t=e.data[0].columns,o=a.find(".order-clause-container");if(0==o.length)return;const r=a.find("#input_"+a.data("order-id")),l=r.val()?JSON.parse(r.val()):[],s=function(){const e=[];o.find(".order-clause-row").each((function(t,a){const n=$(a),o=n.find(".order-clause").val(),i=n.find(".order-clause-direction").val();o&&e.push({orderClause:o,orderClauseDirection:i})})),r.val(JSON.stringify(e)).trigger("change")};o.empty();const d=formHelpers.getTemplate("dataSetOrderClauseTemplate"),c=datasetQueryBuilderTranslations.ascTitle,u=datasetQueryBuilderTranslations.descTitle;if(0==l.length){const e={columns:t,title:"1",orderClause:"",orderClauseAsc:"",orderClauseDesc:"",buttonGlyph:"fa-plus",ascTitle:c,descTitle:u};o.append(d(e))}else{let e=0;$.each(l,(function(a,n){e++;const i="ASC"==n.orderClauseDirection,r={columns:t,title:e,orderClause:n.orderClause,orderClauseAsc:i,orderClauseDesc:!i,buttonGlyph:1==e?"fa-plus":"fa-minus",ascTitle:c,descTitle:u};o.append(d(r))}))}n?i.makeFormReadOnly(a):(o.on("click","button",(function(e){if(e.preventDefault(),$(e.currentTarget).find("i").hasClass("fa-plus")){const e={columns:t,title:o.find(".form-inline").length+1,orderClause:"",orderClauseAsc:"",orderClauseDesc:"",buttonGlyph:"fa-minus",ascTitle:c,descTitle:u};o.append(d(e))}else $(e.currentTarget).closest(".form-inline").remove();s()})),a.on("change",'select:not([type="hidden"])',(function(){s()})))})).fail((function(e,t,a){console.error(e,t,a)}))})),r(".dataset-column-selector",t).each((function(e,t){const a=$(t),o=a.data("depends-on-value");o&&$.ajax({url:urlsForApi.dataset.search.url,type:"GET",data:{dataSetId:o}}).done((function(e){const t=e.data[0].columns,o=a.find("#columnsOut"),i=a.find("#columnsIn");if(0==o.length||0==i.length)return;const r=a.find("#input_"+a.data("select-id")),l=r.val()?JSON.parse(r.val()):[],s=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=[];i.find("li").each((function(e,a){const n=$(a).attr("id");t.push(Number(n))})),a.find(".temp").remove(),$.each(t,(function(e,t){a.append('<input type="hidden" class="temp" name="dataSetColumnId[]" value="'+t+'" />')})),r.val(JSON.stringify(t)).trigger("change",[{skipSave:e}])};o.empty(),i.empty();const d=datasetColumnSelectorTranslations.colAvailable,c=datasetColumnSelectorTranslations.colSelected;a.find(".col-out-title").text(d),a.find(".col-in-title").text(c);const u=[],p=[];$.each(t,(function(e,t){l.includes(t.dataSetColumnId)?p.push(t):u.push(t)}));const f=a.find("#columnsOut");$.each(u,(function(e,t){f.append('<li class="li-sortable" id="'+t.dataSetColumnId+'">'+t.heading+"</li>")}));const m=a.find("#columnsIn");$.each(p,(function(e,t){m.append('<li class="li-sortable" id="'+t.dataSetColumnId+'">'+t.heading+"</li>")})),n||(a.find("#columnsIn, #columnsOut").sortable({connectWith:".connectedSortable",dropOnEmpty:!0,update:function(){s()}}).disableSelection(),a.find(".li-sortable").on("dblclick",(function(e){const t=$(e.currentTarget);t.appendTo(t.parent().is("#columnsIn")?f:m),s()}))),s(!0)})).fail((function(e,t,a){console.error(e,t,a)}))})),r(".dataset-field-selector",t).each((function(t,a){const n=$(a),o=n.find("select"),i=$(e).find('input[name="dataTypeId"]'),r=n.data("depends-on-value");r&&(n.show(),$.ajax({url:urlsForApi.dataset.search.url,type:"GET",data:{dataSetId:r}}).done((function(e){const t=e.data[0].columns||[];if(i.length>0&&t.length>0){const e=(a=t,r=i.val(),a.reduce((function(e,t){const a=String(r);let n=[];return n=-1!==a.indexOf(",")?a.split(","):[a],-1!==n.indexOf(String(t.dataTypeId))?[...e,t]:e}),[])||[]);e.length>0?(o.find("option[value]").remove(),$.each(e,(function(e,t){o.append($('<option value="'+t.heading+'">'+t.heading+"</option>"))})),void 0!==o.data("value")?o.val(o.data("value")).trigger("change",[{skipSave:!0}]):(1===e.length||e.length>1)&&o.val(e[0].heading).trigger("change")):n.hide()}var a,r})))})),r(".dataset-filter-clause",t).each((function(e,t){const a=$(t),o=a.data("depends-on-value");o&&$.ajax({url:urlsForApi.dataset.search.url,type:"GET",data:{dataSetId:o}}).done((function(e){const t=e.data[0].columns,o=a.find(".filter-clause-container");if(0==o.length)return;const r=a.find("#input_"+a.data("filter-id")),l=r.val()?JSON.parse(r.val()):[],s=function(){const e=[];o.find(".filter-clause-row").each((function(t,a){const n=$(a),o=n.find(".filter-clause").val(),i=n.find(".filter-clause-operator").val(),r=n.find(".filter-clause-criteria").val(),l=n.find(".filter-clause-value").val();o&&e.push({filterClause:o,filterClauseOperator:i,filterClauseCriteria:r,filterClauseValue:l})})),r.val(JSON.stringify(e)).trigger("change")};o.empty();const d=formHelpers.getTemplate("dataSetFilterClauseTemplate"),c=datasetQueryBuilderTranslations.filterOptions,u=datasetQueryBuilderTranslations.filterOperatorOptions;if(0==l.length){const e={columns:t,filterOptions:c,filterOperatorOptions:u,title:"1",filterClause:"",filterClauseOperator:"AND",filterClauseCriteria:"",filterClauseValue:"",buttonGlyph:"fa-plus"};o.append(d(e))}else{let e=0;$.each(l,(function(a,n){e++;const i={columns:t,filterOptions:c,filterOperatorOptions:u,title:e,filterClause:n.filterClause,filterClauseOperator:n.filterClauseOperator,filterClauseCriteria:n.filterClauseCriteria,filterClauseValue:n.filterClauseValue,buttonGlyph:1==e?"fa-plus":"fa-minus"};o.append(d(i))}))}n?i.makeFormReadOnly(a):(o.on("click","button",(function(e){if(e.preventDefault(),$(e.currentTarget).find("i").hasClass("fa-plus")){const e={columns:t,filterOptions:c,filterOperatorOptions:u,title:o.find(".form-inline").length+1,filterClause:"",filterClauseOperator:"AND",filterClauseCriteria:"",filterClauseValue:"",buttonGlyph:"fa-minus"};o.append(d(e))}else $(e.currentTarget).closest(".form-inline").remove();s()})),a.on("change",'select:not([type="hidden"]), input:not([type="hidden"])',(function(e){s()})))})).fail((function(e,t,a){console.error(e,t,a)}))})),r(".ticker-tag-selector",t).each((function(e,t){const a=$(t),o={title:"text",summary:"text",content:"text",author:"text",permalink:"text",link:"text",date:"date",publishedDate:"date",image:"image"},r=a.find("#tagsOut"),l=a.find("#tagsIn");if(0==r.length||0==l.length)return;const s=a.find("#input_"+a.data("select-id")),d=s.val()?JSON.parse(s.val()):[],c=Object.keys(d),u=_.debounce((function(){const e=[],t=s.val()?JSON.parse(s.val()):[];l.find("li").each((function(t,a){const n=$(a).attr("id");e.push(n)})),a.find(".ticker-tag-styles .ticker-tag-style").remove(),e.forEach((e=>{const n=$(templates.forms.tickerTagStyle({id:e,type:o[e],value:t[e],trans:tickerTagSelectorTranslations,fontsSearchUrl:getFontsUrl+"?length=10000"}));n.appendTo(a.find(".ticker-tag-styles")),n.off().on("change inputChange",p)})),i.initFields(a.find(".ticker-tag-styles")),p()}),100),p=_.debounce((function(){const e={};a.find(".ticker-tag-style").each((function(t,a){const n=$(a).data("component-id");e[n]={};const i=$(a).find(".ticker-tag-style-property");e[n].tagType=o[n],i.find("select, input").each((function(t,a){const o=$(a).data("tag-style-input"),i="checkbox"===$(a).attr("type")?$(a).is(":checked"):$(a).val();e[n][o]=i}))})),s.val(JSON.stringify(e)).trigger("change")}),100);r.empty(),l.empty();const f=tickerTagSelectorTranslations.tagAvailable,m=tickerTagSelectorTranslations.tagSelected;a.find(".col-out-title").text(f),a.find(".col-in-title").text(m);const g=[],h=[];$.each(Object.keys(o),(function(e,t){c.includes(t)?h.push(t):g.push(t)}));const y=a.find("#tagsOut");$.each(g,(function(e,t){const a=$('<li class="li-sortable" id="'+t+'" data-tag-type="'+o[t]+'">'+tickerTagSelectorTranslations[t]+"</li>").data("tag-type",o[t]);y.append(a)}));const b=a.find("#tagsIn");$.each(h,(function(e,t){const a=$('<li class="li-sortable" id="'+t+'" data-tag-type="'+o[t]+'">'+tickerTagSelectorTranslations[t]+"</li>");b.append(a)})),n||(a.find("#tagsIn, #tagsOut").sortable({connectWith:".connectedSortable",dropOnEmpty:!0,receive:u,update:u}).disableSelection(),a.find(".li-sortable").on("dblclick",(function(e){const t=$(e.currentTarget);t.appendTo(t.parent().is("#tagsIn")?y:b),u()}))),u(!0)})),r(".dataset-column-style-selector",t).each((function(e,t){const a=$(t),o=a.data("depends-on-value");o&&$.ajax({url:urlsForApi.dataset.search.url,type:"GET",data:{dataSetId:o}}).done((function(e){const t=e.data[0].columns,o={3:"date",5:"image"},r=function(e){return t.find((t=>t.dataSetColumnId==e))},l=a.find("#colsOut"),s=a.find("#colsIn");if(0==l.length||0==s.length)return;const d=a.find("#input_"+a.data("select-id")),c=d.val()?JSON.parse(d.val()):[],u=Object.keys(c),p=_.debounce((function(){const e=[],t=d.val()?JSON.parse(d.val()):[];s.find("li").each((function(t,a){const n=$(a).attr("id"),i=(l=$(a).data("colType"),o[l]?o[l]:"text");var l;const s=r(n);e.push({id:n,type:i,name:s.heading})})),a.find(".dataset-column-styles .dataset-col-style").remove(),e.forEach((e=>{const n=$(templates.forms.datasetColStyle({id:e.id,type:e.type,name:e.name,value:t[e.id],trans:datasetColStyleSelectorTranslations,fontsSearchUrl:getFontsUrl+"?length=10000"}));n.appendTo(a.find(".dataset-column-styles")),n.off().on("change inputChange",(function(){f()}))})),i.initFields(a.find(".dataset-column-styles")),f()}),100),f=_.debounce((function(){const e={};let t=0;a.find(".dataset-col-style").each((function(a,n){const o=$(n).data("component-id");e[o]={};const i=$(n).find(".dataset-col-style-property");e[o].playOrder=t,t++,e[o].colId=o,i.find("select, input").each((function(t,a){const n=$(a).data("dataset-col-style-input"),i="checkbox"===$(a).attr("type")?$(a).is(":checked"):$(a).val();e[o][n]=i}))})),d.val(JSON.stringify(e)).trigger("change")}),100);l.empty(),s.empty();const m=datasetColStyleSelectorTranslations.colAvailable,g=datasetColStyleSelectorTranslations.colSelected;a.find(".col-out-title").text(m),a.find(".col-in-title").text(g);const h=[],y=[];$.each(Object.keys(t),(function(e,a){const n=t[a].dataSetColumnId;u.find((e=>n==e))?y.push(n):h.push(n)}));const b=a.find("#colsOut");$.each(h,(function(e,t){const a=r(t),n=$('<li class="li-sortable" id="'+a.dataSetColumnId+'" data-col-type="'+a.dataTypeId+'">'+a.heading+"</li>").data("col-type",a.dataTypeId);b.append(n)}));const v=a.find("#colsIn");$.each(y,(function(e,t){const a=r(t),n=$('<li class="li-sortable" id="'+a.dataSetColumnId+'" data-col-type="'+a.dataTypeId+'">'+a.heading+"</li>");v.append(n)})),n||(a.find("#colsIn, #colsOut").sortable({connectWith:".connectedSortable",dropOnEmpty:!0,receive:p,update:p}).disableSelection(),a.find(".li-sortable").on("dblclick",(function(e){const t=$(e.currentTarget);t.appendTo(t.parent().is("#colsIn")?b:v),p()}))),p(!0)})).fail((function(e,t,a){console.error(e,t,a)}))})),r(".languageSelect",t).each((function(t,a){const n=$(a).find("select.form-control");if($(a).hasClass("momentLocales")){const e=moment.locales().sort(),t=n.val();n.find("option").remove(),e.unshift("");for(let a=0;a<e.length;a++){const o=e[a],i=momentLocalesTrans[o]||o,r=$(`<option value="${o}">${o} - ${i}</option>`);t==o&&r.prop("selected",!0),r.appendTo(n)}}makeLocalSelect(n,e)})),r(".playlist-mixer",t).each((function(e,t){const a=$(t);function o(e,t){const a=t.find(".subplaylist-id");a.data("fieldId")?$.ajax({method:"GET",url:urlsForApi.playlist.get.url+"?playlistId="+a.data("fieldId"),success:function(t){t.data&&t.data.length>0?(a.append('<option value="'+t.data[0].playlistId+'" data-tags="'+t.data[0].tags+'" selected>'+t.data[0].name+"</option>"),r(e,a)):(a.parent().append('<input type="hidden" value="'+a.data("fieldId")+'" name="subPlaylistId[]"><span title="'+playlistMixerTranslations.noPermission+'"><i class="fa fa-lock"></i>&nbsp;'+playlistMixerTranslations.playlistId+" "+a.data("fieldId")+"</span>"),a.remove()),n&&i.makeFormReadOnly(e)},error:function(){a.parent().append('{% trans "An unknown error has occurred. Please refresh" %}')}}):r(e,a),t.find('select[name="spotFill[]"]').select2({templateResult:function(e){return e.id?$(e.element).data().templateResult:e.text},dropdownAutoWidth:!0,minimumResultsForSearch:-1})}function r(e,t){t.select2({dropdownAutoWidth:!0,ajax:{url:urlsForApi.playlist.get.url+"?notPlaylistId="+e.data("playlistId"),dataType:"json",delay:250,data:function(e){const t={start:0,length:10,name:e.term};return null!=e.page&&(t.start=10*(e.page-1)),t},processResults:function(t,a){const n=[];$.each(t.data,(function(e,t){n.push({id:t.playlistId,text:t.name})}));let o=a.page||1;return o=o>1?o-1:o,1===o&&n.length<=0&&e.find(".sub-playlist-no-playlists-message").removeClass("d-none"),{results:n,pagination:{more:10*o<t.recordsTotal}}}}})}const l=a.find("#input_"+a.data("mixer-id")),s=l.val()?JSON.parse(l.val()):[],d=a.find(".mixer-playlist-container");if(0==d.length)return;const c=function(){const e=[];d.find(".subplaylist-item-row").each((function(t,a){const n=$(a),o=n.find(".subplaylist-id").val(),i=n.find(".subplaylist-spots").val(),r=n.find(".subplaylist-spots-length").val(),l=n.find(".subplaylist-spots-fill").val();o&&e.push({rowNo:t+1,playlistId:o,spots:i,spotLength:r,spotFill:l})})),l.val(JSON.stringify(e)).trigger("xiboInputChange")};d.empty();const u=formHelpers.getTemplate("subPlaylistContainerTemplate");d.append(u({trans:playlistMixerTranslations}));const p=formHelpers.getTemplate("subPlaylistFormTemplate");if(0==s.length){const e={playlistId:"",spots:"",spotLength:"",spotFill:"",fillTitle:playlistMixerTranslations.fillTitle,padTitle:playlistMixerTranslations.padTitle,repeatTitle:playlistMixerTranslations.repeatTitle,fillHelpText:playlistMixerTranslations.fillHelpText,padHelpText:playlistMixerTranslations.padHelpText,repeatHelpText:playlistMixerTranslations.repeatHelpText};d.find(".subplaylist-items-content").append(p(e))}else $.each(s,(function(e,t){const a={playlistId:t.playlistId,spots:t.spots,spotLength:t.spotLength,spotFill:t.spotFill,fillTitle:playlistMixerTranslations.fillTitle,padTitle:playlistMixerTranslations.padTitle,repeatTitle:playlistMixerTranslations.repeatTitle,fillHelpText:playlistMixerTranslations.fillHelpText,padHelpText:playlistMixerTranslations.padHelpText,repeatHelpText:playlistMixerTranslations.repeatHelpText};d.find(".subplaylist-items-content").append(p(a))}));d.on("click",".subplaylist-item-btn",(function(e){if(e.preventDefault(),$(e.currentTarget).find("i").hasClass("fa-plus")){const e={playlistId:"",spots:"",spotLength:"",subPlaylistIdSpotFill:"",fillTitle:playlistMixerTranslations.fillTitle,padTitle:playlistMixerTranslations.padTitle,repeatTitle:playlistMixerTranslations.repeatTitle,fillHelpText:playlistMixerTranslations.fillHelpText,padHelpText:playlistMixerTranslations.padHelpText,repeatHelpText:playlistMixerTranslations.repeatHelpText},t=$(p(e)).appendTo(d.find(".subplaylist-items-content"));o(a,t)}else $(e.currentTarget).closest(".subplaylist-item-row").remove();c()})),d.find(".subplaylist-item-row").each((function(e,t){o(a,$(t))})),a.on("change","select, input",(function(){c()})),d.sortable({axis:"y",items:".subplaylist-item-row",handle:".subplaylist-item-sort",containment:"parent",update:function(){c()}})})),r(".xibo-code-input",t).each((function(e,t){const a=$(t),n=a.find(".code-input"),o=n.val(),i=n.data("codeType");let r=!1;const l=CodeMirror[i]?CodeMirror[i]:CodeMirror.html;new CodeMirror.EditorView({doc:o,extensions:[CodeMirror.basicSetup,CodeMirror.keymap.of([CodeMirror.indentWithTab]),l(),CodeMirror.EditorView.updateListener.of((e=>{e.docChanged&&e.state.doc.toString()!=n.val()&&(n.val(e.state.doc.toString()).trigger("inputChange"),n.trigger("editorFocus"),r=!0),r&&e.focusChanged&&(r=!1,n.trigger("change"))}))],parent:a.find(".code-input-editor")[0]});const s=a.find(".code-input-editor-container"),d=function(){const e=s.hasClass("code-input-fs"),t=s.height();if(s.toggleClass("code-input-fs"),e)$(".code-fs-overlay").remove(),s.appendTo(a),a.find(".code-fs-placeholder").remove();else{const e=$(".custom-overlay:first").clone();e.removeClass("custom-overlay").addClass("code-fs-overlay custom-overlay-clone").appendTo($("body")).on("click",d),e.show(),s.appendTo($("body")),$("<div>").addClass("code-fs-placeholder").css("height",t).appendTo(a)}};a.find(".code-input-fs-btn").on("click",d)})),r(".colorpicker-input.colorpicker-element",t).each((function(e,t){$(t).colorpicker({container:$(t).find(".picker-container"),align:"left",format:void 0!==$(t).data("colorFormat")&&$(t).data("colorFormat")});const a=$(t).find("input");a.on("focusout",(function(){if(""==a.val())if(void 0!==$(t).data("default")){const e=$(t).data("default");$(t).colorpicker("setValue",e)}else $(t).find(".input-group-addon").css("background-color","")}))})),r(".color-gradient",t).each((function(e,t){$(t).find(".colorpicker-input.colorpicker-element").colorpicker({container:$(t).find(".picker-container"),align:"left",format:void 0!==$(t).data("colorFormat")&&$(t).data("colorFormat")});const a="#222",n="#eee",o=$(t).find("[name]:not(.color-gradient-hidden).element-property"),i=$(t).find(".color-gradient-hidden.element-property"),r=o.filter('[name="gradientType"]'),l=o.filter('[name="gradientAngle"]'),s=o.filter('[name="gradientColor1"]'),d=o.filter('[name="gradientColor2"]');if(""!=i.val()){const e=JSON.parse(i.val());r.val(e.type).trigger("change"),s.parents(".colorpicker-input").colorpicker("setValue",e.color1),d.parents(".colorpicker-input").colorpicker("setValue",e.color2),l.val(e.angle)}const c=function(){""==s.val()&&s.parents(".colorpicker-input").colorpicker("setValue",a),""==d.val()&&d.parents(".colorpicker-input").colorpicker("setValue",n),""==l.val()&&l.val(0),l.parent().toggle("linear"===r.val())};o.addClass("skip-save"),o.on("change",(function(){const e=r.val(),t=s.val(),o=d.val(),u=l.val(),p={type:e,color1:""!=t?t:a,color2:""!=o?o:n};"linear"===e&&(p.angle=""!=u?u:0),c(),i.val(JSON.stringify(p)).trigger("change")})),c()})),r(".dateControl.date:not(.datePickerHelper)",t).each((function(e,t){"Jalali"==calendarType?initDatePicker($(t),systemDateFormat,jsDateOnlyFormat,{altFieldFormatter:function(e){const t=moment.unix(e/1e3);return t.set("hour",0),t.set("minute",0),t.set("second",0),t.format(systemDateFormat)}}):initDatePicker($(t),systemDateFormat,jsDateOnlyFormat)})),r(".dateControl.dateTime:not(.datePickerHelper)",t).each((function(e,t){const a=dateFormat.includes("s"),n=!dateFormat.includes("A");"Jalali"==calendarType?initDatePicker($(t),systemDateFormat,jsDateFormat,{timePicker:{enabled:!0,second:{enabled:a}}}):initDatePicker($(t),systemDateFormat,jsDateFormat,{enableTime:!0,time_24hr:n,enableSeconds:a,altFormat:$(t).data("customFormat")?$(t).data("customFormat"):jsDateFormat})})),r(".dateControl.month:not(.datePickerHelper)",t).each((function(e,t){"Jalali"==calendarType?initDatePicker($(t),systemDateFormat,jsDateFormat,{format:$(t).data("customFormat")?$(t).data("customFormat"):"MMMM YYYY",viewMode:"month",dayPicker:{enabled:!1},altFieldFormatter:function(e){const t=moment.unix(e/1e3);return t.set("date",1),t.set("hour",0),t.set("minute",0),t.set("second",0),t.format(systemDateFormat)}}):initDatePicker($(t),systemDateFormat,jsDateFormat,{plugins:[new flatpickrMonthSelectPlugin({shorthand:!1,dateFormat:systemDateFormat,altFormat:$(t).data("customFormat")?$(t).data("customFormat"):"MMMM Y",parseDate:function(e,t){return moment(e,t,!0).toDate()},formatDate:function(e,t,a){return moment(e).format(t)}})]})})),r(".dateControl.time:not(.datePickerHelper)",t).each((function(e,t){const a=dateFormat.includes("s");"Jalali"==calendarType?initDatePicker($(t),systemTimeFormat,jsTimeFormat,{onlyTimePicker:!0,format:jsTimeFormat,timePicker:{second:{enabled:a}},altFieldFormatter:function(e){const t=moment.unix(e/1e3);return t.set("second",0),t.format(systemTimeFormat)}}):initDatePicker($(t),systemTimeFormat,jsTimeFormat,{enableTime:!0,noCalendar:!0,enableSeconds:a,time_24hr:!0,altFormat:$(t).data("customFormat")?$(t).data("customFormat"):jsTimeFormat})})),r(".rich-text",t).each((function(t,a){formHelpers.setupCKEditor(e,$(a).attr("id"),!0,null,!1,!0)})),r(".world-clock-control",t).each((function(e,t){const a=$(t).find(".clocksContainer"),n=$(t).find(".world-clock-value");function o(e){const t=[];$(e).find(".form-clock").each((function(e,a){""!=$(a).find(".localSelect select").val()&&t.push({clockTimezone:$(a).find(".localSelect select").val(),clockHighlight:$(a).find(".clockHighlight").is(":checked"),clockLabel:$(a).find(".clockLabel").val()})})),n.attr("value",JSON.stringify(t))}function i(e){$(e).find(".localSelect select.form-control").each((function(t,a){makeLocalSelect($(a),$(e).hasClass("modal")?$(e):$("body"))})),$(e).find('input[type="checkbox"]').on("click",(function(){o(e)})),$(e).find('input[type="text"], select').on("change",(function(){o(e)}))}!function(e){if(0==e.length)return;const o=formHelpers.getTemplate("worldClockTemplate"),r=n.attr("value")?JSON.parse(n.attr("value")):[];if(0==r.length){const e={title:"1",clockTimezone:"",timezones:timezones,buttonGlyph:"fa-plus"};$(o(e)).appendTo(a),i(t)}else{let e=0;$.each(r,(function(t,n){e++;const i={title:e,clockTimezone:n.clockTimezone,clockHighlight:n.clockHighlight,clockLabel:n.clockLabel,timezones:timezones,buttonGlyph:1==e?"fa-plus":"fa-minus"};a.append(o(i))})),i(t)}a.on("click","button",(function(e){if(e.preventDefault(),$(e.currentTarget).find("i").hasClass("fa-plus")){const e={title:a.find(".form-clock").length+1,clockTimezone:"",timezones:timezones,buttonGlyph:"fa-minus"};a.append(o(e)),i(t)}else $(e.currentTarget).closest(".form-clock").remove()}))}($(t)),i(t)})),r(".font-selector",t).each((function(e,t){const a=$(t).find("select");$.ajax({method:"GET",url:a.data("searchUrl"),success:function(e){void 0!==e.data&&e.data.length>0&&$.each(e.data,(function(e,t){a.data("value")===t.familyName?(a.append($('<option value="'+t.familyName+'" selected>'+t.name+"</option>")),a.trigger("change",[{skipSave:!0}])):a.append($('<option value="'+t.familyName+'">'+t.name+"</option>"))})),n&&i.makeFormReadOnly($(t))}})})),r(".snippet-selector",t).each((function(e,t){const o=$(t).find("select"),r=o.data("target"),l=$("[name="+r+"]"),s=o.data("mode"),d=function(e){formHelpers.setupSnippetsSelector(e,(function(e){const t=$(e.currentTarget).val();if(null==t||""==t||0==l.length)return;const n="["+t+"]";if(formHelpers.getCKEditorInstance("input_"+a+"_"+r))formHelpers.insertToCKEditor("input_"+a+"_"+r,n);else if(l.hasClass("code-input")){const e=CodeMirror.EditorView.findFromDOM(l.next(".code-input-editor-container")[0]),t=e.viewState.state.selection.ranges[0];e.dispatch({changes:{from:t.from,to:t.to,insert:n},selection:{anchor:t.from+1}}),l.trigger("change")}else{const e=l[0].selectionStart,t=l.val();l.val(t.substring(0,e)+n+t.substring(e)),l.trigger("change")}}))};if("dataSet"==s){const e=$(t).data("dependsOn"),a=$("[name="+e+"]").val();a&&$.ajax({url:urlsForApi.dataset.search.url,type:"GET",data:{dataSetId:a},success:function(e){const t=e.data[0];t&&t.columns&&t.columns.length>0?(o.find("option[value]").remove(),$.each(t.columns,(function(e,t){o.append($('<option data-snippet-type="'+t.dataType+'" value="'+t.heading+"|"+t.dataSetColumnId+'">'+t.heading+"</option>"))})),0==t.columns.length?o.parent().hide():d(o),n&&i.makeFormReadOnly(o.parent())):o.parent().hide()},error:function(){o.parent().append('{% trans "An unknown error has occurred. Please refresh" %}')}})}else if("dataType"==s){const e=urlsForApi.widget.getDataType.url.replace(":id",a);$.ajax({method:"GET",url:e,success:function(e){e&&e.fields&&e.fields.length>0?(o.find("option[value]").remove(),$.each(e.fields,(function(e,t){o.append($('<option data-snippet-type="'+t.type+'" value="'+t.id+'">'+t.title+"</option>"))})),0==e.fields.length?o.parent().hide():d(o),n&&i.makeFormReadOnly(o.parent())):o.parent().hide()},error:function(){o.parent().append('{% trans "An unknown error has occurred. Please refresh" %}')}})}else"options"==s?d(o):"media"==s&&function(e){e.data("searchUrl",urlsForApi.library.get.url),e.data("imageUrl",urlsForApi.library.download.url),formHelpers.setupMediaSelector(e,(function(e){const t=$(e.currentTarget).val();if(null==t||""==t)return;const n='<img alt="" src="'+urlsForApi.library.download.url.replace(":id",t)+'?preview=1" />';if(formHelpers.getCKEditorInstance("input_"+a+"_"+r))formHelpers.insertToCKEditor("input_"+a+"_"+r,n);else if(l.length>0){const e=l[0].selectionStart,t=l.val();l.val(t.substring(0,e)+n+t.substring(e))}}))}(o)})),r(".effect-selector",t).each((function(e,t){const a=$(t).find("select"),n=a.data("effects-type").split(" "),i=-1!=n.indexOf("all");if($.each([{effect:"none",group:"showAll"},{effect:"marqueeLeft",group:"showAll"},{effect:"marqueeRight",group:"showAll"},{effect:"marqueeUp",group:"showAll"},{effect:"marqueeDown",group:"showAll"},{effect:"noTransition",group:"showPaged"},{effect:"fade",group:"showPaged"},{effect:"fadeout",group:"showPaged"},{effect:"scrollHorz",group:"showPaged"},{effect:"scrollVert",group:"showPaged"},{effect:"flipHorz",group:"showPaged"},{effect:"flipVert",group:"showPaged"},{effect:"shuffle",group:"showPaged"},{effect:"tileSlide",group:"showPaged"},{effect:"tileBlind",group:"showPaged"}],(function(e,t){if(-1!=n.indexOf("noNone")&&"none"===t.effect)return;if(-1===n.indexOf("all")&&-1===n.indexOf(t.group))return;let o=a.find(`optgroup[data-type=${t.group}]`);i&&0==o.length&&(o=$(`<optgroup\n              label="${effectsTranslations[t.group]}"\n              data-type="${t.group}">\n            </optgroup>`),a.append(o)),(i?o:a).append($('<option value="'+t.effect+'" data-optgroup="'+t.group+'">'+effectsTranslations[t.effect]+"</option>"))})),void 0!==a.data("value")&&(a.val(a.data("value")),a.trigger("change",[{skipSave:!0}])),1===$(t).next().find('input[name="speed"]').length){let e=null;const n=$(t).next().find('input[name="speed"]'),i=function(e,t,a){const n=o.isMarquee(e),i=o.isMarquee(t);return n&&!i?1e3:!n&&i?1:0===String(a).length?i?1:1e3:a};a.on("select2:open",(function(t){e=t.currentTarget.value})),n.val(i(e,e,n.val())),a.on("select2:select",(function(t){const a=t.params.data.id;n.val(i(e,a,n.val()))}))}})),r(".menu-board-category-selector",t).each((function(t,a){const n=$(a),o=$(a).find("select"),i=n.data("depends-on"),r=$(e).find("[name="+i+"]").val();""!=r&&(o.data("search-url",o.data("search-url-base").replace(":id",r)),makePagedSelect(o))})),r(".select2-hidden-accessible",t).each((function(e,t){$(t).on("select2:open",(function(e){const t=$(e.target).data("select2").dropdown?.$search;setTimeout((function(){t&&$(t.get(0)).trigger("focus")}),10)}))}));let l=0;r("input[data-role=panelTagsInput]",t).each((function(e,t){const a=$(t),n=a.data("autoCompleteUrl"),o=a.data("searchTermKey");if(void 0!==n&&""!==n){l++;const e=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.whitespace,queryTokenizer:Bloodhound.tokenizers.whitespace,initialize:!1,remote:{url:n,prepare:function(e,t){return t.data={tag:e},void 0!==o&&""!==o&&(t.data[o]=e),t},transform:function(e){return $.map(e.data,(function(e){return 1===l?{tag:e.type}:e.type}))}}});e.initialize().done((function(){(l>1||a.prev().is(".bootstrap-tagsinput"))&&("function"==typeof a.tagsinput&&a.tagsinput("destroy"),l=0);const t={name:"tags",source:e.ttAdapter()};1===l&&(t.displayKey="tag",t.valueKey="tag"),a.tagsinput({typeaheadjs:[{hint:!0,highlight:!0},t]})})).fail((function(){console.info("Auto-complete for tag failed! Using default..."),a.tagsinput()}))}else a.tagsinput()})),t||$(e).find(".xibo-form-input[data-depends-on]").each((function(t,o){const r=$(o);let l=r.data("depends-on");if(r.data("depends-on-added"))return;r.attr("data-depends-on-added",!0);let s=null;if(-1!==l.indexOf("[")&&-1!==l.indexOf("]")){const e=l.split("[");l=e[0],s=e[1].replace("]","")}const d='[name="'+l+'"]';$(e).find(d).on("change",(function(t){let o=null;const l=$(t.currentTarget);if(l.is("select")){const e=l.find("option:selected");o=e.data("set")?e.data("set"):e.val()}else o=l.is('input[type="checkbox"]')?l.is(":checked"):l.val();null!==s&&null!==o&&(o=o.split(",")[s]),r.children('input[type="checkbox"]').length>0?r.children('input[type="checkbox"]').prop("checked",o):r.hasClass("colorpicker-input")?""===o?(r.find("input").val(""),r.find(".input-group-addon").css("background-color","")):null!=o&&Color(o).valid&&(r.find("input").colorpicker("setValue",o),r.find(".input-group-addon").css("background-color",o)):r.children('input[type="text"]').length>0?r.children('input[type="text"]').val(o):(r.data("dependsOnValue",o),i.initFields(e,r,a,n))}))}))},handleFormReplacements:function(e,t){const a=/%([^%\s]+)%/g,n=function(e){return e.replace(a,(function(e,a){return a.split(".").reduce(((e,t)=>e[t]||`%${t}%`),t)}))};$(e).find(".xibo-form-input > [title], .xibo-form-btn[title]").each((function(e,t){const o=$(t),i=o.attr("title"),r=o.attr("data-original-title");i&&i.match(a)&&o.attr("title",n(i)),r&&r.indexOf("%")>-1&&r.match(a)&&o.attr("data-original-title",n(r))})),$(e).find(".xibo-form-input > *, .xibo-form-btn").each((function(e,t){const o=$(t),i=o.html();i&&i.match(a)&&o.html(n(i))}))},setConditions:function(e,t,a){let n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];$(e).find(".xibo-form-input[data-visibility]").each((function(o,r){let l=$(r).data("visibility");l=JSON.parse(JSON.stringify(l).replace(/\$(.*?)\$/g,(function(e,a){return a.split(".").reduce(((e,t)=>e[t]),t)})));const s=function(t,a){let o="";const r=t.type,l=t.conditions,s=function(){let t;for(let a=0;a<l.length;a++){const o=l[a],s=`[name="${o.field}"]`,d=$(e).find(s),c=0!==d.length&&"checkbox"===d.attr("type")?d.is(":checked"):d.val(),u=i(o.type,o.value,c,n);a>0?"and"===r?t=t&&u:"or"===r&&(t=t||u):t=u}t?a.show():a.hide()};for(let e=0;e<t.conditions.length;e++)o+=`[name="${t.conditions[e].field}"]`,e<t.conditions.length-1&&(o+=",");String(o).length>0&&$(e).find(o).on("change",s),s()};if(Array.isArray(l))for(let e=0;e<l.length;e++)s(l[e],$(r));else(function(t){if(t?.field&&a)return 0!==$(e).find(`[name="${t.field}"]`).length;if(t.conditions.length>0&&a){for(let a=0;a<t.conditions.length;a++){const n=t.conditions[a].field;if(0===$(e).find(`[name="${n}"]`).length)return!1}return!0}})(l)&&s({conditions:[l],test:""},$(r))}))},checkForSpacingIssues:function(e){e.find("input[type=text]").each((function(e,t){formRenderDetectSpacingIssues(t),$(t).on("keyup",_.debounce((function(){formRenderDetectSpacingIssues(t)}),500))}))},makeFormReadOnly:function(e){e.find("input, select, textarea, button:not(.copyTextAreaButton)").attr("disabled","disabled"),e.find(".colorpicker-input i.input-group-addon").off("click"),e.find("button:not(.copyTextAreaButton), .date-clear-button").hide(),e.find(".bootstrap-switch").hide()},reloadRichTextFields:function(e){e.find(".rich-text").each((function(t,a){const n=$(a).attr("id"),o=$(a).parent();o.addClass("loading"),formHelpers.destroyCKEditor(n),formHelpers.setupCKEditor(e,n,!0,null,!1,!0),o.removeClass("loading")}))},createFallbackDataForm:function(e,t,a,n,o){const i=e.fields,r=function(e,t){e.find(".fallback-data-record-previews").empty(),i.forEach((a=>{if(t&&t[a.id]){const n=t[a.id],o=$(templates.forms.fallbackDataRecordPreview({trans:fallbackDataTrans,field:a,data:n}));e.find(".fallback-data-record-previews").append(o)}}))},l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e.data,a=e.displayOrder,l=e.id,s=$(templates.forms.fallbackDataRecord({trans:fallbackDataTrans}));return null!=l&&s.data("recordId",l),null!=a&&s.data("displayOrder",a),i.forEach((e=>{const a=function(e,t){const a={...e},n=Math.floor(1e6*Math.random());let o;return null!=t&&(a.value=t),-1!=["datetime","date","time","month"].indexOf(a.type)&&(a.variant="datetime"===a.type?"dateTime":a.type,a.type="date"),"image"===a.type&&(a.type="mediaSelector",a.mediaSearchUrl=urlsForApi.library.get.url,a.initialValue=a.value,a.initialKey="mediaId"),"string"===a.type&&(a.type="text"),a.name=a.id,a.id=a.id+"_"+n,a.customClass="fallback-property",templates.forms.hasOwnProperty(a.type)&&(o=$(templates.forms[a.type](a))),o&&o.is('[data-is-required="true"]')&&o.find("label").append(`<span class="ml-1"\n            title=${fallbackDataTrans.requiredField}>*</span>`),o}(e,t&&t[e.id]);s.find(".fallback-data-record-fields").append(a)})),forms.initFields(s),r(s,t),$.isEmptyObject(e)&&s.addClass("editing"),s.find("button").on("click",(function(e){const t=$(e.currentTarget).data("action");"save-record"==t?function(e){const t={};let a=!1;if(i.forEach((n=>{const o=e.find('[name="'+n.id+'"]'),i=o.val(),r=o.parents(".fallback-property").is('[data-is-required="true"]');""==i&&r?a=!0:""!=i&&(t[n.id]=i)})),$.isEmptyObject(t))return void toastr.error(fallbackDataTrans.invalidRecordEmpty);if(a)return void toastr.error(fallbackDataTrans.invalidRecordRequired);const l=function(){r(e,t),o(),e.removeClass("editing")},s=e.data("recordId"),d=e.index();s?n.editFallbackDataRecord(s,t,d).then((e=>{e.success&&l()})):n.addFallbackData(t,d).then((t=>{t.success&&(e.data("recordId",t.id),l())}))}(s):"delete-record"==t?function(e){const t=e.data("recordId");t?n.deleteFallbackDataRecord(t).then((t=>{t.success&&(e.remove(),o())})):e.remove()}(s):"edit-record"==t&&s.addClass("editing")})),s};$(t).append(templates.forms.fallbackDataContent({data:e,trans:fallbackDataTrans,showFallback:n.getOptions().showFallback}));const s=$(t).find(".fallback-data-records");a&&(a.sort(((e,t)=>e.displayOrder-t.displayOrder)),a.forEach((e=>{s.append(l(e))})),XiboInitialise(".fallback-data-records")),$(t).find('[data-action="add-new-record"]').on("click",(function(){s.append(l()),XiboInitialise(".fallback-data-records")})),s.sortable({axis:"y",items:".fallback-data-record",containment:"parent",update:function(){let e=0;const t=[];s.find(".fallback-data-record").each(((a,n)=>{const o=$(n).data();o.recordId&&(t.push({dataId:o.recordId,displayOrder:e}),$(n).data("displayOrder",e),e++)})),n.saveFallbackDataOrder(t).then((e=>{e.success&&o()}))}})},membersFormOpen:function(e){const t=$(e).find(".controlDiv");null==t.data().members&&(t.data().members={displays:{},displayGroups:{},users:{},userGroups:{}}),t.data().displayGroups&&function(e){const t=$(e).find(".controlDiv"),a={tableName:"#displaysGroupsMembersTable",columns:[{data:"displayGroupId",responsivePriority:2},{data:"displayGroup",responsivePriority:2}],members:t.data().members.displayGroups,extra:e.data().extra.displayGroupsAssigned,id:"displayGroupId",type:"displayGroup",getUrl:t.data().displayGroupsGetUrl};r(e,a)}(e),t.data().display&&function(e){const t=$(e).find(".controlDiv"),a={tableName:"#displaysMembersTable",columns:[{data:"displayId",responsivePriority:2},{data:"display",responsivePriority:2},{data:"mediaInventoryStatus",responsivePriority:2,render:function(e,t,a){if("display"!=t)return e;let n="";return n=1==e?"fa-check":0==e?"fa-times":"fa-cloud-download","<span class='fa "+n+"'></span>"}},{data:"loggedIn",render:dataTableTickCrossColumn,responsivePriority:3},{name:"clientSort",responsivePriority:3,data:function(e){return e.clientType+" "+e.clientVersion+"-"+e.clientCode},visible:!1}],members:t.data().members.displays,extra:e.data().extra.displaysAssigned,id:"displayId",type:"display",getUrl:t.data().displayGetUrl};r(e,a)}(e),t.data().userGroups&&function(e){const t=$(e).find(".controlDiv"),a={tableName:"#userGroupMembersTable",columns:[{data:"groupId",responsivePriority:2},{data:"group",responsivePriority:2}],members:t.data().members.userGroups,extra:e.data().extra.userGroupsAssigned,id:"groupId",type:"userGroup",getUrl:t.data().userGroupsGetUrl};r(e,a)}(e),t.data().user&&function(e){const t=$(e).find(".controlDiv"),a={tableName:"#userMembersTable",columns:[{data:"userId",responsivePriority:2},{data:"userName",responsivePriority:2}],members:t.data().members.users,extra:e.data().extra.usersAssigned,id:"userId",type:"user",getUrl:t.data().userGetUrl};r(e,a)}(e),t.on("change",".checkbox",(function(e){const a=$(e.currentTarget),n=a.data().memberId,o=a.data().memberType,i=a.is(":checked");"display"===o?t.data().members.displays[n]=i?1:0:"displayGroup"===o?t.data().members.displayGroups[n]=i?1:0:"user"===o?t.data().members.users[n]=i?1:0:"userGroup"===o&&(t.data().members.userGroups[n]=i?1:0)}))},permissionsFormOpen:function(){const e=$("#permissionsTable").closest(".XiboGrid");e.data().permissions.length<=0&&(e.data().permissions={});const t=$("#permissionsTable").DataTable({language:dataTablesLanguage,serverSide:!0,stateSave:!0,filter:!1,searchDelay:3e3,order:[[0,"asc"]],ajax:{url:e.data().url,data:function(t){$.extend(t,e.find(".permissionsTableFilter form").serializeObject())}},columns:[{data:"group",render:function(e,t,a,n){return"display"!=t||1==a.isUser?e:"<strong>"+e+"</strong>"}},{data:"view",render:function(t,a,n,o){if("display"!=a)return t;let i;if(n.groupId in e.data().permissions){const t=e.data().permissions[n.groupId];i=void 0!==t.view&&1===t.view?1:0}else i=t;return'<input type="checkbox" data-permission="view" data-group-id="'+n.groupId+'" '+(1===i?"checked":"")+" />"}},{data:"edit",render:function(t,a,n,o){if("display"!=a)return t;let i;if(n.groupId in e.data().permissions){const t=e.data().permissions[n.groupId];i=void 0!==t.edit&&1===t.edit?1:0}else i=t;return'<input type="checkbox" data-permission="edit" data-group-id="'+n.groupId+'" '+(1===i?"checked":"")+" />"}},{data:"delete",render:function(t,a,n,o){if("display"!=a)return t;let i;if(n.groupId in e.data().permissions){const t=e.data().permissions[n.groupId];i=void 0!==t.delete&&1===t.delete?1:0}else i=t;return'<input type="checkbox" data-permission="delete" data-group-id="'+n.groupId+'" '+(1===i?"checked":"")+" />"}}]});t.on("draw",(function(t,a){dataTableDraw(t,a),$("#"+t.target.id).find("input[type=checkbox]").on("change",(function(t){const a=$(t.currentTarget),n=a.data().groupId,o=a.data().permission,i=a.is(":checked");void 0===e.data().permissions[n]&&(e.data().permissions[n]={}),e.data().permissions[n][o]=i?1:0}))})),t.on("processing.dt",dataTableProcessing),e.find(".permissionsTableFilter form input, .permissionsTableFilter form select").on("change",(function(){t.ajax.reload()}))},permissionsFormSubmit:function(e){const t=$("#"+e),a=t.closest(".permissions-form"),n={groupIds:$(t).data().permissions,ownerId:a.find("select[name=ownerId]").val()},o=$.param(n);$.ajax({type:"POST",url:t.data().url,cache:!1,dataType:"json",data:o,success:function(e,a,n){XiboSubmitResponse(e,t)},error:function(e,t,a){SystemMessage(e.responseText,!1)}})},permissionsMultiFormOpen:function(e){const t=$(e).find("#permissionsMultiTable"),a=t.closest(".XiboGrid"),n=t.DataTable({language:dataTablesLanguage,serverSide:!0,stateSave:!0,filter:!1,searchDelay:3e3,order:[[0,"asc"]],ajax:{url:a.data().url,data:function(e){$.extend(e,a.find(".permissionsMultiTableFilter form").serializeObject()),$.extend(e,{ids:a.data().targetIds})},dataSrc:function(e){const t=e.data;for(const e in t)if(t.hasOwnProperty(e)){const a={view:null,edit:null,delete:null};for(const n in t[e].permissions)if(t[e].permissions.hasOwnProperty(n)){const o=t[e].permissions[n];o.view!=a.view&&(null!=a.view?a.view=2:a.view=o.view),o.edit!=a.edit&&(null!=a.edit?a.edit=2:a.edit=o.edit),o.delete!=a.delete&&(null!=a.delete?a.delete=2:a.delete=o.delete)}t[e]=Object.assign(a,t[e]),delete t[e].permissions}return a.data().permissions=Object.assign({},a.data().permissions,t),a.data().startPermissions=Object.assign({},a.data().startPermissions,JSON.parse(JSON.stringify(t))),null==a.data().savePermissions&&(a.data().savePermissions={}),Object.values(t)}},columns:[{data:"group",render:function(e,t,a,n){return"display"!=t||1==a.isUser?e:"<strong>"+e+"</strong>"}},{data:"view",render:function(e,t,n,o){if("display"!=t)return e;let i;if(n.groupId in a.data().permissions){const e=a.data().permissions[n.groupId];i=void 0!==e.view&&0!==e.view?e.view:0}else i=e;return'<input type="checkbox" class="'+(2===i?"indeterminate":"")+'" data-permission="view" data-group-id="'+n.groupId+'" '+(1===i?"checked":"")+" />"}},{data:"edit",render:function(e,t,n,o){if("display"!=t)return e;let i;if(n.groupId in a.data().permissions){const e=a.data().permissions[n.groupId];i=void 0!==e.edit&&0!==e.edit?e.edit:0}else i=e;return'<input type="checkbox" class="'+(2===i?"indeterminate":"")+'" data-permission="edit" data-group-id="'+n.groupId+'" '+(1===i?"checked":"")+" />"}},{data:"delete",render:function(e,t,n,o){if("display"!=t)return e;let i;if(n.groupId in a.data().permissions){const e=a.data().permissions[n.groupId];i=void 0!==e.delete&&0!==e.delete?e.delete:0}else i=e;return'<input type="checkbox" class="'+(2===i?"indeterminate":"")+'" data-permission="delete" data-group-id="'+n.groupId+'" '+(1===i?"checked":"")+" />"}}]});n.on("draw",(function(t,n){dataTableDraw(t,n);const o=$("#"+t.target.id);o.find("input[type=checkbox]").on("change",(function(t){const n=$(t.currentTarget),o=n.data().groupId,i=n.data().permission,r=n.is(":checked")?1:0;void 0===a.data().permissions[o]&&(a.data().permissions[o]={}),a.data().permissions[o][i]=r,void 0===a.data().savePermissions[o]?(a.data().savePermissions[o]={},a.data().savePermissions[o][i]=r):a.data().startPermissions[o][i]===r?(delete a.data().savePermissions[o][i],$.isEmptyObject(a.data().savePermissions[o])&&delete a.data().savePermissions[o]):a.data().savePermissions[o][i]=r,$(e).find(".save-button").toggleClass("disabled",$.isEmptyObject(a.data().savePermissions))})),o.find("input[type=checkbox].indeterminate").prop("indeterminate",!0).prop("title",translations.indeterminate)})),$(e).find(".save-button").addClass("disabled"),n.on("processing.dt",dataTableProcessing),a.find(".permissionsMultiTableFilter form input, .permissionsMultiTableFilter form select").on("change",(function(){n.ajax.reload()}))},permissionsMultiFormSubmit:function(e){const t=$("#"+e),a=$(t).data().savePermissions,n=$(t).data().targetIds,o=$.param({groupIds:a,ids:n});$.ajax({type:"POST",url:t.data().url,cache:!1,dataType:"json",data:o,success:function(e,a,n){XiboSubmitResponse(e,t)},error:function(e,t,a){SystemMessage(e.responseText,!1)}})},membersFormSubmit:function(e){const t=$("#"+e),a=t.data().members;if(null==a)return void XiboDialogClose();window.queue=$.jqmq({delay:-1,batch:1,callback:function(e){$.ajax({type:"POST",url:e.url,cache:!1,dataType:"json",data:$.param(e.data),success:function(e,a,n){e.success?(""!=e.message&&SystemMessage(e.message,!0),queue.next()):e.login?LoginBox(e.message):(t.closest(".modal-dialog").find(".saving").remove(),SystemMessageInline(e.message,t.closest(".modal")))},error:function(e){t.closest(".modal-dialog").find(".saving").remove(),SystemMessage(e,!1)}})},complete:function(){t.closest(".modal-dialog").find(".saving").parent().remove(),XiboRefreshAllGrids(),void 0!==t.data("nextFormUrl")&&XiboFormRender(t.data().nextFormUrl),XiboDialogClose()}});let n=!1;const o=[],i=[];if($.each(a.displays,(function(e,t){1==t?o.push(e):i.push(e)})),o.length>0||i.length>0){const e={data:{},url:t.data().displayUrl};e.data[t.data().displayParam]=o,e.data[t.data().displayParamUnassign]=i,queue.add(e),n=!0}const r=[],l=[];if($.each(a.displayGroups,(function(e,t){1==t?r.push(e):l.push(e)})),r.length>0||l.length>0){const e={data:{},url:t.data().displayGroupsUrl};e.data[t.data().displayGroupsParam]=r,e.data[t.data().displayGroupsParamUnassign]=l,queue.add(e),n=!0}const s=[],d=[];if($.each(a.users,(function(e,t){1==t?s.push(e):d.push(e)})),s.length>0||d.length>0){const e={data:{},url:t.data().userUrl};e.data[t.data().userParam]=s,e.data[t.data().userParamUnassign]=d,queue.add(e),n=!0}const c=[],u=[];if($.each(a.userGroups,(function(e,t){1==t?c.push(e):u.push(e)})),c.length>0||u.length>0){const e={data:{},url:t.data().userGroupsUrl};e.data[t.data().userGroupsParam]=c,e.data[t.data().userGroupsParamUnassign]=u,queue.add(e),n=!0}n?queue.start():XiboDialogClose()},mediaDisplayGroupFormCallBack:function(){const e=$("#FileAssociationsAssign");null==e.data().media&&(e.data().media={});let t=[];$("#FileAssociationsSortable").find("[data-media-id]").each(((e,a)=>{t.push($(a).data("mediaId"))}));const a=$("#mediaAssignments").DataTable({language:dataTablesLanguage,serverSide:!0,stateSave:!0,searchDelay:3e3,order:[[0,"asc"]],filter:!1,ajax:{url:$("#mediaAssignments").data().url,data:function(e){$.extend(e,$("#mediaAssignments").closest(".XiboGrid").find(".FilterDiv form").serializeObject())}},columns:[{data:"name"},{data:"mediaType"},{sortable:!1,data:function(e,a,n,o){return"display"!=a?"":-1!=t.indexOf(e.mediaId)?'<a href="#" class="assignItem disabled"><span class="fa fa-plus hidden"></a>':'<a href="#" class="assignItem"><span class="fa fa-plus"></a>'}}]});a.on("draw",(function(n,o){dataTableDraw(n,o),$(".assignItem:not(.disabled)","#mediaAssignments").on("click",(function(n){const o=$(n.currentTarget),i=a.row(o.closest("tr")).data();e.data().media[i.mediaId]=1,t.push(i.mediaId),o.parents("tr").addClass("disabled"),o.hide();const r=$("<li/>",{text:i.name,"data-media-id":i.mediaId,class:"btn btn-sm btn-white"});r.appendTo("#FileAssociationsSortable"),$("<span/>",{class:"fa fa-minus ml-1"}).appendTo(r)}))})),a.on("processing.dt",dataTableProcessing),$("#FileAssociationsSortable").sortable(),$("#FileAssociationsSortable").on("click","li span",(function(n){const o=$(n.currentTarget),i=o.parent().data().mediaId;e.data().media[i]=0,o.parent().remove(),t=t.filter((e=>e!=i)),a.ajax.reload()})),$("#mediaAssignments").closest(".XiboGrid").find(".FilterDiv input, .FilterDiv select").on("change",(function(){a.ajax.reload()}))},mediaAssignSubmit:function(){const e=$("#FileAssociationsAssign"),t=[],a=[];var n,o,i;$.each(e.data().media,(function(e,n){1==n?t.push(e):a.push(e)})),n=e.data().url,o=t,i=a,toastr.info("Assign Media",o),$.ajax({type:"post",url:n,cache:!1,dataType:"json",data:{mediaId:o,unassignMediaId:i},success:XiboSubmitResponse})},layoutFormCallBack:function(){const e=$("#FileAssociationsAssign");null==e.data().layout&&(e.data().layout={});const t=$("#layoutAssignments").DataTable({language:dataTablesLanguage,serverSide:!0,stateSave:!0,searchDelay:3e3,order:[[0,"asc"]],filter:!1,ajax:{url:$("#layoutAssignments").data().url,data:function(e){$.extend(e,$("#layoutAssignments").closest(".XiboGrid").find(".FilterDiv form").serializeObject())}},columns:[{data:"layout"},{sortable:!1,data:function(e,t,a,n){return"display"!=t?"":'<a href="#" class="assignItem"><span class="fa fa-plus"></a>'}}]});t.on("draw",(function(a,n){dataTableDraw(a,n),$(".assignItem","#layoutAssignments").on("click",(function(a){const n=t.row($(a.currentTarget).closest("tr")).data();e.data().layout[n.layoutId]=1;const o=$("<li/>",{text:n.layout,"data-layout-id":n.layoutId,class:"btn btn-sm btn-white"});o.appendTo("#FileAssociationsSortable"),$("<span/>",{class:"fa fa-minus",click:function(t){e.data().layout[$(t.currentTarget).parent().data().layoutId]=0,$(t.currentTarget).parent().remove()}}).appendTo(o)}))})),t.on("processing.dt",dataTableProcessing),$("#FileAssociationsSortable").sortable(),$("#FileAssociationsSortable").find("li span").on("click",(function(t){e.data().layout[$(t.currentTarget).parent().data().layoutId]=0,$(t.currentTarget).parent().remove()})),$("#layoutAssignments").closest(".XiboGrid").find(".FilterDiv input, .FilterDiv select").on("change",(function(){t.ajax.reload()}))},layoutAssignSubmit:function(){const e=$("#FileAssociationsAssign"),t=[],a=[];var n,o,i;$.each(e.data().layout,(function(e,n){1==n?t.push(e):a.push(e)})),n=e.data().url,o=t,i=a,toastr.info("Assign Layout",o),$.ajax({type:"post",url:n,cache:!1,dataType:"json",data:{layoutId:o,unassignLayoutId:i},success:XiboSubmitResponse})},userProfileEditFormOpen:function(){$("#qRCode").addClass("d-none"),$("#recoveryButtons").addClass("d-none"),$("#recoveryCodes").addClass("d-none"),$("#twoFactorTypeId").on("change",(function(e){e.preventDefault(),2==$("#twoFactorTypeId").val()&&2!=$("#userEditProfileForm").data().currentuser?($.ajax({url:$("#userEditProfileForm").data().setup,type:"GET",beforeSend:function(){$("#qr").addClass("fa fa-spinner fa-spin loading-icon")},success:function(e){const t=e.data.qRUrl;$("#qrImage").attr("src",t)},complete:function(){$("#qr").removeClass("fa fa-spinner fa-spin loading-icon")}}),$("#qRCode").removeClass("d-none")):$("#qRCode").addClass("d-none"),0==$("#twoFactorTypeId").val()&&($("#recoveryButtons").addClass("d-none"),$("#recoveryCodes").addClass("d-none")),0!=$("#userEditProfileForm").data().currentuser&&0!=$("#twoFactorTypeId").val()&&$("#recoveryButtons").removeClass("d-none")})),0!=$("#userEditProfileForm").data().currentuser&&$("#recoveryButtons").removeClass("d-none");let e="";$("#generateCodesBtn").on("click",(function(t){$("#codesList").html(""),$("#recoveryCodes").removeClass("d-none"),$(".recBtn").attr("disabled",!0).addClass("disabled"),e="",$.ajax({url:$("#userEditProfileForm").data().generate,async:!1,type:"GET",beforeSend:function(){$("#codesList").removeClass("card").addClass("fa fa-spinner fa-spin loading-icon")},success:function(t){e=JSON.parse(t.data.codes),$("#recoveryCodes").addClass("d-none"),$(".recBtn").attr("disabled",!1).removeClass("disabled"),$("#showCodesBtn").trigger("click")},complete:function(){$("#codesList").removeClass("fa fa-spinner fa-spin loading-icon")}})})),$("#showCodesBtn").on("click",(function(t){$(".recBtn").attr("disabled",!0).addClass("disabled"),$("#codesList").html(""),$("#recoveryCodes").toggleClass("d-none");let a=[];$.ajax({url:$("#userEditProfileForm").data().show,type:"GET",data:{generatedCodes:e},success:function(t){a=""!=e?e:t.data.codes,$("#twoFactorRecoveryCodes").val(JSON.stringify(a)),$.each(a,(function(e,t){$("#codesList").append(t+"<br/>")})),$("#codesList").addClass("card"),$(".recBtn").attr("disabled",!1).removeClass("disabled")}})}))},tagsWithValues:function(e){let t;$('#tagValue, label[for="tagValue"], #tagValueRequired').addClass("d-none"),$("#tagValueContainer").hide();let a="",n="",o="",i=[],r=0;const l="#"+e+" input#tags, #"+e+" input#tagsToAdd";$(l).on("beforeItemAdd",(function(a){if($("#tagValue").html(""),$("#tagValueInput").val(""),t=a.item,i=[],r=0,n=t.split("|")[0],o=t.split("|")[1],$(l).val().indexOf(n)>=0){const e=$(l).tagsinput("items").filter((e=>e.split("|")[0].toLowerCase()===n.toLowerCase()));$(l).tagsinput("remove",e.toString())}-1===$(l).val().indexOf(n)&&void 0===o&&$.ajax({url:$("form#"+e).data().gettag,type:"GET",data:{name:n},beforeSend:function(){$("#loadingValues").addClass("fa fa-spinner fa-spin loading-icon")},success:function(e){e.success&&(null!=e.data.tag?(i=JSON.parse(e.data.tag.options),r=e.data.tag.isRequired,null!=i&&i!=[]?($('#tagValue, label[for="tagValue"]').removeClass("d-none"),$('#tagValue option[value=""]').length<=0&&$("#tagValue").append($("<option></option>").attr("value","").text("")),$.each(i,(function(e,t){$("#tagValue option[value="+t+"]").length<=0&&$("#tagValue").append($("<option></option>").attr("value",t).text(t))})),$("#tagValue").trigger("focus")):($("#tagValueContainer").show(),0===r?$("#tagValueInput").parent().find("span.help-block").text(translations.tagInputValueHelpText):$("#tagValueInput").parent().find("span.help-block").text(translations.tagInputValueRequiredHelpText),$("#tagValueInput").trigger("focus"))):($("#tagValueContainer").show(),$("#tagValueInput").trigger("focus"),$("#tagValueInput").parent().find("span.help-block").text(translations.tagInputValueHelpText)))},complete:function(){$("#loadingValues").removeClass("fa fa-spinner fa-spin loading-icon")},error:function(e,t,a){console.error(e,t,a)}})})),$(l).on("itemAdded",(function(e){null!=i&&i!=[]&&$("#tagValue").trigger("focus")})),$(l).on("itemRemoved",(function(e){n===e.item?($('#tagValueRequired, label[for="tagValue"]').addClass("d-none"),$(".save-button").prop("disabled",!1),$("#tagValue").html("").addClass("d-none"),$("#tagValueInput").val(""),$("#tagValueContainer").hide(),n=""):$(".save-button").is(":disabled")||($("#tagValue").html("").addClass("d-none"),$("#tagValueInput").val(""),$("#tagValueContainer").hide(),$('label[for="tagValue"]').addClass("d-none"))})),$("#tagValue").on("change",(function(e){e.preventDefault(),a=n+"|"+$(e.currentTarget).val(),""!=n&&(0===r||1===r&&""!==$(e.currentTarget).val()?($(l).tagsinput("add",a),$(l).tagsinput("remove",n),$("#tagValue").html("").addClass("d-none"),$('#tagValueRequired, label[for="tagValue"]').addClass("d-none"),$(".save-button").prop("disabled",!1)):($("#tagValueRequired").removeClass("d-none"),$("#tagValue").trigger("focus")))})),$("#tagValue").on("blur",(function(e){""===$(e.currentTarget).val()&&1===r?($("#tagValueRequired").removeClass("d-none"),$("#tagValue").trigger("focus"),$(".save-button").prop("disabled",!0)):($("#tagValue").html("").addClass("d-none"),$('label[for="tagValue"]').addClass("d-none"))})),$("#tagValueInput").on("keypress focusout",(function(e){if((13===e.keyCode||"focusout"===e.type)&&""!=n){e.preventDefault();const t=$(e.currentTarget).val();a=""!==t?n+"|"+t:n,0===r||1===r&&""!==t?($(l).tagsinput("add",a),""!==t&&$(l).tagsinput("remove",n),$("#tagValueInput").val(""),$("#tagValueContainer").hide(),$("#tagValueRequired").addClass("d-none"),$(".save-button").prop("disabled",!1)):($("#tagValueContainer").show(),$("#tagValueRequired").removeClass("d-none"),$("#tagValueInput").trigger("focus"))}}))},featureAclFormOpen:function(e){$(e).find("tr.feature-row").hide(),$(e).find("td.feature-group-header-cell").on("click",(function(e){const t=$(e.currentTarget);t.hasClass("open")?(t.find(".feature-group-description").show(),t.find("i.fa").removeClass("fa-arrow-circle-up").addClass("fa fa-arrow-circle-down"),t.closest("tbody.feature-group").find("tr.feature-row").hide(),t.removeClass("open").addClass("closed")):(t.find(".feature-group-description").hide(),t.find("i.fa").removeClass("fa-arrow-circle-down").addClass("fa fa-arrow-circle-up"),t.closest("tbody.feature-group").find("tr.feature-row").show(),t.removeClass("closed").addClass("open"))})).each((function(e,t){l($(t))})),$(e).find("input[name='features[]']").on("click",(function(e){l($(e.currentTarget))})),$(e).find("input.feature-select-all").on("click",(function(e){$(e.currentTarget).closest("tbody.feature-group").find("input[name='features[]']").prop("checked",$(e.currentTarget).is(":checked"))}))},userApprovedApplicationsFormOpen:function(e){$(".revokeAccess").on("click",(function(e){const t=$(e.currentTarget),a=t.data("applicationKey"),n=t.data("applicationUser");$.ajax({url:revokeApplicationAccess.replace(":id",a).replace(":userId",n),type:"DELETE",success:function(e){e.success?(t.closest("tr").remove(),toastr.success(e.message)):toastr.error(e.message)}})}))},folderMoveSubmit:function(){XiboFormSubmit($("#moveFolderForm"),null,(function(e,t){e.success&&$("#container-folder-tree").jstree(!0).refresh()}))},validateForm:function(e,t,a){const n={submitHandler:a.submitHandler,errorElement:"span",ignore:".datePickerHelper",errorPlacement:function(e,t){$(t).hasClass("dateControl")?e.insertAfter(t.parent()):$(t).siblings(".validation-error-container").length>0?e.appendTo($(t).siblings(".validation-error-container")):e.insertAfter(t)},highlight:function(e){$(e).closest(".form-group").removeClass("has-success").addClass("has-error")},success:function(e){$(e).closest(".form-group").removeClass("has-error").addClass("has-success")},invalidHandler:function(e,t){$(".nav-item a.nav-link").removeClass("has-error"),t.errorList.forEach((e=>{const t=e.element;$(t).parents(".tab-pane").each(((e,t)=>{$('.nav-item a.nav-link[href="#'+$(t).attr("id")+'"]:not(.active)').addClass("has-error")}))})),$(this).closest(".modal-dialog").find(".saving").remove(),$(this).closest(".modal-dialog").find(".save-button").removeClass("disabled")}};Object.assign(n,a);const o=e.validate(n);t.find(".nav-link").on("shown.bs.tab",(()=>{o.form()}))}}},53439:function(){$((function(){const e=$("#help-pane");e.find(".help-pane-icon").on("click",(()=>{e.find(".help-pane-card").toggle()})),e.find(".close-icon").on("click",(()=>{e.find(".help-pane-card").hide()}))}))},22950:function(){window.calendar=void 0;let e,t,a=[];function n(e,t,a){const n=$("<input>",{type:"text",value:e,readonly:!0,class:"form-control"}).css("background-color","#fff"),o=$("<input>",{type:"hidden",name:a,value:t});return n.add(o)}function o(e,t,a){const o=e.find('label[for="criteria_condition[]"]');if(o.empty(),1===t.length){const e=t[0];o.append(n(e.name,e.id,"criteria_condition[]"))}else{const e=$("<select>",{name:"criteria_condition[]",class:"form-control"});t.forEach((t=>{e.append($("<option>",{value:t.id}).text(t.name))})),e.val(a||t[0]?.id||""),o.append(e)}}function i(e,t,a){const n=e.find('label[for="criteria_condition[]"]');n.empty();const o=$("<select>",{name:"criteria_condition[]",class:"form-control"});t.forEach((e=>{o.append($("<option>",{value:e.id}).text(e.name))})),o.val(a||t[0]?.id||""),n.append(o)}$((function(){let e=null;function t(e,t){const a=e.find('label[for="criteria_value[]"]');if(a.find("input, select").remove(),"dropdown"===t.inputType)if(1===t.values.length){const e=t.values[0];a.append(n(e.title,e.id,"criteria_value[]"))}else{const e=$('<select class="form-control" name="criteria_value[]"></select>');t.values.forEach((function(t){e.append(new Option(t.title,t.id))})),a.append(e)}else{let e;"text"!==t.inputType&&"number"!==t.inputType&&"date"!==t.inputType||(e=$('<input class="form-control" name="criteria_value[]" type="'+t.inputType+'" value="" />')),a.append(e)}}function r(e){const t=e.find('label[for="criteria_value[]"]'),a=$('<input class="form-control" name="criteria_value[]" type="text" value="" />');t.find("input, select").remove(),t.append(a)}if($("body").on("click",(function(e){$('[data-toggle="popover"]').each((function(t,a){$(a).is(e.target)||0!==$(a).has(e.target).length||0!==$(".popover").has(e.target).length||$(a).popover("hide")}))})),$("body").on("change",'#scheduleCriteriaFields select[name="criteria_type[]"]',(function(e){const a=$(e.target),l=a.closest(".form-group"),s=a.val(),d=$("#scheduleCriteriaFields"),c=d.data("scheduleCriteria"),u=d.data("criteriaDefaultCondition");c&&("custom"===s?(function(e){const t=e.find('label[for="criteria_metric[]"]'),a=$('<input class="form-control" name="criteria_metric[]" type="text" value="" />');t.find("input, select").remove(),t.append(a)}(l),r(l),i(l,u)):c&&function(e,a,l){const s=e.find('label[for="criteria_metric[]"]'),d=$("#scheduleCriteriaFields").data("criteriaDefaultCondition");let c,u;if(a.types){const s=a.types.find((e=>e.id===l));if(s){const a=s.metrics;if(1===a.length){const e=a[0];u=e.id,c=n(e.name,e.id,"criteria_metric[]")}else c=$("<select>",{name:"criteria_metric[]",class:"form-control"}),a.forEach((function(e){c.append(new Option(e.name,e.id))})),u=a[0]?.id,c.val(u);const l=a.find((e=>e.id===u));l&&l.values?t(e,l.values):r(e),l&&l.conditions?o(e,l.conditions):i(e,d)}}s.find("input, select").remove(),s.append(c)}(l,c,s))})),$("body").on("change",'#scheduleCriteriaFields select[name="criteria_metric[]"]',(function(e){const a=$(e.target),n=a.closest(".form-group"),l=a.val(),s=$("#scheduleCriteriaFields"),d=s.data("scheduleCriteria"),c=s.data("criteriaDefaultCondition"),u=n.find('select[name="criteria_type[]"]').val();if(d&&u){const e=d.types.find((e=>e.id===u));if(e){const a=e.metrics.find((e=>e.id===l));a&&a.values?t(n,a.values):r(n),a&&a.conditions?o(n,a.conditions):i(n,c)}}})),$(".btn-group button[data-calendar-nav]").each((function(e,t){const a=$(t);a.on("click",(function(){calendar.navigate(a.data("calendar-nav"))}))})),$(".btn-group button[data-calendar-view]").each((function(e,t){const a=$(t);a.on("click",(function(){calendar.view(a.data("calendar-view")),$("#range").val(a.data("calendar-view"))}))})),$('a[data-toggle="tab"].schedule-nav').on("shown.bs.tab",(function(e){"#calendar-view"===$(e.target).attr("href")?$("#range").trigger("change"):"agenda"===$("#range").val()&&$("#range").val("day").trigger("change")})),$("#Calendar").length>0){const t=$("#CalendarContainer").data(),n=function(){if(null!=calendar){const e=moment(moment($("#fromDt").val()).format(systemDateFormat));e.isValid()&&calendar.navigate("date",e)}},o=function(){calendar.navigate("date",moment($("#dateInput input[data-input]").val()))};$("#range").on("change",(function(){if(null!=calendar){let e=$("#range").val();const t=e.includes("last");"custom"===e?$("#fromDt, #toDt").on("change",(function(){n();const e=moment(moment($("#fromDt").val()).startOf("day").format(systemDateFormat)),t=moment(moment($("#toDt").val()).startOf("day").format(systemDateFormat)).diff(e,"days");t<1?"agenda"===calendar.options.view?calendar.view("agenda"):calendar.view("day"):t>=1&&t<=7?calendar.view("week"):t>7&&t<=31?calendar.view("month"):calendar.view("year")})):(e=t?e.replace("last",""):e,calendar.view(e)),"agenda"===e&&$("#calendar-tab").trigger("click")}updateRangeFilter($("#range"),$("#fromDt"),$("#toDt"),n)})),updateRangeFilter($("#range"),$("#fromDt"),$("#toDt"));let i={};"Jalali"==calendarType?i={autoClose:!0,altField:"#dateInputLink",altFieldFormatter:function(e){const t=moment.unix(e/1e3);return t.set("hour",0),t.set("minute",0),t.set("second",0),t.format(jsDateFormat)},onSelect:function(){},onHide:function(){$("#dateInput").trigger("change"),$("#dateInputLink").trigger("change")}}:"Gregorian"==calendarType&&(i={wrap:!0,altFormat:jsDateOnlyFormat}),initDatePicker($("#dateInput"),systemDateFormat,jsDateOnlyFormat,i,o,!1);const r=$(".cal-event-location-map #geoFilterAgendaMap");$("#getLocation").off().on("click",(function(e){const t=$(e.currentTarget);t.prop("disabled",!0),navigator.geolocation.getCurrentPosition((function(e){$("#geoLatitude").val(e.coords.latitude).change(),$("#geoLongitude").val(e.coords.longitude).change(),t.prop("disabled",!1),f()}),(function(e){console.warn("ERROR("+e.code+"): "+e.message),t.prop("disabled",!1)}),{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})})),$("#toggleMap").off().on("click",(function(){r.toggleClass("d-none"),r.hasClass("d-none")||f()})),$("#clearLocation").off().on("click",(function(){$("#geoLatitude").val("").change(),$("#geoLongitude").val("").change(),r.hasClass("d-none")||f()})),$("#geoLatitude, #geoLongitude").off().change(_.debounce((function(){calendar.view()}),400));const l={time_start:"00:00",time_end:"00:00",events_source:function(){return a},view:"month",tmpl_path:function(e){if(0===$("#calendar-template-"+e).length){const t=$('<div id="calendar-template-'+e+'">');t.text(templates.calendar[e]({trans:translations.schedule.calendar})).hide(),t.appendTo("body")}return"calendar-template-"+e},tmpl_cache:!0,onBeforeEventsLoad:function(t){const n=$("#CalendarContainer").data(),o=$("#calendar-error-message"),i=$("#showAll").is(":checked");if($("#DisplayList, #DisplayGroupList").prop("disabled",i),"agenda"!==this.options.view){$(".cal-event-agenda-filter, .xibo-agenda-calendar-controls, #btn-month-view").hide(),$("#btn-agenda-view").show(),$(".non-agenda-filter").find("input, select").prop("disabled",!1);const i=$('select[name="displayGroupIds[]"').serialize(),r=$('select[name="displaySpecificGroupIds[]"').serialize(),l=$("#campaignIdFilter").serialize(),s=$("#eventTypeId").serialize(),d=$("#geoAware").serialize(),c=$("#recurring").serialize(),u=$("#name").serialize(),p="useRegexForName="+$("#useRegexForName").is("checked"),f=$("#logicalOperatorName").serialize();i||l||r?o.hide():o.show();let m=n.eventSource;m+="?"+l+"&"+s+"&"+d+"&"+c+"&"+u+"&"+p+"&"+f,i||r||""===l?""===i&&""===r||(m+="&"+i+"&"+r):m+="&displayGroupIds[]=-1",a=[];const g={from:moment(this.options.position.start.getTime()).format(systemDateFormat),to:moment(this.options.position.end.getTime()).format(systemDateFormat)};e&&e.abort(),$("#calendar-progress").addClass("show"),e=$.getJSON(m,g).done((function(e){a=e.result,null!=t&&t(),calendar._render(),$('[data-toggle="popover"]').popover({trigger:"manual",html:!0,placement:"bottom",content:function(){return $(this).html()}}).on("mouseenter",(function(e){const t=e.currentTarget;$('[data-toggle="popover"]').not(t).popover("hide"),$(t).popover("show"),$(".popover").off("mouseleave").on("mouseleave",(function(){$(t).popover("hide")}))})).on("shown.bs.popover",(function(e){const t=$(e.currentTarget),a=t.attr("aria-describedby");$("#"+a+" a").on("click",(function(e){e.preventDefault(),XiboFormRender(t),t.popover("hide")}))})),$("#calendar-progress").removeClass("show")})).fail((function(e){$("#calendar-progress").removeClass("show"),null!=t&&t(),calendar._render(),"abort"!=e.statusText&&(toastr.error(translations.failure),console.error(e))}))}else{$(".cal-event-agenda-filter, .xibo-agenda-calendar-controls, #btn-month-view").show(),$("#btn-agenda-view").hide(),$(".non-agenda-filter").find("input, select").prop("disabled",!0),o.hide();const r=$("#timePicker"),l=moment().tz?moment().tz(timezone):moment(),s=[],d=[],c=[];for(let e=0;e<=1440;e+=120){const t=1440===e?1439:e;s.push(t),d.push(l.clone().startOf("day").add(t,"minutes").format(jsTimeFormat)),c.push(e/1440*100)}r.slider({value:60*l.hour()+l.minute(),tooltip:"always",ticks:s,ticks_labels:d,ticks_positions:c,formatter:function(e){return moment().startOf("day").minute(e).format(jsTimeFormat)}}).off("slideStop").on("slideStop",(function(e){calendar.view()})),$(".time-picker-step-btn").off().on("click",(function(e){r.slider("setValue",r.slider("getValue")+$(e.currentTarget).data("step")),calendar.view()}));let u=$(".cal-context").data().selectedTab;const p=[];let f=!1;i||($("#DisplayList, #DisplayGroupList").prop("disabled",!1),$('select[name="displayGroupIds[]"] option, select[name="displaySpecificGroupIds[]"] option').each((function(e,t){const a=$(t);if(-1==a.val()&&a.is(":selected"))return f=!0,!0;(a.is(":selected")||f)&&(p.push({id:a.val(),name:a.html(),isDisplaySpecific:a.attr("type")}),void 0===u&&(u=a.val()))}))),p.sort((function(e,t){const a=e.name.toLowerCase(),n=t.name.toLowerCase();return a<n?-1:a>n?1:0}));const g=n.agendaLink.replace(":id",u),h=moment(this.options.position.start.getTime()/1e3,"X"),y=$("#timePickerSlider").length?$("#timePicker").slider("getValue"):0,b=moment(60*y,"X"),v={date:moment(h+b).format(systemDateFormat)};jQuery.isEmptyObject(a.results)&&(a=[],a.results={}),a.displayGroupList=p,a.selectedDisplayGroup=u,a.errorMessage="",1==calendar.options.clearCache&&(a.results={}),e&&e.abort(),i?(a.errorMessage="all_displays_selected",null!=t&&t(),calendar._render()):null==p||Array.isArray(p)&&0==p.length?(a.errorMessage="display_not_selected",null!=t&&t(),calendar._render()):jQuery.isEmptyObject(a.results[u])||a.results[u].request_date!=v.date||a.results[u].geoLatitude!=$("#geoLatitude").val()||a.results[u].geoLongitude!=$("#geoLongitude").val()?($("#calendar-progress").addClass("show"),e=$.getJSON(g,v).done((function(e){let n=!0;!jQuery.isEmptyObject(e.data)&&null!=e.data.events&&e.data.events.length>0&&(a.results[String(u)]=e.data,a.results[String(u)].request_date=v.date,n=!1,null!=$("#geoLatitude").val()&&""!=$("#geoLatitude").val()&&null!=$("#geoLongitude").val()&&""!=$("#geoLongitude").val()&&(a.results[String(u)].geoLatitude=$("#geoLatitude").val(),a.results[String(u)].geoLongitude=$("#geoLongitude").val(),a.results[String(u)].events=m(a.results[String(u)].events),n=e.data.events.length<=0)),n&&(a.results[String(u)]={},a.errorMessage="no_events"),null!=t&&t(),calendar._render(),$("#calendar-progress").removeClass("show")})).fail((function(e){null!=t&&t(),"abort"!=e.statusText&&(a.errorMessage="request_failed"),calendar._render(),$("#calendar-progress").removeClass("show")}))):(null!=t&&t(),calendar._render())}},onAfterEventsLoad:function(e){"agenda"==this.options.view&&$(".agenda-panel").ready((function(){$(".agenda-table-layouts").DataTable({searching:!1})}))},onAfterViewLoad:function(e){null!=this.options.position.start&&""!=this.options.position.start&&updateDatePicker($("#dateInput"),moment.unix(this.options.position.start.getTime()/1e3).format(systemDateFormat),systemDateFormat),"function"==typeof this.getTitle&&$("h1.page-header").text(this.getTitle()),$(".btn-group button").removeClass("active"),$('button[data-calendar-view="'+e+'"]').addClass("active")},language:calendarLanguage};l.type=t.calendarType,calendar=$("#Calendar").calendar(l),$(".cal-context").on("click",'a[data-toggle="tab"]',(function(e){$(".cal-context").data().selectedTab=$(e.currentTarget).data("id"),calendar.view()})),$(".cal-context").on("click","tbody tr",(function(e){const t=$(e.currentTarget),n=t.hasClass("selected");$(".cal-event-breadcrumb-trail").hide(),$(".cal-context tbody tr").removeClass("selected"),$(".cal-context tbody tr").removeClass("selected-linked"),destroyMiniLayoutPreview(),n||("layouts"==t.closest("table").data("type")&&($(".cal-event-breadcrumb-trail").show(),$(".cal-event-breadcrumb-trail #content").html(""),$(".cal-event-breadcrumb-trail #content").append(calendar._breadcrumbTrail(t.data("elemId"),a,t.data("eventId"))),createMiniLayoutPreview(layoutPreviewUrl.replace(":id",t.data("elemId"))),XiboInitialise("#CalendarContainer")),u(t.closest("table").data("type"),t.data("elemId"),a,t.data("eventId")))}))}})),window.setupScheduleForm=function(e){const t=$("#isGeoAware");let a=t.is(":checked");const n=e.find("form");h(e),a&&$(".nav-tabs a").on("shown.bs.tab",(function(e){"Geo Location"===$(e.target).text()&&($("#geoScheduleMap").removeClass("d-none"),p(n))})),t.on("change",(function(){a=$("#isGeoAware").is(":checked"),a?($("#geoScheduleMap").removeClass("d-none"),p(n)):$("#geoScheduleMap").addClass("d-none")}));const o=$("#shareOfVoice"),i=$("#shareOfVoicePercentage");o.on("change paste keyup",(function(){u(o.val())})),i.on("change paste keyup",(function(){const e=i.val(),t=Math.round(3600*e/100);o.val(t)}));const u=function(e){const t=100*e/3600;i.val(t.toFixed(2))};u(o.val()),g(e),$('select[name="recurrenceRepeatsOn[]"]',e).select2({width:"100%"}),s($("#recurrenceType",e),e),s($("#eventTypeId",e),e),s($("#campaignId",e),e),s($("#actionType",e),e),s($("#relativeTime",e),e),$("#recurrenceType, #eventTypeId, #dayPartId, #campaignId, #actionType, #fullScreenCampaignId, #relativeTime, #syncTimezone",e).on("change",(function(t){s($(t.currentTarget),e)}));const f=_.debounce((function(){c(n)}),500);n.find("#hours").on("change keyup",f),n.find("#minutes").on("change keyup",f),n.find("#seconds").on("change keyup",f),$('a[data-toggle="tab"]',e).on("shown.bs.tab",(function(t){const a=$(e).find("input[name=fromDt]"),n=null===a.val()||""===a.val()?moment():moment(a.val()),o=$(e).find("select[name=recurrenceMonthlyRepeatsOn]"),i=$('<option value="0">'+o.data("transDay").replace("[DAY]",n.format("Do"))+"</option>"),r=$('<option value="1">'+o.data("transWeekday").replace("[POSITION]",(l=Math.ceil(n.date()/7),l+(["st","nd","rd"][((l+90)%100-10)%10-1]||"th"))).replace("[WEEKDAY]",n.format("dddd"))+"</option>");var l;o.find("option").remove().end().append(i).append(r).val(o.data("value"))})),$("#scheduleAddForm, #scheduleEditForm, #scheduleDeleteForm, #scheduleRecurrenceDeleteForm").on("submit",(function(e){e.preventDefault();const t=$(this),a=t.serializeObject();y(t,a),$.ajax({type:t.attr("method"),url:t.attr("action"),data:a,cache:!1,dataType:"json",success:function(e,a,n){XiboSubmitResponse(e,t),e.success&&void 0!==calendar&&(calendar.options.clearCache=!0,destroyMiniLayoutPreview(),calendar.view())}})})),$(e).find('[data-toggle="popover"]').popover();const m=$(e).find("#scheduleEditForm, #scheduleEditSyncForm");if(m.length>0){let t=$("<button>").addClass("btn btn-info").attr("id","scheduleDuplateButton").html(translations.duplicate).on("click",(function(){d(m)}));$(e).find(".modal-footer").prepend(t),m.find("#instanceStartDate").html(moment(m.data().eventStart,"X").format(jsDateFormat)),m.find("#instanceEndDate").html(moment(m.data().eventEnd,"X").format(jsDateFormat)),t=$("<button>").addClass("btn btn-primary").attr("id","scheduleRecurringDeleteButton").html(translations.deleteRecurring).on("click",(function(){r(m.data("eventId"),m.data("eventStart"),m.data("eventEnd"))})),$(e).find("#recurringInfo").prepend(t)}l($(e))};const r=function(e,t,a){const n=scheduleRecurrenceDeleteUrl.replace(":id",e);XiboSwapDialog(n,{eventStart:t,eventEnd:a})};window.beforeSubmitScheduleForm=function(e){e.find('[name="reminder_isEmail[]"]').each((function(e,t){$(t).parent().find('[type="hidden"]').val($(t).is(":checked")?"1":"0")})),$('[data-toggle="popover"]').popover(),e.submit()},window.fullscreenBeforeSubmit=function(e,t){let a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=e.find('[name="eventTypeId"]').val(),o={id:7==n?e.find('[name="mediaId"]').val():e.find('[name="playlistId"]').val(),type:7==n?"media":"playlist",layoutDuration:7==n?e.find('[name="layoutDuration"]').val():null,resolutionId:e.find('[name="resolutionId"]').select2("data").length>0?e.find('[name="resolutionId"]').select2("data")[0].id:null,backgroundColor:e.find('[name="backgroundColor"]').val()};$.ajax({type:"POST",url:e.data().fullScreenUrl,cache:!1,dataType:"json",data:o}).then((o=>{if(o.success||SystemMessageInline(""===o.message?translations.failure:o.message,e.closest(".modal")),a)if(7==n){const t=$("#fullScreenControl_media");t.text(t.data("hasLayout")),$("#fullScreen-media").val(e.find("#mediaId").select2("data")[0].text),$("#fullScreen-mediaId").val(e.find("#mediaId").select2("data")[0].id)}else if(8==n){const t=$("#fullScreenControl_playlist");t.text(t.data("hasLayout")),$("#fullScreen-playlist").val(e.find("#playlistId").select2("data")[0].text),$("#fullScreen-playlistId").val(e.find("#playlistId").select2("data")[0].id)}$("#fullScreenCampaignId").val(o.data.campaignId).trigger("change"),"function"==typeof t&&t(e),$("#full-screen-schedule-modal").modal("hide")}),(e=>{SystemMessage(e.responseText,!1)}))};const l=function(e){const t=e.find("#reminderFields");if(0!=t.length){if(0==t.data().reminders.length){const e={title:0,buttonGlyph:"fa-plus"};t.append(templates.schedule.reminderEvent({...e,trans:translations.schedule.reminder}))}else{let e=0;$.each(t.data().reminders,(function(a,n){e++;const o={scheduleReminderId:n.scheduleReminderId,value:n.value,type:n.type,option:n.option,isEmail:n.isEmail,title:e,buttonGlyph:1==e?"fa-plus":"fa-minus"};t.append(templates.schedule.reminderEvent({...o,trans:translations.schedule.reminder}))}))}t.on("click","button",(function(e){if(e.preventDefault(),$(e.currentTarget).find("i").hasClass("fa-plus")){const e={title:t.find(".form-group").length+1,buttonGlyph:"fa-minus"};t.append(templates.schedule.reminderEvent({...e,trans:translations.schedule.reminder}))}else $(e.currentTarget).closest(".form-group").remove()}))}},s=function(e,t){const a=e.val(),n=$("#relativeTime").is(":checked");let o,i,r,l,d,u,p;switch(e.attr("id")){case"recurrenceType":const f=""==a?"none":"",m="Week"!=a?"none":"",g="Month"!==a?"none":"";$(".repeat-control-group").css("display",f),$(".repeat-weekly-control-group").css("display",m),$(".repeat-monthly-control-group").css("display",g),$("#recurrenceDetail").parent().find(".input-group-addon").html(e.val());break;case"eventTypeId":const h=2==a||6==a||7==a||8==a||10==a?"none":"";o=2==a||n?"none":"",i=n&&2!=a?"none":"";const y=2==a?"none":"";let b=2==a?"":"none";const v=4==a?"":"none",x=6==a?"":"none",w=2==a||6==a||10==a?"none":"",k=7==a?"":"none",T=8==a?"":"none",C=7==a||8==a?"":"none";r=2!=a&&n?"":"none",l=2==a?"none":"";const S=10==a?"":"none";if($(".layout-control",t).css("display",h),$(".endtime-control",t).css("display",o),$(".starttime-control",t).css("display",i),$(".day-part-control",t).css("display",y),$(".command-control",t).css("display",b),$(".interrupt-control",t).css("display",v),$(".action-control",t).css("display",x),$(".max-plays-control",t).css("display",w),$(".media-control",t).css("display",k),$(".playlist-control",t).css("display",T),$(".media-playlist-control",t).css("display",C),$(".relative-time-control",t).css("display",r),$(".relative-time-checkbox",t).css("display",l),$(".data-connector-control",t).css("display",S),6===a&&$(".displayOrder-control",t).css("display","none"),2==a){const e=$("#dayPartId",t);let a=0;e.find("option").each((function(e,t){1===$(t).data("isCustom")&&(a=$(t).val())})),e.val(a),d=$(".starttime-control",t),d.find("input[name=fromDt_Link2]").show(),d.find(".help-block").html(d.closest("form").data().daypartMessage),$("li.repeats",t).css("display","block"),$("li.reminders",t).css("display","block")}s($("#dayPartId",t),t);const I=e.closest("form").find("#campaignId"),F=$(".layout-control",t);let O=-1;"1"===a||"3"===a||"4"===a?(O=1,F.children("label").text(I.data("transLayout")),F.children("div").children("small.form-text.text-muted").text(I.data("transLayoutHelpText"))):(O=0,F.children("label").text(I.data("transCampaign")),F.children("div").children("small.form-text.text-muted").text(I.data("transCampaignHelpText"))),I.data("searchIsLayoutSpecific",O);break;case"dayPartId":if(!e.is(":visible"))return;const _=e.find("option[value="+a+"]").data();o=0===_.isCustom||n?"none":"",i=1===_.isAlways||n?"none":"";const D=1===_.isAlways?"none":"",j=1===_.isAlways?"none":"";r=0!==_.isCustom&&n?"":"none",l=0===_.isCustom?"none":"",d=$(".starttime-control",t),u=$(".endtime-control",t);const P=$("li.repeats",t),M=$("li.reminders",t);p=$(".relative-time-control",t);const L=$(".relative-time-checkbox",t);d.css("display",i),u.css("display",o),P.css("display",D),M.css("display",j),p.css("display",r),L.css("display",l),0===_.isAlways&&0===_.isCustom?(d.find("input[name=fromDt_Link2]").hide(),d.find("small.text-muted").html(d.closest("form").data().notDaypartMessage)):(d.find("input[name=fromDt_Link2]").show(),d.find("small.text-muted").html(d.closest("form").data().daypartMessage)),0===_.isAlways?(d.find("input[name=fromDt]").prop("disabled",!1),u.find("input[name=toDt]").prop("disabled",!1)):(d.find("input[name=fromDt]").prop("disabled",!0),u.find("input[name=toDt]").prop("disabled",!0));break;case"campaignId":case"fullScreenCampaignId":const A=$("#previewButton",t);null===a||""===a||0===a?A.closest(".preview-button-container").hide():(A.closest(".preview-button-container").show(),A.attr("href",A.data().url.replace(":id",a)));break;case"actionType":if(!e.is(":visible"))return;const G="navLayout"==a&&e.is(":visible")?"":"none";b="command"==a?"":"none",$(".layout-code-control",t).css("display",G),$(".command-control",t).css("display",b);break;case"relativeTime":if(!e.is(":visible"))return;const R=$(e).is(":checked")?"none":"",X=$(e).is(":checked")||2==$("#eventTypeId",t).val()?"none":"";r=$(e).is(":checked")?"":"none",d=$(".starttime-control",t),u=$(".endtime-control",t),p=$(".relative-time-control",t),dateFormat.indexOf("s")<=-1&&$(".schedule-now-seconds-field").remove(),$(e).is(":checked")&&c($(e).closest("form")),d.css("display",R),u.css("display",X),p.css("display",r);break;case"syncTimezone":$("#relativeTime",t).is(":checked")&&c($(e).closest("form"))}},d=function(e){e.attr("action",e.data().addUrl).attr("method","post"),$("#scheduleDuplateButton").remove(),toastr.info(e.data().duplicatedMessage)},c=function(e){const t=e.find("#hours").val(),a=e.find("#minutes").val(),n=e.find("#seconds").val(),o=moment(),i=moment(),r=$(".scheduleNowMessage"),l=e.find("#syncTimezone");let s="";""!=t&&i.add(t,"hours"),""!=a&&i.add(a,"minutes"),""!=n&&i.add(n,"seconds"),""==t&&""==a&&""==n?(r.html("").addClass("d-none"),updateDatePicker(e.find("#fromDt"),""),updateDatePicker(e.find("#toDt"),"")):(s=l.is(":checked")?"templateSync":"templateNoSync",r.html(r.data(s).replace("[fromDt]",o.format(jsDateFormat)).replace("[toDt]",i.format(jsDateFormat))).removeClass("d-none"),updateDatePicker(e.find("#fromDt"),o.format(systemDateFormat),systemDateFormat,!0),updateDatePicker(e.find("#toDt"),i.format(systemDateFormat),systemDateFormat,!0))},u=function(e,t,a,n){const o=[],i={layouts:"selected-linked",overlays:"selected-linked",displaygroups:"selected-linked",campaigns:"selected-linked"};results=a.results[a.selectedDisplayGroup];const r=results.events;for(let a=0;a<r.length;a++)"layouts"!=e&&"overlays"!=e||r[a].layoutId!=t||r[a].eventId!=n?"displaygroups"==e&&r[a].displayGroupId==t?(o.push(r[a]),i.displaygroups="selected"):"campaigns"==e&&r[a].campaignId==t&&(o.push(r[a]),i.campaigns="selected"):(o.push(r[a]),i[e]="selected");for(let e=0;e<o.length;e++)$('table[data-type="layouts"] tr[data-elem-id~="'+o[e].layoutId+'"][data-event-id~="'+o[e].eventId+'"]').addClass(i.layouts),$('table[data-type="displaygroups"] tr[data-elem-id~="'+o[e].displayGroupId+'"]').addClass(i.displaygroups),$('table[data-type="campaigns"] tr[data-elem-id~="'+o[e].campaignId+'"]').addClass(i.campaigns)},p=function(t){null!=e&&e.remove();const a=$("#"+t.attr("id")).data().defaultLat,n=$("#"+t.attr("id")).data().defaultLong;e=L.map("geoScheduleMap").setView([a,n],13),L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',subdomains:["a","b","c"]}).addTo(e);const o=new L.FeatureGroup;e.addLayer(o);const i=new L.Control.Draw({position:"topright",draw:{polyline:!1,circle:!1,marker:!1,circlemarker:!1},edit:{featureGroup:o}}),r=new L.Control.Draw({position:"topright",draw:!1,edit:{featureGroup:o}});e.addControl(i);const l=new L.Control.Search({url:"https://nominatim.openstreetmap.org/search?format=json&q={s}",jsonpParam:"json_callback",propertyName:"display_name",propertyLoc:["lat","lon"],marker:L.circleMarker([0,0],{radius:30}),autoCollapse:!0,autoType:!1,minLength:2,hideMarkerOnCollapse:!0,firstTipSubmit:!0});e.addControl(l);let s="",d=null,c=null;if(e.on("draw:created",(function(t){d=t.layer,o.addLayer(d),s=d.toGeoJSON(),$("#geoLocation").val(JSON.stringify(s)),e.removeControl(i),e.addControl(r)})),e.on("draw:edited",(function(e){c=e.layers,c.eachLayer((function(e){s=e.toGeoJSON(),$("#geoLocation").val(JSON.stringify(s))}))})),e.on("draw:deleted",(function(t){c=t.layers,c.eachLayer((function(e){$("#geoLocation").val(""),o.removeLayer(e)})),0===o.getLayers().length&&(e.removeControl(r),e.addControl(i))})),null!=$("#geoLocation").val()&&""!==$("#geoLocation").val()){const t=JSON.parse($("#geoLocation").val());L.geoJSON(t,{onEachFeature:function(t,a){o.addLayer(a),e.fitBounds(a.getBounds())}}),e.removeControl(i),e.addControl(r)}},f=function(){null!=e&&e.remove();let a=$("#geoLatitude").val(),n=$("#geoLongitude").val();null!=a&&""!=a&&null!=n&&""!=n||(a=$(".cal-event-location-map").data("defaultLat"),n=$(".cal-event-location-map").data("defaultLong")),e=L.map("geoFilterAgendaMap").setView([a,n],13),L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',subdomains:["a","b","c"]}).addTo(e);const o=new L.Control.Search({url:"https://nominatim.openstreetmap.org/search?format=json&q={s}",jsonpParam:"json_callback",propertyName:"display_name",propertyLoc:["lat","lon"],marker:L.circleMarker([0,0],{radius:30}),autoCollapse:!0,autoType:!1,minLength:2,hideMarkerOnCollapse:!0});e.addControl(o);const i=function(a,n){null!=t&&e.removeLayer(t),t=L.marker([a,n],e).addTo(e)};e.on("click",(function(e){$("#geoLatitude").val(e.latlng.lat).change(),$("#geoLongitude").val(e.latlng.lng).change(),i(e.latlng.lat,e.latlng.lng)})),null!=$("#geoLatitude").val()&&""!=$("#geoLatitude").val()&&null!=$("#geoLongitude").val()&&""!=$("#geoLongitude").val()&&i($("#geoLatitude").val(),$("#geoLongitude").val())},m=function(e){const t=[];for(let a=0;a<e.length;a++){const n=e[a];if(""!=n.geoLocation){const e=JSON.parse(n.geoLocation),a=[$("#geoLongitude").val(),$("#geoLatitude").val()],o=L.geoJSON(e);leafletPip.pointInLayer(a,o).length>0&&t.push(n)}else t.push(n)}return t},g=function(e){const t=$("#campaignId",e);t.select2({dropdownParent:$(e).find("form"),ajax:{url:t.data("searchUrl"),dataType:"json",delay:250,data:function(e){const a={isLayoutSpecific:t.data("searchIsLayoutSpecific"),retired:0,totalDuration:0,name:e.term,start:0,length:10,columns:[{data:"isLayoutSpecific"},{data:"campaign"}],order:[{column:0,dir:"asc"},{column:1,dir:"asc"}]};return null!=e.page&&(a.start=10*(e.page-1)),a},processResults:function(e,t){const a=[];$.each(e.data,(function(e,t){a.push({id:t.campaignId,text:t.campaign})}));let n=t.page||1;return n=n>1?n-1:n,{results:a,pagination:{more:10*n<e.recordsTotal}}}}}),t.on("select2:open",(function(e){setTimeout((function(){$(e.target).data("select2").dropdown.$search.get(0).focus()}),10)}));const a=$('select[name="displayGroupIds[]"]',e);if(a.select2({dropdownParent:$(e).find("form"),ajax:{url:a.data("searchUrl"),dataType:"json",delay:250,data:function(e){const t={isDisplaySpecific:-1,forSchedule:1,displayGroup:e.term,start:0,length:10,columns:[{data:"isDisplaySpecific"},{data:"displayGroup"}],order:[{column:0,dir:"asc"},{column:1,dir:"asc"}]};return null!=e.page&&(t.start=10*(e.page-1)),t},processResults:function(e,t){const n=[],o=[];$.each(e.data,(function(e,t){1===t.isDisplaySpecific?o.push({id:t.displayGroupId,text:t.displayGroup}):n.push({id:t.displayGroupId,text:t.displayGroup})}));let i=t.page||1;return i=i>1?i-1:i,{results:[{text:n.length>0?a.data("transGroups"):null,children:n},{text:o.length>0?a.data("transDisplay"):null,children:o}],pagination:{more:10*i<e.recordsTotal}}}}}),-1==[void 0,""].indexOf(a.data("initialKey"))&&$(e).find("form").data("setDisplaysFromGridFilters")){const e=$("#DisplayList").val()??[],t=$("#DisplayGroupList").val()??[],n=e.concat(t);a.data("initial-value",n);const o=a.data("initialValue"),i={};i[a.data("initialKey")]=o,i.isDisplaySpecific=-1,i.forSchedule=1,n.length>0&&$.ajax({url:a.data("searchUrl"),type:"GET",data:i}).then((function(e){e.data.forEach((e=>{const t=new Option(e[a.data("textProperty")],e[a.data("idProperty")],!0,!0);a.append(t)})),a.trigger("change",[{skipSave:!0}]),a.trigger({type:"select2:select",params:{data:e}})}))}$("#mediaId, #playlistId",e).on("select2:select",(function(e){let t=!1;void 0!==e.params.data.data?t=e.params.data.data[0].hasFullScreenLayout:void 0!==e.params.data.hasFullScreenLayout&&(t=e.params.data.hasFullScreenLayout),t?$(".no-full-screen-layout").css("display","none"):"mediaId"===$(e.currentTarget).attr("id")?$(".no-full-screen-layout").css("display",""):$(".no-full-screen-layout.media-playlist-control").css("display","")})),$("#syncGroupId",e).on("select2:select",(function(t){const a=$(t.currentTarget),n=e.find("form").data().eventSyncGroupId==a.select2("data")[0].id?e.find("form").data().eventId:null;$.ajax({type:"GET",url:e.find("form").data().fetchSyncDisplays.replace(":id",a.select2("data")[0].id),cache:!1,dataType:"json",data:{eventId:n}}).then((t=>{t.success||SystemMessageInline(""===t.message?translations.failure:t.message,form.closest(".modal")),$("#content-selector").removeClass("d-none"),e.find("#contentSelectorTable tbody").html("").append(templates.calendar.syncEventContentSelector({...t.data,urlForLayoutSearch:urlForLayoutSearch,trans:translations.schedule.syncEventSelector}));const a=e.find("form").attr("id");e.find(".pagedSelect select.form-control.syncContentSelect").each((function(e,t){makePagedSelect($(t),"#"+a)})),e.find(".pagedSelect select.form-control.syncContentSelect").on("select2:select",(function(e){$(e.currentTarget).data().displayId===$(e.currentTarget).data().leadDisplayId&&$("#setMirrorContent").removeClass("d-none")})),e.find("#setMirrorContent").on("click",(function(t){const n=$(t.currentTarget).data().displayId,o=$("#layoutId_"+n).select2("data")[0].id;e.find(".pagedSelect select.form-control.syncContentSelect").not("#layoutId_"+n).each((function(e,t){$(t).data().initialValue=o,makePagedSelect($(t),"#"+a)}))}))}),(e=>{SystemMessage(e.responseText,!1)}))}))},h=function(e){const t=e.find("#scheduleCriteriaFields");if(t.length<=0)return;const a=t.data("scheduleCriteria"),r=a?a.types:[],l=function(e){r&&r.length>0&&r.forEach((t=>{e.append(new Option(t.name,t.id))}))},s=t.data("criteria");if(s&&s.length>0){let e=0;$.each(s,(function(a,s){e++,s.isAdd=1===e,s.i=e;const d=$(templates.schedule.criteriaFields({...s,trans:translations.schedule.criteriaFields}));t.append(d);const c=d.find('select[name="criteria_type[]"]');l(c),c.val(s.type),function(e,t,a,l,s){const d=e.find('label[for="criteria_metric[]"]');let c;if("custom"===t)c=$("<input>",{class:"form-control",name:"criteria_metric[]",type:"text",value:a});else{const d=r?r.find((e=>e.id===t)):null;if(d){const t=d.metrics;if(1===t.length){const e=t[0];a=e.id,c=n(e.name,e.id,"criteria_metric[]")}else c=$("<select>",{class:"form-control",name:"criteria_metric[]"}),t.forEach((e=>{c.append(new Option(e.name,e.id))})),a=a||t[0]?.id,c.val(a);const r=t.find((e=>e.id===a));r&&(function(e,t,a){const o=e.find('label[for="criteria_value[]"]');let i;if(t.values&&"dropdown"===t.values.inputType)if(1===t.values.values.length){const e=t.values.values[0];i=n(e.title,e.id,"criteria_value[]")}else i=$("<select>",{name:"criteria_value[]",class:"form-control"}),t.values.values&&t.values.values.forEach((e=>{i.append(new Option(e.title,e.id))})),i.val(a);else{const e=t.values?t.values.inputType:"text";i=$("<input>",{class:"form-control",name:"criteria_value[]",type:e,value:a||""})}o.find("input, select").remove(),o.append(i)}(e,r,l),r.conditions?o(e,r.conditions,s):i(e,$("#scheduleCriteriaFields").data("criteriaDefaultCondition"),s))}else c=$("<input>",{class:"form-control",name:"criteria_metric[]",type:"text",value:""})}d.find("input, select").remove(),d.append(c)}(d,s.type,s.metric,s.value,s.condition)}))}else{const e=$(templates.schedule.criteriaFields({isAdd:!0,trans:translations.schedule.criteriaFields})),a=e.find('select[name="criteria_type[]"]');l(a),t.append(e)}t.on("click","button",(function(e){e.preventDefault();const a=$(e.currentTarget);if(a.data("isAdd")){const e=$(templates.schedule.criteriaFields({isAdd:!1,trans:translations.schedule.criteriaFields}));t.append(e);const n=e.find('select[name="criteria_type[]"]');l(n),a.data("isAdd",!0)}else a.closest(".form-group").remove()}))},y=function(e,t){t.criteria=[],$.each(t.criteria_metric,(function(e,a){a&&t.criteria.push({id:t.criteria_id[e],type:t.criteria_type[e],metric:a,condition:t.criteria_condition[e],value:t.criteria_value[e]})})),delete t.criteria_id,delete t.criteria_type,delete t.criteria_metric,delete t.criteria_criteria,delete t.criteria_value}},44447:function(){let lastForm,autoSubmitTemplate=null;function XiboClockUpdate(e){$("#XiboClock").html(e)}function XiboHoverRender(url,x,y){return $.ajax({type:"get",url:url,cache:!1,dataType:"json",success:function(response){if(response.success){let dialogWidth="500",dialogHeight="500";response.dialogSize&&(dialogWidth=response.dialogWidth,dialogHeight=response.dialogHeight),$("body").append('<div class="XiboHover"></div>'),$(".XiboHover").css("position","absolute").css({display:"none",width:dialogWidth,height:dialogHeight,top:y,left:x}).fadeIn("slow").hover((function(){return!1}),(function(){return $(".XiboHover").hide().remove(),!1})),$(".XiboHover").html(response.html),""!=response.callBack&&null!=response.callBack&&eval(response.callBack)(name),XiboInitialise(".XiboHover")}else{if(response.login)return LoginBox(response.message),!1;null==response.message?SystemMessage(response):SystemMessage(response.message)}return!1}}),!1}function createColorPicker(e,t){const a=$(e);a.attr("autocomplete","off"),a.colorpicker(Object.assign({format:"hex"},t))}function updateDateRangeFilter(e){const t=$(e).find("option:selected").val(),a=$(e).closest("form"),n=$(e).attr("id");let o=moment().startOf("day"),i=moment().endOf("day");if($(`.rangeFilterInput_${n}`).removeClass("hidden"),""===t||void 0===t)a.find(`.rangeFilterInput_${n}`).show(),updateDateRangeSelection(a,n);else switch(a.find(`.rangeFilterInput_${n}`).hide(),t){case"yesterday":o=moment().startOf("day").subtract(1,"days"),i=moment().endOf("day").subtract(1,"days");break;case"thisweek":o=moment().startOf("week"),i=moment().endOf("week");break;case"thismonth":o=moment().startOf("month"),i=moment().endOf("month");break;case"thisyear":o=moment().startOf("year"),i=moment().endOf("year");break;case"lastweek":o=moment().startOf("week").subtract(1,"weeks"),i=moment().endOf("week").subtract(1,"weeks");break;case"lastmonth":o=moment().startOf("month").subtract(1,"months"),i=moment().endOf("month").subtract(1,"months");break;case"lastyear":o=moment().startOf("year").subtract(1,"years"),i=moment().endOf("year").subtract(1,"years")}formatInputFields(a,n,o,i)}function updateDateRangeSelection(e,t){let a=moment().startOf("day"),n=moment().endOf("day");$(`.rangeFilterInput_${t}`).on("change",(function(){a=moment($(`#fromDt_${t}`).val()).startOf("day").format(),n=moment($(`#toDt_${t}`).val()).endOf("day").format(),moment(n).diff(moment(a),"days")<=0&&(a=moment(a).startOf("day").format(),n=moment(a).endOf("day").format()),formatInputFields(e,t,a,n)}))}function formatInputFields(e,t,a,n){e.find(`#fromDt_${t}`).val(moment(a).format("YYYY-MM-DD HH:mm:ss")),e.find(`#toDt_${t}`).val(moment(n).format("YYYY-MM-DD HH:mm:ss"))}String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.indexOf(e,t)===t}),String.prototype.endsWith||(String.prototype.endsWith=function(e){return-1!==this.indexOf(e,this.length-e.length)}),$(document).on("click",'*[data-toggle="lightbox"]',(function(e){e.preventDefault(),$(e.currentTarget).ekkoLightbox({onContentLoaded:function(){const e=$(".ekko-lightbox-container");e.css({"max-height":e.height(),height:"","max-width":e.width()}),e.parents(".modal-content").css({width:"fit-content"})}})})),$((function(){window.console||function(){const e=["log","debug","info","warn","error","assert","dir","dirxml","group","groupEnd","time","timeEnd","count","trace","profile","profileEnd"],t=e.length;let a;for(window.console={},a=0;a<t;a++)window.console[e[a]]=function(){}}();const e=$("#sidebar-wrapper ul.sidebar"),t=e.find('li.sidebar-list a[href="'+window.location.pathname+'"]').addClass("sidebar-list-selected");t.length>0&&e.length>0&&t.offset().top+t.height()>e.height()-e[0].scrollTop&&t[0].scrollIntoView(),setInterval("XiboPing('"+clockUrl+"')",6e4),setInterval("XiboPing('"+pingUrl+"')",18e4),XiboInitialise("")})),window.XiboInitialise=function(t,a){null!=t&&""!=t||(t=" "),$(t+" .XiboGrid").each((function(e,t){$(t).find("select.XiboDateRangeFilter").on("change",(function(e){updateDateRangeFilter(e.currentTarget)}))})),$(t+" .XiboFormButton").on("click",(function(e){const t=$(e.currentTarget),a=t.data("eventStart"),n=t.data("eventEnd");return void 0!==a&&void 0!==n?XiboFormRender(t,{eventStart:a,eventEnd:n}):XiboFormRender(t),!1})),$(t+" .XiboCustomFormButton").on("click",(function(e){return XiboCustomFormRender($(e.currentTarget)),!1})),$(t+" .XiboRedirectButton").on("click",(function(e){window.location=$(e.currentTarget).attr("href")})),$(t+" .XiboHoverButton").on("mouseenter",(function(t){return XiboHoverRender($(t.currentTarget).attr("href"),e.pageX,e.pageY),!1})).on("mouseleave",(function(){return!1})),$(t+" .XiboForm:not(.custom-validation)").each(((e,t)=>{const a=$(t);forms.validateForm(a,a.parent(),{submitHandler:XiboFormSubmit})})),$(t+' input[type="number"][min], '+t+' input[type="number"][max]').each(((e,t)=>{const a=$(t),n=a.attr("max"),o=a.attr("min");a.on("blur",(()=>{n&&a.val()>n&&a.val(n).trigger("change"),o&&a.val()<o&&a.val(o).trigger("change")}))})),$(t+" .XiboAjaxSubmit").on("click",(function(e){return $.ajax({type:"post",url:$(e.currentTarget).attr("href"),cache:!1,dataType:"json",success:XiboSubmitResponse}),!1})),$(t+" .XiboAutoForm").on("submit",(function(e){return XiboFormSubmit(e.currentTarget),!1})),$(t+" .XiboTextForm").each(((e,t)=>{const a=$(t);console.log("validateForm XiboTextForm"),forms.validateForm(a,a.parent(),{submitHandler:XiboFormSubmit})})),$(t+" .XiboHelpButton").on("click",(function(e){const t=$(e.currentTarget).attr("href");return window.open(t),!1})),$(t+" .dropdown-menu").on("click",(function(t){$(t.currentTarget).hasClass("dropdown-menu-form")&&e.stopPropagation()})),$(t+" .selectPicker select.form-control").select2({dropdownParent:$(t).hasClass("modal")?$(t):$("body"),templateResult:function(e){if(!e.id)return e.text;const t=$(e.element);return void 0!==t.data().content?$(t.data().content):e.text}}),$(t+" .pagedSelect select.form-control").each((function(e,a){const n=$(a),o=n.data("anchorElement"),i=$(t).hasClass("modal")||$(t).parents(".modal").length>0;void 0!==o&&""!==o?makePagedSelect(n,$(o)):i?makePagedSelect(n,$(t)):makePagedSelect(n,$("body"))})),$(t+" .localSelect select.form-control").each((function(e,a){makeLocalSelect($(a),$(t).hasClass("modal")?$(t):$("body"))})),$(t+" span.notification-date").each((function(e,t){$(t).html(moment($(t).html(),"X").fromNow())})),$(t+" input.bootstrap-switch-target").each((function(e,t){$(t).bootstrapSwitch()})),$(t+" .colorpicker-input:not(.colorpicker-element)").each((function(e,t){$(t).colorpicker({container:$(t).parent()})})),$(t+" input[data-role=tagsInputInline], "+t+" input[data-role=tagsInputForm], "+t+" select[multiple][data-role=tagsInputForm]").each((function(e,t){const a=$(t),n=a.data("autoCompleteUrl");if(null!=n&&""!=n){const e=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.whitespace,queryTokenizer:Bloodhound.tokenizers.whitespace,initialize:!1,remote:{url:n,prepare:function(e,t){return t.data={tag:e},t},filter:function(e){return $.map(e.data,(function(e){return{tag:e.tag}}))}},sorter:function(e,t){const a=e.tag.toUpperCase(),n=t.tag.toUpperCase();return a<n?-1:a>n?1:0}});e.initialize().done((function(){a.tagsinput({typeaheadjs:{name:"tags",displayKey:"tag",valueKey:"tag",source:e.ttAdapter()}})})).fail((function(){console.info("Auto-complete for tag failed! Using default..."),a.tagsinput()}))}else a.tagsinput();$(".bootstrap-tagsinput input").on("blur",(function(e){""!==$(e.currentTarget).val()&&(a.tagsinput("add",$(e.currentTarget).val()),$(e.currentTarget).val(""))}))})),$(t+" .tags-with-value").length>0&&forms.tagsWithValues($(t).find("form").attr("id")),$(t+" .XiboCommand").each((function(t,a){const n=$(a),o=n.find("input");o.hide();const i={freetext:translations.freeTextCommand,tpv_led:"Philips Android",rs232:"RS232",intent:"Android Intent",http:"HTTP"},r=function(e){const t=o.val(),a=l(o.val()),i=n.find(".command-inputs"),r=templates.forms.commandInput[e];if(i.html(r({value:a.value,initVal:t,unique:(new Date).valueOf(),trans:translations.commandInput})),"intent"==e){const t=templates.forms.commandInput["intent-extra"];null!=a.value.extras&&a.value.extras.forEach((function(e){i.find(".intent-extra-container").append(t({...e,trans:translations.commandInput}))})),i.find(".intent-add-extra").on("click",(function(){i.find(".intent-extra-container").append(t({trans:translations.commandInput})),s(e)})),i.off("click",".intent-remove-extra").on("click",".intent-remove-extra",(function(t){$(t.currentTarget).parents(".intent-extra-element").remove(),s(e)}))}if("http"==e){const t=templates.forms.commandInput["http-key-value"],n=[".query-builder-container",".http-headers-container",".http-data-container"],o=[null!=a.value&&null!=a.value.query?a.value.query:null,null!=a.value&&null!=a.value.requestOptions&&null!=a.value.requestOptions.headers?a.value.requestOptions.headers:null,null!=a.value&&null!=a.value.requestOptions&&null!=a.value.requestOptions.body?a.value.requestOptions.body:null],r=function(e,a){e.find(".http-key-value-container").empty();for(let n=0;n<Object.keys(a).length;n++)e.find(".http-key-value-container").append(t({key:Object.keys(a)[n],value:Object.values(a)[n],trans:translations.commandInput}))},l=function(e){const t=$(this);e=null!=e&&e;const a=t.parents(".request-section"),n=function(e){let t;try{t=JSON.parse(e)}catch(e){console.warn(e),console.warn("Value not a JSON!")}return t},o=i.find(".http-contenttype").val();if(t.is(":checked")||e)a.find("textarea").hasClass("http-data")&&"application/json"!=o?"application/x-www-form-urlencoded"==o&&a.find("textarea").val(function(e){const t={};return e.find(".http-key-value-container .http-key-value-element").each((function(e,a){const n=$(a),o=n.find(".http-key").val(),i=n.find(".http-value").val();[o,i].includes("")||(t[o]=i)})),Object.keys(t).map((e=>e+"="+t[e])).join("&")}(a)):a.find("textarea").val(function(e){const t={};return e.find(".http-key-value-container .http-key-value-element").each((function(e,a){const n=$(a),o=n.find(".http-key").val(),i=n.find(".http-value").val();[o,i].includes("")?n.addClass("invalid"):(t[o]=i,n.removeClass("invalid"))})),JSON.stringify(t)}(a));else{let e;a.find("textarea").hasClass("http-data")&&"application/json"!=o?"application/x-www-form-urlencoded"==o&&(e=n(function(e){let t;try{t='{"'+decodeURI(e.replace(/&/g,'","').replace(/=/g,'":"'))+'"}'}catch(e){console.warn(e),console.warn("Decode URI failed!")}return t}(a.find("textarea").val()))):e=n(a.find("textarea").val()),e&&r(a,e)}};for(let a=0;a<o.length;a++){const d=o[a],c=i.find(n[a]);null!=d&&r(c,d),c.find(".http-key-value-add").on("click",(function(a){$(a.currentTarget).parent().find(".http-key-value-container").append(t({})),s(e)})),c.off("click",".http-key-value-remove").on("click",".http-key-value-remove",(function(t){$(t.currentTarget).parents(".http-key-value-element").remove(),s(e)})),c.parent().find('.form-check input[type="checkbox"]').off("change").on("change",(function(t){const a=$(t.currentTarget);a.hasClass("show-raw-headers")||a.hasClass("show-raw-data")?l.bind(t.currentTarget)():s(e);const n=a.parents(".request-section");n.find(a.data("toggleElement")).toggleClass(a.data("toggleClass"),a.is(":checked")),n.find(a.data("toggleElementReverse")).toggleClass(a.data("toggleClass"),!a.is(":checked"))})),c.parent().off("change",".http-key-value-container .http-key-value-element input").on("change",".http-key-value-container .http-key-value-element input",(function(e){l.bind(e.currentTarget)(!0)})),l.bind(c)(!0)}i.find(".http-contenttype").off("change").on("change",(function(e){const t="text/plain"==$(e.currentTarget).val();i.find(".show-raw-data").parent().toggleClass("d-none",t),i.find(".show-raw-data").prop("checked",t).trigger("change"),t||l.bind($(".http-data-container"))(!0)}))}i.off("change","input:not(.ignore-change), select, textarea").on("change","input:not(.ignore-change), select, textarea",(function(){s(e)})),s(e)},l=function(e){const t={};if(""==e||null==e)t.type="freetext",t.value="";else{const a=e.split("|");if(1==a.length)t.type="freetext",t.value=e;else switch(t.type=a[0],t.type){case"intent":t.value={type:a[1],name:a[2],extras:a.length>3?JSON.parse(a[3]):[]};break;case"rs232":const n=a[1].split(","),o={deviceName:n[0],baudRate:n[1],dataBits:n[2],parity:n[3],stopBits:n[4],handshake:n[5],hexSupport:n[6]};t.value={cs:o,command:a[2]};break;case"tpv_led":t.type="tpv_led",t.value=a[1];break;case"http":let i={};const r=a[2];if(null!=a[3])try{i=JSON.parse(a[3])}catch(e){console.log(e),console.warn("Skip JSON parse!")}if(null!=i.headers)try{i.headers=SON.parse(i.headers)}catch(e){console.warn(e),console.warn("Skip headers JSON parse!")}if(null!=i.body)try{if(r)if("application/json"==r)i.body=JSON.parse(i.body);else if("application/x-www-form-urlencoded"==r){const e=decodeURI(i.body).split("&"),t={};e.forEach((e=>{const a=e.split("=");(a.length=2)&&(t[a[0]]=a[1])})),i.body=t}}catch(e){console.warn(e),console.warn("Skip body parse!")}t.type="http",t.value={url:a[1],contenttype:a[2],requestOptions:i};break;default:t.type="freetext",t.value=e}}return t},s=function(t){let a="",i=!1;const r=n.find(".command-inputs");switch(t){case"tpv_led":a="tpv_led|"+r.find(".tpv-led-command").val();break;case"http":let t=r.find(".http-url").val();const n={};if(""==t?(i=!0,r.find(".http-url").addClass("invalid")):r.find(".http-url").removeClass("invalid"),r.find(".show-query-builder").is(":checked")){if(2==t.split("?").length){const e=t.split("?")[1];let a=[];try{a=decodeURI(e).split("&")}catch(e){console.warn("malformed URI:"+e)}t=t.split("?")[0];for(let e=0;e<a.length;e++){const t=a[e].split("=");2==t.length&&(n[t[0]]=t[1])}}r.find(".query-builder-container .http-key-value-container .http-key-value-element").each((function(t){const a=$(t.currentTarget);a.removeClass("invalid");let o=a.find(".http-key").val(),r=a.find(".http-value").val();try{o=encodeURI(o),r=encodeURI(r)}catch(t){console.warn(t),console.warn("malformed URI:"+e),o="",r=""}[o,r].includes("")?(i=!0,a.addClass("invalid")):(n[o]=r,a.removeClass("invalid"))}));const a=Object.keys(n).map((e=>e+"="+n[e])).join("&");t+=""!=a?"?"+encodeURI(a):""}let o={};o.method=r.find(".http-method").val();const l=r.find(".http-contenttype").val(),s=r.find(".http-headers").val();r.find(".http-headers").parent().removeClass("invalid");try{JSON.parse(s),o.headers=s}catch(e){console.warn("Invalid headers: "+e),i=!0,r.find(".http-headers").parent().addClass("invalid")}const d=r.find(".http-data").val();r.find(".http-data").parent().removeClass("invalid");try{"application/json"==l?JSON.parse(d):"application/x-www-form-urlencoded"==l&&decodeURI(d),o.body=d}catch(e){console.warn("Invalid body: "+e),i=!0,r.find(".http-data").parent().addClass("invalid")}"object"==typeof o&&(o=JSON.stringify(o)),a="http|",a+=t+"|",a+=l+"|",a+=o;break;case"rs232":const c=r.find(".rs232-device-name").val(),u=r.find(".rs232-baud-rate").val(),p=r.find(".rs232-data-bits").val(),f=r.find(".rs232-parity").val(),m=r.find(".rs232-stop-bits").val(),g=r.find(".rs232-handshake").val(),h=r.find(".rs232-hex-support").val(),y=r.find(".rs232-command").val();r.find(".rs232-device-name").toggleClass("invalid",""==c),r.find(".rs232-baud-rate").toggleClass("invalid",""==u),r.find(".rs232-data-bits").toggleClass("invalid",""==p),[c,u,p].includes("")&&(i=!0),a="rs232|",a+=""!=c?c+",":"",a+=""!=u?u+",":"",a+=""!=p?p+",":"",a+=""!=f?f+",":"",a+=""!=m?m+",":"",a+=""!=g?g+",":"",a+=h,a+="|"+y;break;case"intent":a="intent|"+r.find(".intent-type").val()+"|"+r.find(".intent-name").val(),""==r.find(".intent-name").val()?(r.find(".intent-name").addClass("invalid"),i=!0):r.find(".intent-name").removeClass("invalid");const b=[];r.find(".intent-extra-element").each((function(e){const t=$(e.currentTarget);t.removeClass("invalid");const a=t.find(".extra-name").val(),n=t.find(".extra-type").val();let o=t.find(".extra-value").val();if("intArray"==n){o=o.replace(" ","").split(",").map((function(e){return""!=e?Number(e):""}));for(let e=0;e<o.length;e++){const t=o[e];if(isNaN(t)||""==t){o="";break}}}else"int"==n&&""!=o?o=isNaN(Number(o))?"":Number(o):"bool"==n&&""!=o&&(o="true"==o);[a,n,o].includes("")?(i=!0,t.addClass("invalid")):b.push({name:a,type:n,value:o})})),b.length>0&&(a+="|"+JSON.stringify(b));break;default:a=r.find(".free-text").val()}i?(o.val(""),n.find(".command-preview code").text(n.find(".command-preview").data("invalidMessage")),n.find(".command-preview").addClass("invalid")):(o.val(a),n.find(".command-preview code").text(a),n.find(".command-preview").removeClass("invalid"))},d=l(o.val()).type,c=templates.forms.commandInput.main;o.before(c({types:i,type:d,unique:(new Date).valueOf(),trans:translations.commandInput})),r(d),$(a).find(".command-type").on("change",(function(e){r($(e.currentTarget).val())})),$(a).find(".show-command-preview").on("change",(function(e){n.find(".command-preview").toggle($(e.currentTarget).is(":checked"))})),o.attr("readonly","readonly")})),$(t+" .XiboColorPicker").each((function(e,t){createColorPicker(t)})),$(t+" .XiboData").on("shown.bs.dropdown",".dropdown-menu-container",(function(e){const t=$(e.currentTarget).find(".dropdown-menu.show");setTimeout((function(){t.offset().top<0&&t.offset({top:0,left:t.offset().left})}),200)})),$(t+" #fullScreenCampaignId").each((function(e,t){const a=$(t).closest("form"),n=parseInt(a.find("#eventTypeId").val()),o=a.find("#fullScreen-mediaId").val(),i=a.find("#fullScreen-playlistId").val();let r,l={};null!=o&&""!==o?(l={mediaId:o},r=a.data().libraryGetUrl):null!=i&&null!=i&&""!==i&&(l={playlistId:i},r=a.data().playlistGetUrl),null!=r&&[7,8].includes(n)&&$.ajax({type:"GET",url:r,cache:!1,dataType:"json",data:l}).then((e=>{e.success||SystemMessageInline(""===e.message?translations.failure:e.message,a.closest(".modal")),7==n?a.find("#fullScreen-media").val(e.data[0].name):8==n&&a.find("#fullScreen-playlist").val(e.data[0].name),e.data[0]?.fullScreenCampaignId&&a.find("#fullScreenCampaignId").val(e.data[0].fullScreenCampaignId).trigger("change"),e.data[0]?.hasFullScreenLayout||(7==n?a.find("#fullScreenControl_media").trigger("autoOpen"):8==n&&a.find("#fullScreenControl_playlist").trigger("autoOpen"))}),(e=>{SystemMessage(e.responseText,!1)}))})),$(t+" .full-screen-layout-form").on("click autoOpen",(function(e){const a=$(e.currentTarget);0!=$("#full-screen-schedule-modal").length&&$("#full-screen-schedule-modal").remove();const n=a.parents(t),o=a.closest("form").find("#eventTypeId").val(),i=a.closest("form").find("#fullScreen-mediaId").val(),r=a.closest("form").find("#fullScreen-playlistId").val(),l=a.data("readonly");if(0===$("#full-screen-schedule-modal").length){const t={type:7==o?"Media":"Playlist",eventTypeId:o,readonlySelect:l};$("body").append(templates.schedule.fullscreenSchedule({...t,trans:translations.schedule.fullscreen,fullscreenSchedule:fullscreenSchedule}));const a=$("#full-screen-schedule-modal");"autoOpen"===e.type&&a.find("button.close").on("click",(function(){n.modal("hide")})),a.on("show.bs.modal",(function(){$(".no-full-screen-layout").addClass("d-none")})).on("shown.bs.modal",(function(){const e=a.find("form");e.find(".pagedSelect select.form-control").each((function(t,a){const n=$(a);"mediaId"==n.attr("name")&&null!=i?n.data("initialValue",i):"playlistId"==n.attr("name")&&null!=r&&n.data("initialValue",r),makePagedSelect(n,"#"+e.attr("id"))})),e.find(".colorpicker-input:not(.colorpicker-element)").each((function(e,t){$(t).colorpicker({container:$(t).parent()})})),$("#mediaId, #playlistId",e).on("select2:select",(function(e){let t=!1;void 0!==e.params.data.data?t=e.params.data.data[0].hasFullScreenLayout:void 0!==e.params.data.hasFullScreenLayout&&(t=e.params.data.hasFullScreenLayout),t?$(".no-full-screen-layout").addClass("d-none"):"mediaId"===$(e.currentTarget).attr("name")?$(".no-full-screen-layout").removeClass("d-none"):$(".no-full-screen-layout.media-playlist-control").removeClass("d-none")})),l&&e.find("#mediaId, #playlistId").prop("disabled",!0);const t=$(".resolution-control"),n=e.find("#resolutionId");7==o?t.children("div").children("small.form-text.text-muted").text(n.data("transMediaHelpText")):8==o&&t.children("div").children("small.form-text.text-muted").text(n.data("transPlaylistHelpText")),$("#btnFullScreenLayoutConfirm").on("click",(function(t){t.preventDefault(),fullscreenBeforeSubmit(e)})),XiboInitialise("#scheduleFullScreenForm")})).on("hidden.bs.modal",(function(e){$(".modal:visible").length&&$(document.body).addClass("modal-open"),$(e.currentTarget).data("bs.modal",null)})),a.modal({backdrop:"static",keyboard:!1,show:!0})}})),forms&&"function"==typeof forms.initFields&&forms.initFields(" "===t?"body":t,null,a&&a.targetId?a.targetId:null,!(!a||!a.readOnlyMode)&&a.readOnlyMode)},window.XiboFormRender=function(sourceObj){let data=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,formUrl="";return"string"==typeof sourceObj||sourceObj instanceof String?formUrl=sourceObj:(formUrl=sourceObj.attr("href"),sourceObj.removeAttr("href")),null==formUrl||(lastForm=formUrl,$.ajax({type:"get",url:formUrl,cache:!1,dataType:"json",data:data,success:function(response){if(("object"==typeof sourceObj||sourceObj instanceof Object)&&sourceObj.attr("href",lastForm),response.success){if(!("string"==typeof sourceObj||sourceObj instanceof String)){const e=sourceObj.data().commitUrl;if(response.autoSubmit&&void 0!==e)return $.ajax({type:sourceObj.data().commitMethod||"POST",url:e,cache:!1,dataType:"json",success:function(e){e.success?(""!==e.message&&SystemMessage(e.message,!0),XiboRefreshAllGrids()):e.login?LoginBox(e.message):SystemMessageInline(e.message)},error:function(e){SystemMessageInline(e.responseText)}}),!1}let dialogTitle="";null!=response.dialogTitle&&""!=response.dialogTitle&&(dialogTitle=response.dialogTitle);const id=(new Date).getTime();let size="large";sourceObj&&"object"==typeof sourceObj&&(size=sourceObj.data().modalSize||"large"),bootbox.hideAll();const dialog=bootbox.dialog({message:response.html,title:dialogTitle,animate:!1,size:size}).attr("id",id);if(dialog.data("extra",response.extra),""!==response.buttons){const footer=$("<div>").addClass("modal-footer");dialog.find(".modal-content").append(footer);let i=0;const count=Object.keys(response.buttons).length;$.each(response.buttons,(function(index,value){i++;const extrabutton=$('<button id="dialog_btn_'+i+'" class="btn">').html(index);i===count?extrabutton.addClass("btn-primary save-button"):extrabutton.addClass("btn-white"),extrabutton.on("click",(function(ev){ev.preventDefault();const $button=$(ev.currentTarget);if($button.hasClass("save-button")){if($button.hasClass("disabled"))return!1;$button.append(' <span class="saving fa fa-cog fa-spin"></span>'),$button.addClass("disabled")}return eval(value),!1})),footer.append(extrabutton)})),"string"==typeof sourceObj||sourceObj instanceof String||sourceObj.data().autoSubmit&&(null===autoSubmitTemplate&&(autoSubmitTemplate=templates["auto-submit-field"]),footer.prepend(autoSubmitTemplate({trans:translations.autoSubmitField})))}$("input[type=text]",dialog).not(".dateControl").eq(0).focus(),$("input[type=text]",dialog).each((function(e,t){formRenderDetectSpacingIssues(t),$(t).on("keyup",_.debounce((function(){formRenderDetectSpacingIssues(t)}),500))})),""!=response.fieldActions&&$.each(response.fieldActions,(function(e,t){if("init"==t.trigger){const e=$("#"+t.field).val();let a=!1;a="not"==t.operation?e!=t.value:"is:checked"==t.operation?t.value==$("#"+t.field).is(":checked"):e==t.value,a&&$.each(t.actions,(function(e,t){const a=$(e);a.data("initActioned")||a.css(t).data("initActioned",!0)}))}else $("#"+t.field).on(t.trigger,(function(e){const a=$(e.currentTarget).val();let n=!1;n="not"==t.operation?a!=t.value:"is:checked"==t.operation?t.value==$("#"+t.field).is(":checked"):a==t.value,n&&$.each(t.actions,(function(e,t){$(e).css(t)}))}))})),$('a[data-toggle="tab"]',dialog).on("shown.bs.tab",(function(e){1===$(e.target).data().enlarge?$(e.target).closest(".modal").addClass("modal-big"):$(e.target).closest(".modal").removeClass("modal-big")})),$('a[data-toggle="tab"]',dialog).each((function(e,t){1===$(t).data().enlarge&&$(t).closest("li").hasClass("active")&&$(t).closest(".modal").addClass("modal-big")})),0!=$("#folder-tree-form-modal").length&&$("#folder-tree-form-modal").remove(),XiboInitialise("#"+dialog.attr("id")),XiboInitDatatables("#"+dialog.attr("id")),null!=dialog.find(".XiboForm").attr("id")&&(void 0!==$("#container-folder-tree").jstree("get_selected",!0)[0]&&""==$("#"+dialog.find(".XiboForm").attr("id")+" #folderId").val()&&$("#"+dialog.find(".XiboForm").attr("id")+" #folderId").val($("#container-folder-tree").jstree("get_selected",!0)[0].id),initJsTreeAjax("#container-folder-form-tree",dialog.find(".XiboForm").attr("id"),!0,600)),""!==response.callBack&&void 0!==response.callBack&&eval(response.callBack)(dialog)}else{if(response.login)return LoginBox(response.message),!1;null==response.message?SystemMessage(response):SystemMessage(response.message)}return!1},error:function(e){SystemMessage(e.responseText)}})),!1},window.XiboCustomFormRender=function(e){let t="";return t=e.attr("href"),e.removeAttr("href"),null==t||(lastForm=t,$.ajax({type:"get",url:t,cache:!1,dataType:"json",success:function(t){if(("object"==typeof e||e instanceof Object)&&e.attr("href",lastForm),t.success){const e={id:(new Date).getTime(),buttons:t.buttons,data:t.data,title:t.dialogTitle,message:t.html,extra:t.extra};""!==t.callBack&&void 0!==t.callBack&&window[t.callBack](e)}else{if(t.login)return LoginBox(t.message),!1;null==t.message?SystemMessage(t):SystemMessage(t.message)}return!1},error:function(e){SystemMessage(e.responseText)}})),!1},window.XiboRemoteRequest=function(e,t,a){$.ajax({type:"post",url:e,cache:!1,dataType:"json",data:t,success:a,error:function(e){SystemMessage(e.responseText)}})},window.formRenderDetectSpacingIssues=function(e){const t=$(e),a=t.val();if(""!==a&&(a.startsWith(" ")||a.endsWith(" ")||a.indexOf("  ")>-1)){console.debug("Field with strange spacing: "+t.attr("name"));const e=$("<span></span>").addClass("fa fa-exclamation-circle spacing-warning-icon").attr("title",translations.spacesWarning);t.parent().append(e)}else t.parent().find(".spacing-warning-icon").remove()},window.XiboMultiSelectFormRender=function(button){const buttonId=$(button).data().buttonId,matches=[];let formOpenCallback=null,message;$("."+buttonId).each((function(e,t){const a=$(t);a.closest("tr").hasClass("selected")&&(matches.push(a),1===matches.length&&(formOpenCallback=a.data().formCallback,formConfirm=a.data().formConfirm))})),message=matches.length>0?translations.multiselectMessage.replace("%1",""+matches.length).replace("%2",$(button).html()):translations.multiselectNoItemsMessage;const dialog=bootbox.dialog({message:message,title:translations.multiselect,animate:!1,size:"large"}),dialogContent=dialog.find(".modal-body"),footer=$("<div>").addClass("modal-footer");let extrabutton;dialog.find(".modal-content").append(footer),null!=formOpenCallback&&eval(formOpenCallback)(dialog),matches.length>0&&(extrabutton=$('<button class="btn">').html(translations.save).addClass("btn-primary save-button"),formConfirm&&extrabutton.prop("disabled",!0),extrabutton.on("click",(function(e){return $(e.currentTarget).append(' <span class="saving fa fa-cog fa-spin"></span>'),window.queue=$.jqmq({delay:-1,batch:1,callback:function(e){let t=$(e).data();void 0!==dialog.data().commitData&&(t=$.extend({},t,dialog.data().commitData)),$.ajax({type:t.commitMethod,url:t.commitUrl,cache:!1,dataType:"json",data:t,success:function(e,a,n){e.success?(dialogContent.append($("<div>").html(t.rowtitle+": "+translations.success)),queue.next()):e.login?LoginBox(e.message):(dialogContent.append($("<div>").html(t.rowtitle+": "+translations.failure)),footer.find(".saving").remove(),SystemMessageInline(e.message,footer.closest(".modal")))},error:function(e){SystemMessage(e,!1)}})},complete:function(){footer.find(".saving").parent().remove(),XiboRefreshAllGrids()}}),$(matches).each((function(e,t){queue.add(t)})),queue.start(),!1})),footer.append(extrabutton)),extrabutton=$('<button class="btn">').html(translations.close).addClass("btn-white"),extrabutton.on("click",(function(e){return $(e.currentTarget).append(' <span class="saving fa fa-cog fa-spin"></span>'),dialog.modal("hide"),$(".modal").hasClass("in")&&$("body").addClass("modal-open"),!1})),footer.append(extrabutton)},window.XiboPing=function(e,t){$.ajax({type:"get",url:e,cache:!1,dataType:"json",success:function(e){if(e.success)null!=t&&$(t).html(e.html),e.clockUpdate&&XiboClockUpdate(e.html);else if(e.login)return LoginBox(e.message),!1;return!1}})},window.XiboFormSubmit=function(e,t,a){const n=$(e),o=n.attr("action");return formHelpers.updateCKEditor(),$.ajax({type:n.attr("method"),url:o,cache:!1,dataType:"json",data:n.serialize(),success:function(t,o,i){if(XiboSubmitResponse(t,e),null!=a&&null!=a)a(t,e);else{const a=n.data("submitCallBack");a&&"function"==typeof window[a]&&window[a](t,e)}},error:function(e,t,a){SystemMessage(e.responseText,!1)}}),n.closest(".modal-dialog").find("input[name=autoSubmit]").is(":checked")&&updateUserPref([{option:"autoSubmit."+n.attr("id"),value:!0}]),!1},window.XiboSubmitResponse=function(response,form){$(form).closest(".modal-dialog").find(".saving").remove();const apply=$(form).data("apply");if($(form).data("apply",!1),response.success){if(""!=response.message&&SystemMessage(response.message,!0),null!=apply&&apply?($(form).data("applyCallback")&&eval($(form).data("applyCallback"))(form),$(form).closest(".modal-dialog").find(".form-error").remove(),$("input[type=text]",form).eq(0).focus()):bootbox.hideAll(),XiboRefreshAllGrids(),!apply&&void 0!==$(form).data("nextFormUrl")){const e=void 0===$(form).data("nextFormIdProperty")?response.id:response.data[$(form).data("nextFormIdProperty")];XiboFormRender($(form).data().nextFormUrl.replace(":id",e))}}else response.login?LoginBox(response.message):SystemMessageInline(response.message,$(form).closest(".modal"));return!1},window.XiboDialogClose=function(e){e=void 0!==e,bootbox.hideAll(),e&&XiboRefreshAllGrids()},window.XiboDialogApply=function(e){const t=$(e);t.data("apply",!0),t.submit()},window.XiboSwapDialog=function(e,t){bootbox.hideAll(),XiboFormRender(e,t)},window.XiboRedirect=function(e){window.location.href=e},window.LoginBox=function(e){window.location.reload()},window.updateUserPref=function(e,t){null==t&&(t=function(e){return e.success?SystemMessage(e.message,!0):e.login?LoginBox(e.message):SystemMessage(e.message,e.success),!1}),$.ajax({type:"post",url:userPreferencesUrl,cache:!1,dataType:"json",data:{preference:e},success:t})},window.SystemMessage=function(e,t){if(""!=e&&null!=e)if(t)toastr.success(e);else{const t=bootbox.dialog({message:e,title:"Application Message",size:"large",buttons:[{label:"Close",className:"btn-bb-close",callback:function(){t.modal("hide")}}],animate:!1})}},window.SystemMessageInline=function(e,t){""!=e&&null!=e&&(null!=t&&null!=t&&0!=t.length||(t=$(".modal")),t.length<=0?toastr.error(e):($(".form-error",t).remove(),$(t).find(".btn").removeClass("disabled"),$("<div/>",{class:"card bg-light p-3 text-danger col-sm-12 text-center form-error",html:e}).appendTo(t.find(".modal-footer"))))},window.makePagedSelect=function(e,t,a){if(!0===(arguments.length>3&&void 0!==arguments[3]&&arguments[3])){const t=Math.floor(1e9+9e9*Math.random()),a=$(e).attr("id"),n=a?a+"_"+t:t;$(e).attr("data-select2-id",n)}if(e.select2({dropdownParent:null==t?$("body"):$(t),minimumResultsForSearch:e.data("hideSearch")?1/0:1,ajax:{url:e.data("searchUrl"),dataType:"json",delay:250,data:function(t){let a={start:0,length:10},n=t.term;if(null!=n&&null!=e.data("searchTermTags")){const t=n.match(/\[([^}]+)\]/);let o="";null!=t&&(o=t[1],n=n.replace(t[0],""),a[e.data("searchTermTags")]=o)}return a[e.data("searchTerm")]=n,void 0!==e.data("filterOptions")&&(a=$.extend({},a,e.data("filterOptions"))),null!=t.page&&(a.start=10*(t.page-1)),a},processResults:function(t,n){const o=[],i=e;a&&"function"==typeof a&&(t=a(t));const r=i.data("displayAll")??!1;$.each(t.data,(function(e,t){const a={id:t[i.data("idProperty")],text:t[i.data("textProperty")]};if(void 0!==i.data("thumbnail")&&(a.thumbnail=t[i.data("thumbnail")]),void 0!==i.data("additionalProperty")){const e=i.data("additionalProperty").split(",");$.each(e,(function(e,n){a[n]=t[n]}))}o.push(a)}));let l=n.page||1;return l=l>1?l-1:l,{results:o,pagination:{more:!r&&10*l<t.recordsTotal}}}},templateResult:function(e){let t="";return e.thumbnail&&(t+="<span class='option-thumbnail mr-3'><img style='width: 100px; height: 60px; object-fit: cover;' src='"+e.thumbnail+"' /></span>"),t+="<span class='option-text'>"+e.text+"</span></span>",$(t)}}),e.on("select2:open",(function(e){setTimeout((function(){$(e.target).data("select2").dropdown?.$search?.get(0).focus()}),10)})),-1==[void 0,""].indexOf(e.data("initialValue"))&&-1==[void 0,""].indexOf(e.data("initialKey"))){const t=e.data("initialValue"),n=e.data("initialKey"),o=e.data("textProperty"),i=e.data("idProperty");let r={};r[n]=t,void 0!==e.data("filterOptions")&&(r=$.extend({},r,e.data("filterOptions"))),$.ajax({url:e.data("searchUrl"),type:"GET",data:r}).then((function(n){let r=!1;a&&"function"==typeof a&&(n=a(n),r=!0),n.data.forEach((a=>{let n=!0;if(r&&(n=t==a[i]),n){const t=new Option(a[o],a[i],n,n);e.append(t)}})),e.trigger("change",[{skipSave:!0}]),e.trigger({type:"select2:select",params:{data:n}})}))}},window.makeLocalSelect=function(e,t){if(!0===(arguments.length>2&&void 0!==arguments[2]&&arguments[2])){const t=Math.floor(1e9+9e9*Math.random()),a=$(e).attr("id"),n=a?a+"_"+t:t;$(e).attr("data-select2-id",n)}e.select2({dropdownParent:null==t?$("body"):$(t),matcher:function(e,t){const a=function(e,a){const n=$(t.element).data()[a],o=null!=n?n.replace(" ","").split(","):[];return null!=e&&""!=e&&!o.includes(e)},n=$(t.element.parentElement).data().filterClass;if(Array.isArray(n)){for(let e=0;e<n.length;e++)if(a(n[e],"filter"+e+"Class"))return null}else if(a(n,"filterClass"))return null;if(""===$.trim(e.term))return t;const o=e.term.match(/\[([^}]+)\]/);let i=e.term,r="";null!=o&&(r=o[1],i=e.term.replace(o[0],"")),i=i.trim().split(",").map((e=>e.trim())).filter((e=>""!==e)),r=r.replace(" ","").split(",");for(let e=0;e<i.length;e++){const a=i[e];if(""!=a&&t.text.toUpperCase().indexOf(a.toUpperCase())>-1)return t}for(let e=0;e<r.length;e++){const a=r[e];if(""!=a&&null!=$(t.element).data("tags")&&$(t.element).data("tags").toUpperCase().indexOf(a.toUpperCase())>-1)return t}return null},templateResult:function(e){if(!e.id)return e.text;const t=$(e.element);return void 0!==t.data().content?$(t.data().content):e.text}}),e.on("select2:open",(function(e){setTimeout((function(){$(e.target).data("select2").dropdown?.$search?.get(0).focus()}),10)}))},window.userPreferencesFormSubmit=function(){const e=$("#userPreferences");e.find('input[type="checkbox"]').each((function(e,t){const a=$(t).is(":checked")?"on":"off",n=$(t).attr("id");$('<input type="hidden">').attr("id",n).attr("name",n).val(a).appendTo($(t).parent()),$(t).attr("disabled",!0)})),e.submit()},window.initDatePicker=function(e,t,a,n,o,i,r){if(n=void 0===n?{}:n,o=void 0===o?null:o,i=void 0===i||i,r=void 0===r?null:r,null==t||null==a)return console.error("baseFormat and displayFormat needs to be defined!"),!1;e.data("customFormat")&&(a=e.data("customFormat"));let l=e;const s=e.val();if("Jalali"==calendarType)null!=n.altField?l=$(n.altField):(l=$('<input type="text" class="form-control" id="'+e.attr("id")+'Link">'),e.after(l).hide()),l.persianDatepicker(Object.assign({initialValue:null!=s&&s,altField:"#"+e.attr("id"),altFieldFormatter:function(e){return moment.unix(e/1e3).format(t)},onSelect:function(){e.trigger("change"),l.trigger("change")}},n)),l.attr("readonly","readonly");else if("Gregorian"==calendarType){e.parents(".bootbox.modal").removeAttr("tabindex"),flatpickr.l10ns.default.firstDayOfWeek=parseInt(moment().startOf("week").format("d"));const o=e.parents(".modal").length>0;flatpickr(e,Object.assign({altInput:!0,allowInput:!1,defaultDate:null!=s?s:null,altInputClass:"datePickerHelper "+e.attr("class"),disableMobile:!0,altFormat:a,dateFormat:t,locale:"en-GB"!=language?language:"default",defaultHour:"00",static:o,getWeek:function(e){return moment(e).week()},parseDate:function(e,t){return moment(e,t,!0).toDate()},formatDate:function(e,t,a){return moment(e).format(t)}},n)),o&&e.parent().css("flex",1)}l.on("change",(function(){null!=o&&"function"==typeof o&&o()})),i&&l.parents(".input-group").find(".date-clear-button").removeClass("d-none").on("click",(function(){updateDatePicker(l,""),null!=r&&"function"==typeof r&&r()})),l.parent().find(".date-open-button").on("click",(function(){"Gregorian"==calendarType?null!=l[0]._flatpickr&&l[0]._flatpickr.open():"Jalali"==calendarType&&l.data().datepicker.show()}))},window.updateDatePicker=function(e,t,a,n){n=void 0!==n&&n,"Gregorian"==calendarType?null!=e[0]._flatpickr?""==t?(e.val("").trigger("change"),e[0]._flatpickr.setDate("")):null!=a?e[0]._flatpickr.setDate(t,n,a):e[0]._flatpickr.setDate(t):(e.val(moment(t,a).isValid()?moment(t,a).format(systemDateFormat):""),n&&e.trigger("change")):"Jalali"==calendarType&&(""==t?(e.val("").trigger("change"),$("#"+e.attr("id")+"Link").val("").trigger("change")):$("#"+e.attr("id")+"Link").data().datepicker.setDate(1e3*moment(t,a).unix()))},window.destroyDatePicker=function(e){"Gregorian"==calendarType?(null!=e[0]._flatpickr&&e[0]._flatpickr.destroy(),null!=e.attr("value")&&e.val(e.attr("value"))):"Jalali"==calendarType&&$("#"+e.attr("id")+"Link").data().datepicker.destroy(),e.parent().find(".date-open-button").off("click")},window.updateRangeFilter=function(e,t,a,n){let o,i,r=e.val();const l="custom"===r,s=r.includes("last");if("agenda"===r&&(r="day"),l)$(".custom-date-range").removeClass("d-none");else{if($(".custom-date-range").addClass("d-none"),s){const e=r.replace("last","");o=moment().startOf(e).subtract(1,e+"s").format(jsDateFormat),i=moment().endOf(e).subtract(1,e+"s").format(jsDateFormat)}else o=moment().startOf(r).format(jsDateFormat),i=moment().endOf(r).format(jsDateFormat);updateDatePicker(t,o,jsDateFormat,!0),updateDatePicker(a,i,jsDateFormat,!0)}"function"==typeof n&&n()},window.createMiniLayoutPreview=function(e){if(0==$(".page-content").find(".mini-layout-preview").length){const e=templates["mini-player"];$(".page-content").append(e({trans:translations.miniPlayer}))}const t=$(".mini-layout-preview"),a=t.find("#content"),n=Handlebars.compile('<iframe scrolling="no" src="{{url}}" width="{{width}}px" height="{{height}}px" style="border:0;"></iframe>');a.html(""),t.find("#playBtn").show().off().on("click",(function(a){$(a.currentTarget).hide(),t.find("#content").append(n({url:e,width:t.hasClass("large")?"760":"440",height:t.hasClass("large")?"420":"240"}))})),t.find("#closeBtn").off().on("click",(function(){destroyMiniLayoutPreview()})),t.find("#newTabBtn").off().on("click",(function(){window.open(e,"_blank")})),t.find("#sizeBtn").off().on("click",(function(e){t.find("#content").html(""),t.toggleClass("large"),$(e.currentTarget).toggleClass("fa-arrow-circle-down",t.hasClass("large")),$(e.currentTarget).toggleClass("fa-arrow-circle-up",!t.hasClass("large")),t.find("#playBtn").show()})),t.addClass("show")},window.destroyMiniLayoutPreview=function(){const e=$(".mini-layout-preview");e.find("#content").html(""),e.removeClass("show"),e.remove()},window.formatBytes=function(e,t){if(0===e)return"0 Bytes";const a=0>t?0:t,n=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,n)).toFixed(a))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][n]},window.moveFolderMultiSelectFormOpen=function(e){0!=$("#folder-tree-form-modal").length&&$("#folder-tree-form-modal").remove();const t=$('<input name="folderId" type="hidden" id="formFolderId">');t.on("change",(function(t){e.data().commitData={folderId:$(t.currentTarget).val()}})),$(e).find(".modal-body").append('<div class="card p-3 mb-3 bg-light" id="container-folder-form-tree"></div>'),$(e).find(".modal-body").append(t),initJsTreeAjax("#container-folder-form-tree","multi-select-folder",!0,6e5)},window.triggerWebhookMultiSelectFormOpen=function(e){const t=$('<div class="form-group row"><label class="col-sm-2 control-label" for="triggerCode" accesskey="">'+translations.triggerCodeLabel+'</label><div class="col-sm-10"><input class="form-control" name="triggerCode" type="text" id="triggerCode" value=""><span class="help-block">'+translations.triggerCodeHelpText+"</span></div></div>");$(e).find(".modal-body").append(t),$("#triggerCode").on("change",(function(){e.data().commitData={triggerCode:$("#triggerCode").val()}}))},window.sendCommandMultiSelectFormOpen=function(e){const t=$('<div class="form-group form-horizontal row mt-4"><label class="col-sm-2 control-label" for="commandId" accesskey="">'+translations.sendCommandLabel+'</label><div class="col-sm-10"><select name="commandId" class="form-control" data-search-url="'+commandSearchUrl+'" data-search-term="command" data-id-property="commandId" data-text-property="command"><span class="help-block">'+translations.sendCommandHelpText+"</span></div></div>");$(e).find(".modal-body").append(t),makePagedSelect(e.find('select[name="commandId"]'),e),e.find('select[name="commandId"]').on("select2:select",(function(t){e.data().commitData={commandId:$(t.currentTarget).select2("data")[0].id}}))}},38537:function(){$.fn.dataTable.ext.errMode=function(e,t,a){console.error(a)},$((function(){XiboInitDatatables("")})),window.XiboInitDatatables=function(e,t){null!=e&&""!=e||(e=" "),$(e+" .XiboGrid").each((function(e,t){const a=$(t),n=a.data().gridName,o=a.find(".XiboFilter form");if(null!=n){let e;try{e=JSON.parse(localStorage.getItem(n)),null==e&&(localStorage.setItem(n,JSON.stringify(o.serializeArray())),e=JSON.parse(localStorage.getItem(n)))}catch(t){console.warn(t),e=[]}const t=[];e.forEach((e=>{e.name in t?t[e.name].value=[e.value,t[e.name].value]:t[e.name]=e}));const a=new URL(window.location.href),i=new URLSearchParams(a.search.slice(1));$.each(Object.values(t),(function(e,t){const a=t.name.replace(/\[\]/,"\\\\[\\\\]");try{const e=o.find('input[name="'+a+'"], select[name="'+a+'"], select[name="'+t.name+'"]');null!==i.get(a)?e.val(i.get(a)):e.length>0&&e.val(t.value),e.parent().hasClass("pagedSelect")&&e.data("initial-value",t.value)}catch(e){console.warn(e),console.error("Error populating form saved value with selector input[name="+t.name+"], select[name="+t.name+"]")}}))}const i=_.debounce((function(){null!=n&&localStorage.setItem(n,JSON.stringify(o.serializeArray())),a.closest(".XiboGrid").find("table.dataTable").first().DataTable().ajax.reload()}),500),r=templates["xibo-filter-clear-button"]({trans:translations});a.find(".XiboFilter .nav-tabs").length>0?0===a.find(".XiboFilter .nav-tabs .clear-filter-btn-container").length&&o.length>0&&a.find(".XiboFilter .nav-tabs").append(r):0===a.find(".XiboFilter .clear-filter-btn-container").length&&o.length>0&&(a.find(".XiboFilter").prepend(r),a.find(".XiboFilter .FilterDiv").addClass("pt-0")),a.find(".XiboFilter .clear-filter-btn").off().on("click",(function(){o[0].reset(),o.find("select:not(.select2-hidden-accessible)").prop("selectedIndex",0).trigger("change"),o.find(".dateControl").val("").trigger("change"),o.find(".select2-hidden-accessible").val("").trigger("change"),o.find(".bootstrap-tagsinput").tagsinput("clear"),i.call(t)})),a.find(".XiboFilter form").on("keydown",(function(e){if(13==e.keyCode)return e.preventDefault(),!1})),a.find(".XiboFilter form input").on("keyup",i),a.find('.XiboFilter form input[type="number"]').on("change",i),a.find('.XiboFilter form input[type="checkbox"]').on("change",i),a.find(".XiboFilter form select").on("change",i),a.find(".XiboFilter form input.dateControl").on("change",i),a.find(".XiboFilter form #folderId").on("change",i),a.find('.XiboFilter form input[data-role="tagsInputInline"]').on("change",i),a.on("click",'#dropdown-menu-right-container a.dropdown-item[data-custom-handler="createMiniLayoutPreview"]',(function(e){const t=$(e.currentTarget).attr("data-custom-handler-url");$(e.currentTarget).on("click",createMiniLayoutPreview(t))}));const l=rememberFolderTreeStateGlobally?"grid-folder-tree-state":"grid_"+n;initJsTreeAjax(a.find("#container-folder-tree"),l,!1)}))},window.dataTableProcessing=function(e,t,a){a?0===$(e.target).closest(".widget").closest(".widget").find(".saving").length&&$(e.target).closest(".widget").children(".widget-title").append('<span class="saving fa fa-cog fa-spin p-1"></span>'):$(e.target).closest(".widget").closest(".widget").find(".saving").remove()},window.dataTableDraw=function(e,t,a){const n=$("#"+e.target.id),o=n.find("div.dropdown-menu a.multi-select-button"),i=n.closest(".XiboGrid").find(".FilterDiv #tags"),r=n.closest(".XiboGrid").find(".folder-controller");if(o.length>0){const t=function(e,t,a){for(const n in e)if(e[n][t]==a)return!0;return!1};n.find("tbody").off("click","tr").on("click","tr",(function(e){$(e.currentTarget).toggleClass("selected"),n.data().initialised=!0}));let a=[];$(o).each((function(n,o){const i=$(o);t(a,"id",i.data("id"))||a.push({id:i.data("id"),gridId:e.target.id,text:i.data("text"),customHandler:i.data("customHandler"),customHandlerUrl:i.data("customHandlerUrl"),contentIdName:i.data("contentIdName"),sortGroup:null!=i.data("sortGroup")?i.data("sortGroup"):0})})),i.length>0&&1==userRoutePermissions.tags&&a.push({id:i.attr("id"),gridId:e.target.id,text:translations.editTags,contentType:n.data("contentType"),contentIdName:n.data("contentIdName"),customHandler:"XiboMultiSelectTagFormRender",sortGroup:0}),a=a.sort((function(e,t){return e.sortGroup>t.sortGroup?1:-1}));let r=0;if(a.length>1)for(let e=0;e<a.length;e++){const t=a[e];t.sortGroup>r&&e>0&&(a.splice(e,0,{divider:!0}),r=t.sortGroup)}const l=templates.dataTable.multiSelectButton({selectAll:translations.selectAll,withSelected:translations.withselected,buttons:a});n.closest(".dataTables_wrapper").find(".dataTables_info").prepend(l),n.closest(".dataTables_wrapper").find(".dataTables_info a.XiboMultiSelectFormButton").on("click",(function(e){const t=$(e.currentTarget);null!=t.data("customHandler")&&"function"==typeof window[t.data("customHandler")]?window[t.data("customHandler")](e.currentTarget):XiboMultiSelectFormRender(e.currentTarget)})),n.closest(".dataTables_wrapper").find(".dataTables_info a.XiboMultiSelectFormCustomButton").on("click",(function(e){window[$(e.currentTarget).data("customHandler")](e.currentTarget)})),n.closest(".dataTables_wrapper").find(".dataTables_info button.select-all").on("click",(function(){const e=n.find("tbody tr");n.find("tbody tr.selected").length>e.length/2?e.removeClass("selected"):e.addClass("selected")}))}r.length>0&&0==n.closest(".dataTables_wrapper").find(".dataTables_folder .folder-controller").length&&(r.appendTo(".dataTables_folder"),r.removeClass("d-none").addClass("d-inline-flex")),"function"==typeof a&&a(),XiboInitialise("#"+e.target.id)},window.dataTableButtonsColumn=function(e,t,a,n){return"display"!=t||e.buttons.length<=0?"":templates.dataTable.buttons({translations:translations,buttons:e.buttons})},window.dataTableTickCrossColumn=function(e,t,a){if("display"!=t)return e;let n="";return n=1==e?"fa-check":0==e?"fa-times":"fa-exclamation","<span class='fa "+n+"'></span>"},window.dataTableTickCrossInverseColumn=function(e,t,a){if("display"!=t)return e;let n="";return n=1==e?"fa-times":0==e?"fa-check":"fa-exclamation","<span class='fa "+n+"'></span>"},window.dataTableDateFromIso=function(e,t,a){return"display"!==t&&"export"!==t?e:null==e?"":moment(e,systemDateFormat).format(jsDateFormat)},window.dataTableRoundDecimal=function(e,t,a){return"display"!==t&&"export"!==t?e:null==e?"":parseFloat(e).toFixed(2)},window.dataTableDateFromUnix=function(e,t,a){return"display"!==t&&"export"!==t?e:null==e||0==e?"":moment(e,"X").tz?moment(e,"X").tz(timezone).format(jsDateFormat):moment(e,"X").format(jsDateFormat)},window.dataTableTimeFromSeconds=function(e,t,a){if("display"!==t&&"export"!==t)return e;if(null==e||0==e)return"";const n=moment.duration(1e3*e),o=Math.floor(n.asHours());return(o<10?"0"+o:o)+moment.utc(n.asMilliseconds()).format(":mm:ss")},window.dataTableSpacingPreformatted=function(e,t,a){return"display"!==t?e:null===e||""===e?"":'<span class="spacing-whitespace-pre">'+e+"</span>"},window.dataTableCreateTags=function(e,t){if("display"!==t)return e.tags;let a="";return void 0!==typeof e.tags&&null!=e.tags&&(a+='<div id="tagDiv">',e.tags.forEach((e=>a+='<li class="btn btn-sm btn-white btn-tag">'+e.tag+(e.value?"|"+e.value:"")+"</li>")),a+="</div>"),a},window.dataTableCreatePermissions=function(e,t){if("display"!==t)return e;let a="";if(null!=typeof e&&null!=e){const t=e.split(",");a+='<div class="permissionsDiv">';for(let e=0;e<t.length;e++)""!=t[e]&&(a+='<li class="badge">'+t[e]+"</span></li>");a+="</div>"}return a},window.dataTableCreateTagEvents=function(e,t){const a=$("#"+e.target.id),n=e.target.id,o=e.data.form;a.off("click"),a.on("click",".btn-tag",(function(e){const t=$(e.currentTarget).text();"playlistLibraryMedia"==n?o.find("#filterMediaTag").tagsinput("add",t,{allowDuplicates:!1}):"displayGroupDisplays"==n?o.find("#dynamicCriteriaTags").tagsinput("add",t,{allowDuplicates:!1}):o.find("#tags").tagsinput("add",t,{allowDuplicates:!1}),a.DataTable().ajax.reload()}))},window.dataTableAddButtons=function(e,t,a,n){a=void 0===a||a;const o=[{extend:"colvis",columns:":not(.rowMenu)",text:function(e,t,a){return e.i18n("buttons.colvis")}}];(n=void 0!==n&&n)&&o.push({text:translations.defaultSorting,action:function(t,a,n,o){e.order([]).draw()}}),a&&o.push({extend:"print",text:function(e,t,a){return e.i18n("buttons.print")},exportOptions:{orthogonal:"export",format:{body:function(e,t,a,n){return null===e||""===e||"null"===e?"":e}}},customize:function(e){const t=$(e.document.body).find("table");t.removeClass("nowrap responsive dataTable no-footer dtr-inline"),t.find("th").length>16&&(t.addClass("table-sm"),t.css("font-size","6px"))}},{extend:"csv",exportOptions:{orthogonal:"export",format:{body:function(e,t,a,n){return null===e||""===e?"":e}}}}),new $.fn.dataTable.Buttons(e,{buttons:o}),e.buttons(0,null).container().prependTo(t),$(t).addClass("text-right"),$(".ColVis_MasterButton").addClass("btn"),$(t).find(".dt-buttons button.btn-secondary").addClass("btn-outline-primary").removeClass("btn-secondary")},window.dataTableStateLoadCallback=function(e,t){const a=$("#"+e.sTableId).data().statePreferenceName,n=void 0!==a?a:e.sTableId+"Grid";let o={};return $.ajax({type:"GET",async:!1,url:userPreferencesUrl+"?preference="+n,dataType:"json",success:function(e){try{e.success&&(o=JSON.parse(e.data.value))}catch(e){console.warn(e)}}}),o},window.dataTableStateSaveCallback=function(e,t){const a=$("#"+e.sTableId).data().statePreferenceName,n=void 0!==a?a:e.sTableId+"Grid";updateUserPref([{option:n,value:JSON.stringify(t)}],(function(){}))},window.XiboMultiSelectPermissionsFormOpen=function(e){const t=$(e).parents(".XiboGrid").find(".dataTable"),a=t.find("tr.selected"),n=t.DataTable(),o=$(e).data("customHandlerUrl"),i=$(e).data("contentIdName"),r=[];a.each((function(e,t){const a=n.row(t).data();r.push(a[i])})),0==a.length?bootbox.dialog({message:translations.multiselectNoItemsMessage,title:translations.multiselect,animate:!1,size:"large",buttons:{cancel:{label:translations.close,className:"btn-white btn-bb-cancel"}}}):XiboFormRender(o,{ids:r.toString()})},window.XiboMultiSelectTagFormRender=function(e){const t=$(e).data("contentType"),a=$(e).data("contentIdName"),n=[],o=$(e).parents(".XiboGrid").find(".dataTable"),i=o.DataTable();let r="";const l="multiselectTagEditForm",s=[],d=[];o.find("tr.selected").each((function(e,t){n.push($(t))})),0==n.length?r=translations.multiselectNoItemsMessage:(n.forEach((function(e){const t=i.row(e).data();s.push(t[a]),-1===["",null].indexOf(t.tags)&&t.tags.forEach((function(e){-1===d.indexOf(e)&&d.push(e.tag+(e.value?"|"+e.value:""))}))})),r=templates["multiselect-tag-edit-form"]({trans:translations.multiSelectTagEditForm,tagGetByNameUrl:tagGetByNameUrl,tagEditMultipleUrl:tagEditMultipleUrl}));const c=bootbox.dialog({message:r,title:translations.multiselect,size:"large",animate:!1}),u=c.find(".modal-body"),p=$("<div>").addClass("modal-footer");let f;if(c.find(".modal-content").append(p),c.attr("id",l),n.length>0){if(f=$('<button class="btn">').html(translations.save).addClass("btn-primary save-button"),f.on("click",(function(e){const a=u.find("#tagsToRemove").val().split(","),n=u.find("#requestURL").val(),o={targetIds:s.toString(),targetType:t,addTags:u.find("#tagsToAdd").val(),removeTags:function(){const e=[];return d.forEach((function(t){-1==a.indexOf(t)&&e.push(t)})),e}().toString()};return $(e.currentTarget).append('<span class="saving fa fa-cog fa-spin"></span>'),$.ajax({type:"PUT",url:n,cache:!1,dataType:"json",data:o,success:function(e,t,a){e.success?(toastr.success(e.message),c.modal("hide"),i.ajax.reload(null,!1)):(e.login?LoginBox(e.message):(p.find(".saving").remove(),SystemMessageInline(e.message,p.closest(".modal"))),$(this).find(".saving").remove())},error:function(e){SystemMessage(e,!1),$(this).find(".saving").remove()}}),!1})),p.append(f),d.length>0){const e=d.toString();u.find("#tagsToRemove").val(e)}else u.find("#tagsToRemoveContainer").hide();u.find("#requestURL").val(u.find("#requestURL").val().replace("[type]",t)),u.find("#tagsToRemove").on("beforeItemAdd",(function(e){e.cancel=-1==d.indexOf(e.item)}))}f=$('<button class="btn">').html(translations.close).addClass("btn-white"),f.on("click",(function(e){return $(e.currentTarget).append(' <span class="saving fa fa-cog fa-spin"></span>'),c.modal("hide"),$(".modal").hasClass("in")&&$("body").addClass("modal-open"),!1})),p.prepend(f),XiboInitialise("#"+l)},window.XiboRefreshAllGrids=function(){$(" .XiboGrid table.dataTable").each((function(e,t){const a=$(t).closest(".XiboGrid").data("refreshOnFormSubmit");if(null==a||a){const e=$(t).DataTable();e.init().serverSide&&e.ajax.reload(null,!1)}}))},window.adjustDatatableSize=function(e){function t(){"function"==typeof refreshDisplayMap&&refreshDisplayMap()}e=void 0===e||e,$("#grid-folder-filter").is(":hidden")&&t(),$("#grid-folder-filter").toggle("fast",(function(){$("#grid-folder-filter").is(":hidden")?($("#folder-tree-clear-selection-button").is(":checked")||$("#breadcrumbs").show("slow"),t()):$("#breadcrumbs").hide("slow"),e&&$("#grid-folder-filter").closest(".XiboGrid").find("table.dataTable").DataTable().ajax.reload(),localStorage.setItem("hideFolderTree",JSON.stringify($("#grid-folder-filter").is(":hidden")))}))},window.initJsTreeAjax=function(e,t,a,n){let o,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[],d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;if(a=void 0!==a&&a,n=void 0!==n&&n,0===$("#folder-tree-form-modal").length&&$("#"+t+" #folderId").length&&$("#select-folder-button").length){const e=templates["folder-tree"],t={container:"container-folder-form-tree",modal:"folder-tree-form-modal",trans:translations.folderTree};$("body").append(e({...t,trans:translations.folderTree})),$("#folder-tree-form-modal").on("hidden.bs.modal",(function(e){$(".modal:visible").length&&$(document.body).addClass("modal-open"),$(e.currentTarget).data("bs.modal",null)}))}let c={};if($(e).length){c=a?{key:t+"_folder_tree",ttl:n}:{key:t+"_folder_tree"},$(e).jstree({state:c,plugins:["contextmenu","state","unique","sort","types","search"].concat(s),contextmenu:{items:function(t,n){let o={};const i=$(e).jstree(!0);let r=null;$.ajax({url:foldersUrl+"/contextButtons/"+t.id,method:"GET",dataType:"json",success:function(n){r=n,r.create&&(o.Create={separator_before:!1,separator_after:!1,label:translations.folderTreeCreate,action:function(e){t=i.create_node(t),i.edit(t)}}),r.modify&&(o.Rename={separator_before:!1,separator_after:!1,label:translations.folderTreeEdit,action:function(e){i.edit(t)}}),r.delete&&(o.Remove={separator_before:!0,separator_after:!1,label:translations.folderTreeDelete,action:function(e){i.delete_node(t)}}),!1===a&&r.share&&(o.Share={separator_before:!0,separator_after:!1,label:translations.folderTreeShare,_class:"XiboFormRender",action:function(a){const n=$(e).jstree("get_selected",!0).map((e=>Number(e.id)));n.length>1?XiboFormRender(permissionsUrl.replace(":entity","multiple/form/Folder"),{ids:n.toString()}):XiboFormRender(permissionsUrl.replace(":entity","form/Folder/")+t.id)}}),!1===a&&r.move&&(o.Move={separator_before:!0,separator_after:!1,label:translations.folderTreeMove,_class:"XiboFormRender",action:function(e){XiboFormRender(foldersUrl+"/form/"+t.id+"/move")}}),null!==l&&l instanceof Function&&(o=l(t,o))},complete:function(e){n(o)}})}},types:{root:{icon:"fa fa-file text-xibo-primary"},home:{icon:"fa fa-home text-xibo-primary"},default:{icon:"fa fa-folder text-xibo-primary"},open:{icon:"fa fa-folder-open text-xibo-primary"}},search:{show_only_matches:!0},core:{check_callback:function(e,t,a,n,o){return"delete_node"!==e&&"rename_node"!==e||"#"!==t.id&&"1"!==t.id||(toastr.error(translations.folderTreeError),!1)},data:{url:foldersUrl+(d?"?homeFolderId="+d:"")},themes:{responsive:!0,dots:!1}}}).bind("ready.jstree",(function(n,r){if(void 0!==localStorage.getItem("hideFolderTree")&&null!==localStorage.getItem("hideFolderTree")&&JSON.parse(localStorage.getItem("hideFolderTree"))!==$("#grid-folder-filter").is(":hidden")&&adjustDatatableSize(!1),$.each(r.instance._model.data,(function(n,i){if("disabled"===i?.original?.type){const t=$(e).jstree().get_node(i.id);0===i.children.length?$(e).jstree().hide_node(t):$(e).jstree().disable_node(t)}if(1===i?.original?.isRoot&&$(e).find("a#"+i.id+"_anchor").attr("title",translations.folderRootTitle),void 0!==i.type&&"home"===i.type){o=i.id;null!=localStorage.getItem(t+"_folder_tree")||a||$(e).jstree(!0).select_node(o)}})),a){let e="#"+t+" #folderId";0===$(e).length&&(e="#formFolderId");const a=$(e).val()?$(e).val():o;if(void 0!==a&&""!==a){const t=this;$(t).jstree("select_node",a),$("#originalFormFolder").length&&$("#originalFormFolder").text($(t).jstree().get_path($(t).jstree("get_selected",!0)[0]," > ")),$("#selectedFormFolder").length&&"#formFolderId"===e&&$("#selectedFormFolder").text($(t).jstree().get_path($(t).jstree("get_selected",!0)[0]," > "))}}i&&i instanceof Function&&i($(e).jstree(!0),$(e))})).bind("rename_node.jstree",(function(t,a){const n={},o=a.node.id;n.text=a.text,$.ajax({url:foldersUrl+"/"+o,method:"PUT",dataType:"json",data:n,success:function(t){"#container-folder-form-tree"===e&&$("#container-folder-tree").jstree(!0).refresh()}})})).bind("create_node.jstree",(function(t,a){const n=a.node;n.text=translations.folderNew;const o={};o.parentId=a.parent,o.text=a.node.text,$.ajax({url:foldersUrl,method:"POST",dataType:"json",data:o,success:function(t){$(e).jstree(!0).set_id(n,t.data.id),"#container-folder-form-tree"===e&&$("#container-folder-tree").jstree(!0).refresh()}})})).bind("delete_node.jstree",(function(t,a){const n={};n.parentId=a.parent,n.text=a.node.text;const o=a.node.id;$.ajax({url:foldersUrl+"/"+o,method:"DELETE",dataType:"json",data:n,success:function(t){t.success?(toastr.success(translations.done),"#container-folder-form-tree"===e&&$("#container-folder-tree").jstree(!0).refresh()):(void 0!==t.message?toastr.error(t.message):toastr.error(translations.folderWithContent),$(e).jstree(!0).refresh())}})})).bind("changed.jstree",(function(n,o){const i=o.selected[0];let l=a?"#"+t+" #folderId":"#folderId";const s=$(e).jstree("get_selected",!0);a&&0===$(l).length&&(l="#formFolderId"),void 0!==i&&!1===a&&($("#breadcrumbs").text($(e).jstree().get_path(s[0]," > ")).hide(),$("#folder-tree-clear-selection-button").prop("checked",!1)),$(l).val()!=i&&!1===a&&(void 0!==i?$(l).val(i).trigger("change"):($("#breadcrumbs").text(""),$("#folder-tree-clear-selection-button").prop("checked",!0),$(".XiboFilter").find("#folderId").val(null).trigger("change"))),a&&void 0!==i&&($(l).val(i).trigger("change"),$("#selectedFormFolder").length&&$("#selectedFormFolder").text($(e).jstree().get_path(s[0]," > "))),r&&r instanceof Function&&r(o)})).bind("open_node.jstree",(function(e,t){"root"!==t.node.type&&"home"!==t.node.type&&t.instance.set_type(t.node,"open")})).bind("close_node.jstree",(function(e,t){"root"!==t.node.type&&"home"!==t.node.type&&t.instance.set_type(t.node,"default")})).bind("search.jstree",(function(t,a,n){0===a.nodes.length?($(e).jstree(!0).hide_all(),$(e).parent().find(".folder-search-no-results").removeClass("d-none")):$(e).parent().find(".folder-search-no-results").addClass("d-none")})),$(".btnCloseInnerModal").on("click",(function(e){e.preventDefault(),$(a?"#folder-tree-form-modal":"#folder-tree-modal").modal("hide")})),$("#folder-tree-clear-selection-button").on("click",(function(){$("#folder-tree-clear-selection-button").is(":checked")?($(e).jstree("deselect_all"),$(".XiboFilter").find("#folderId").val(null).trigger("change")):$(e).jstree("select_node",o??1)})),$("#folder-tree-select-folder-button").off("click").on("click",adjustDatatableSize);const u=_.debounce((function(){$(e).jstree(!0).show_all(),$(e).parent().find(".folder-search-no-results").addClass("d-none"),$(e).jstree(!0).search($(this).val())}),500);$("#jstree-search").on("keyup",u),$("#jstree-search-form").on("keyup",u)}$("#grid-folder-filter").resizable({handles:"e",minWidth:200,maxWidth:500})},window.disableFolders=function(){$("#folder-tree-select-folder-button").parent().remove(),$("#container-folder-tree").remove(),$("#grid-folder-filter").remove()}},15234:function(t){t.exports={displayTooltips:!0,deleteConfirmation:!0,showLoadingScreen:function(){let e=$(".loading-overlay.loading").data("bump")||0;e++,e<=1&&$(".loading-overlay").addClass("loading").fadeIn(400),$(".loading-overlay").data("bump",e++)},hideLoadingScreen:function(){let e=$(".loading-overlay.loading").data("bump")||1;e--,e<=0&&$(".loading-overlay.loading").fadeOut(400,(function(e){$(e).removeClass("loading")})),$(".loading-overlay").data("bump",e)},reloadTooltips:function(e){let{forcedOption:t=null,placement:a="auto"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=(null!=t?t:this.displayTooltips)?'[data-toggle="tooltip"]:not(:disabled)':'[data-toggle="tooltip"].tooltip-always-on:not(:disabled)';$(e).find('[data-toggle="tooltip"]').tooltip("dispose"),$(e).find(n).tooltip({boundary:"window",trigger:"hover",placement:a}),this.clearTooltips()},clearTooltips:function(){$("body").find(".tooltip, .popover:not(.tour)").remove()},timeFormat:function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const a=Math.floor(e/3600),n=Math.floor(e%3600/60),o=Math.floor(e%3600%60),i=function(e){return e<10&&(e="0"+e),e},r=a>0?i(a)+":":"",l=n>0||""!=r||t?i(n)+":":"";return r+l+(""!=l?i(o):o)},formatFileSize:function(t){return(b=Math,c=b.log,d=1e3,e=c(t)/c(d)|0,t/b.pow(d,e)).toFixed(2)+" "+(e?"kMGTPEZY"[--e]+"B":"Bytes")},getModuleByType:function(e){return modulesList.find((t=>t.type===e))},hasTarget:function(e,t){let a=$(e).data("target");return null!=a&&(Array.isArray(a)||(a=a.split(" ")),-1!==a.indexOf("all")||-1!==a.indexOf(t))},clearContainer:function(e){e.find(".flatpickr-input").each(((e,t)=>{t._flatpickr&&t._flatpickr.destroy()})),e.find("select[data-select2-id]").select2("destroy"),e.find(".colorpicker-element").colorpicker("destroy"),e.is(".ui-droppable")&&e.droppable("destroy"),e.find(".ui-droppable").droppable("destroy"),e.find(".ui-draggable").draggable("destroy"),e.find(".ui-sortable").sortable("destroy"),e.find(".masonry-container").masonry("destroy"),e.find(".rich-text").each(((e,t)=>{const a=$(t).attr("id");formHelpers.destroyCKEditor(a)}))},handleEditorMinimumDimensions:function(e,t){const a=function(){const a=$(window).width(),n=$(window).height(),o=e.showMinDimensionsMessage,i=e.toolbar.levelLimiter,r=localStorage.getItem("minSizeWarningOff");if($.isEmptyObject(e.editorContainer))$(window).off("resize."+e.mainObjectType);else if(e.showMinDimensionsMessage=a<1200||n<600,e.toolbar.levelLimiter=a<1600,o!=e.showMinDimensionsMessage||t)if(e.showMinDimensionsMessage&&!r){e.editorContainer.append(`<div class="min-res-message">\n            <div>\n              <h4>${editorsTrans.minDimensionsMessageHeader}</h4>\n              <div>${editorsTrans.minDimensionsMessageBody}</div>\n              <button class="close-res-message-button btn btn-outline-primary">\n                  ${editorsTrans.minDimensionsMessageHide}\n              </button>\n            </div>\n          </div>`);const t=$(".custom-overlay").clone();t.removeClass("custom-overlay").addClass("custom-overlay-clone min-res-overlay"),t.appendTo(e.editorContainer),e.editorContainer.find(".min-res-message .close-res-message-button").on("click",(function(){e.minSizeWarningOff=!0,localStorage.setItem("minSizeWarningOff",!0),e.common.handleEditorMinimumDimensions(e,!0),e.viewer&&e.viewer.render()}))}else e.editorContainer.find(".min-res-message").remove(),e.editorContainer.find(".min-res-overlay").remove();else i!=e.toolbar.levelLimiter&&e.toolbar.render()};$(window).on("resize."+e.mainObjectType,_.debounce(a,60)),a()}}},95061:function(e){e.exports=new function(){const e=this;return this.getPinnedSlots=function(e){return Object.keys(e).reduce((function(t,a){const n=e[a];return n.hasPinnedSlot?[...t,n.slot]:t}),[])},this.getPinnedItems=function(e){return 0===Object.values(e).length?e:Object.keys(e).reduce((function(t,a){const n=e[a];return n.pinSlot&&(t[a]=n),t}),{})},this.getItemsByKey=(e,t,a)=>a&&e.hasOwnProperty(t)&&Object.keys(e[t]).length>0?Object.keys(e[t]).reduce((function(a,n){return[...a,e[t][n]]}),[]):e.hasOwnProperty(t)?e[t]:[],this.getMinAndMaxSlot=function(e){const t=e=>e.map((function(e){return e?.slot+1||0}));return{minSlot:null===e?1:Math.min(...t(e)),maxSlot:null===e?1:Math.max(...t(e))}},this.getMaxMinSlot=(t,a,n)=>{const o=t?.length>0?t.reduce(((t,o)=>[...t,...e.getItemsByKey(o,a,n)]),[]):null,i=e=>e.map((function(e){return e?.slot||0}));return{minSlot:null===o?1:Math.min(...i(o))+1,maxSlot:null===o?1:Math.max(...i(o))+1}},this.isGroup=function(e){return e.hasOwnProperty("groupId")},this.isMarquee=function(e){return"marqueeLeft"===e||"marqueeRight"===e||"marqueeUp"===e||"marqueeDown"===e},this.renderElement=function(e,t,a){const n=e(Object.assign(t,globalOptions));let o=t.top,i=t.left;const r=Boolean(t.groupId),l=Boolean(t.groupProperties);t.group&&(t.group.isMarquee?(o=t.top-t.group.top,i=t.left-t.group.left):(t.top>=t.group.top&&(o=t.top-t.group.top),t.left>=t.group.left&&(i=t.left-t.group.left)));let s={height:t.height,width:t.width,position:"absolute",top:o,left:i,zIndex:t.layer,transform:`rotate(${t?.rotation||0}deg)`};a&&(s={...s,top:t.top,left:t.left,zIndex:t.layer},r&&l&&(s.top=t.top>=t.groupProperties.top?t.top-t.groupProperties.top:0,s.left=t.left>=t.groupProperties.left?t.left-t.groupProperties.left:0,s.zIndex="none")),t.isGroup||"text"!==t.dataOverride||!t.group||!t.group.isMarquee||"marqueeLeft"!==t.effect&&"marqueeRight"!==t.effect||(s={...s,position:"static",top:"unset",left:"unset",width:t?.textWrap?t.width:"initial",display:"flex",flexShrink:"0",wordWrap:"break-word"});const d=$(n).first().attr("id",t.elementId).addClass(`${t.uniqueID}--item`).css(s);return t.isGroup||"text"!==t.dataOverride||!t.group||!t.group.isMarquee||"marqueeLeft"!==t.effect&&"marqueeRight"!==t.effect||(d.get(0).style.removeProperty("white-space"),d.get(0).style.setProperty("white-space",t?.textWrap?"unset":"nowrap","important")),d.prop("outerHTML")},this.renderDataItem=function(t,a,n,o,i,r,l,s,d,c,u,p,f){const m=$(`<div class="${d}--item"\n      data-group-key="${a}"></div>`),g="."+d+"--item[data-group-key=%key%]";if(o.hasOwnProperty("hbs")&&"function"==typeof o.hbs&&"empty"!==a){let i={width:u.width,height:u.height};u&&u.isMarquee&&(i={...i,position:"relative",display:"flex",flexShrink:"0"}),m.css(i),c&&0===c.find(g.replace("%key%",a)).length&&c.append(m);let r=!1;!t&&"text"===o.dataOverride&&u.isMarquee&&("marqueeLeft"===o.effect||"marqueeRight"===o.effect?(1===c.find(g.replace("%key%",a)).length&&c.find(g.replace("%key%",a)).remove(),r=!0):"marqueeDown"!==o.effect&&"marqueeUp"!==o.effect||(r=!1));const l=r?c:c.find(g.replace("%key%",a)),s=Object.assign(o.templateData,{isGroup:t},String(o.dataOverride).length>0&&String(o.dataOverrideWith).length>0?n:{data:n},{group:u});if(s.isExtended)if("dataset"===s.type&&s.hasOwnProperty("datasetField")&&n.hasOwnProperty(s.datasetField))s[s.dataOverride]=n[s.datasetField];else{const e=transformer.getExtendedDataKey(s.dataOverrideWith);s.dataOverride===e&&n.hasOwnProperty(e)&&(s[s.dataOverride]=n[e])}const d=$(e.renderElement(o.hbs,s)),f=$("<div>");f.append(d).attr("data-style-scope","element_"+s.type+"__"+s.id),l.append(f);const h=o.uniqueID||o.templateData?.uniqueID;void 0!==o.onTemplateRender()&&o.onTemplateRender()(o.elementId,l.find(`.${h}--item`).parent(),n,{item:o,...o.templateData,data:n},p)}else c&&0===c.find(g.replace("%key%",a)).length&&c.append(m),c.find(g.replace("%key%",a)).append("")},this}},47731:function(e,t,a){"use strict";var n=a(31601),o=a.n(n),i=a(76314),r=a.n(i)()(o());r.push([e.id,"/*!\n * Copyright (C) 2023 Xibo Signage Ltd\n *\n * Xibo - Digital Signage - https://xibosignage.com\n *\n * This file is part of Xibo.\n *\n * Xibo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * any later version.\n *\n * Xibo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\n */.input-info-container{float:right;padding-top:6px}.input-info-container .input-info{float:right;margin-left:4px;color:#74acfa}.input-info-container .input-info.checkbox-popup{padding-top:3px}.text-area-buttons{display:flex;justify-content:flex-end;background-color:#e8f1fe;border-radius:.25rem .25rem 0 0}.code-input-editor-container{border:2px solid #ccc;border-radius:.25rem;position:relative;overflow-y:auto}.code-input-editor-container.non-scroll{overflow-y:unset}.code-input-editor-container .code-input-editor-scrollable{overflow-y:auto;min-height:160px;max-height:300px}.code-input-editor-container .code-input-fs-btn{display:none;position:absolute;right:6px;top:6px}.code-input-editor-container .code-input-fs-btn .hide-on-code-fs{display:block}.code-input-editor-container .code-input-fs-btn .show-on-code-fs{display:none}.code-input-editor-container .code-input-editor{width:100%;height:100%}.code-input-editor-container .code-input-editor .cm-focused{outline:none !important}.code-input-editor-container .cm-gutters{display:none}.code-input-editor-container:hover .code-input-fs-btn{display:block;opacity:.4}.code-input-editor-container:hover .code-input-fs-btn:hover{opacity:.8}.code-input-editor-container.code-input-fs{position:fixed;width:60vw;height:60vh;left:20vw;top:20vh;z-index:2040;background-color:#fff}.code-input-editor-container.code-input-fs .code-input-editor-scrollable{max-height:100%}.code-input-editor-container.code-input-fs .code-input-fs-btn{display:block}.code-input-editor-container.code-input-fs .hide-on-code-fs{display:none}.code-input-editor-container.code-input-fs .show-on-code-fs{display:block}.code-fs-placeholder{border:2px solid #ccc;border-radius:.25rem;background-color:#e9e9e9;min-height:160px;max-height:400px}.code-fs-overlay{z-index:2030 !important}.date-input-group .input-group>.form-control:not([type=hidden]){border-top-left-radius:.25rem;border-bottom-left-radius:.25rem}.date-input-group .input-group>.form-control:not(:disabled){background-color:#fff;cursor:pointer}.header{font-weight:bold;font-size:1.1rem;color:#1775f6;margin-left:-4px}.header.main{color:#0e4694;font-size:1.3rem}.rich-text-temp-container{background-color:#000}#richTextDetachedOverlay{z-index:1049 !important}.ck-body-wrapper .ck-balloon-panel{z-index:1051 !important}.ck-editor-body-detached .ck-body-wrapper .ck-balloon-panel[data-main-toolbar]{z-index:1052 !important;right:150px !important;left:auto !important;top:auto !important;bottom:calc(100vh - 100px) !important;width:calc(100vw - 300px) !important;display:block}.ck-editor-body-detached .ck-body-wrapper .ck-balloon-panel[data-main-toolbar]::before,.ck-editor-body-detached .ck-body-wrapper .ck-balloon-panel[data-main-toolbar]:after{display:none}.ck-editor-body-detached .ck-body-wrapper .ck-balloon-panel:not(.ck-powered-by-balloon):not([data-main-toolbar]){top:148px !important;left:160px !important;opacity:.95}.ck-editor-body-detached .ck-body-wrapper .ck-balloon-panel.ck-powered-by-balloon{top:auto !important;left:auto !important;bottom:16px !important;right:16px !important;display:block}.rich-text-main-container{width:100%;transform-origin:top right;box-shadow:none !important;overflow:hidden;border-radius:0 0 .25rem .25rem}.rich-text-main-container textarea{display:none}.rich-text-main-container .rich-text-container-wrapper{font-size:initial;max-height:202px;overflow:auto}.rich-text-main-container .rich-text-container-wrapper.loading>*{display:none}.rich-text-main-container .rich-text-container,.rich-text-main-container .rich-text-editor{overflow:visible}.rich-text-main-container .text-area-buttons{width:100%;position:sticky;left:0;top:0;z-index:1}.rich-text-main-container .text-area-buttons button:focus{box-shadow:none !important}.rich-text-main-container .ck-editor__editable_inline{outline-color:#eb7857;outline-style:solid;border-radius:0 !important}.rich-text-main-container.source .rich-text-container-wrapper{background-color:#fff !important;overflow:initial}.rich-text-main-container.source .rich-text-container-wrapper .rich-text-container{height:100% !important}.rich-text-main-container.source .ck-editor__editable_inline{display:none}.rich-text-main-container.source textarea{display:initial !important;opacity:initial !important;height:100% !important;min-height:160px}.rich-text-main-container.source .rich-text-editor{display:none}.rich-text-main-container.source .viewSourceButton{outline:2px solid #898989;outline-offset:-5px;border-radius:8px}.rich-text-main-container.source .zoomButton{display:none}.rich-text-main-container.detached{z-index:1050;position:fixed;top:100px;right:150px;outline-width:1px;width:calc(100vw - 300px) !important;height:calc(100vh - 200px) !important;overflow:hidden}.rich-text-main-container.detached .rich-text-container-wrapper{height:calc(100% - 28.5px) !important;max-height:none}.rich-text-main-container.detached .rich-text-container{height:100%}.rich-text-main-container.detached .rich-text-dimensions-control{background:#fcfcfc;color:#333}.rich-text-main-container.detached .rich-text-dimensions-control .control-label{display:inline-block}.rich-text-main-container.detached .text-area-buttons{border-radius:.25rem .25rem 0 0;padding:6px;background-color:#333;background-color:rgba(51,51,51,.9)}.rich-text-main-container.detached .text-area-buttons button{color:#fff}.rich-text-dimensions-control{padding:6px 8px;background:#0e4694;margin:0;display:flex;gap:8px;align-items:center;justify-content:flex-end}.rich-text-dimensions-control .control-label{display:none}.rich-text-dimensions-control .form-group{margin:0}.rich-text-dimensions-control .form-group input{height:25px;width:100%}.rich-text-dimensions-control .form-group input[type=checkbox]{margin:0 6px}.rich-text-dimensions-control select{padding:4px;height:28px}.dataset-column-selector,.ticker-tag-selector,.dataset-column-style-selector{display:flex;gap:6px}.dataset-column-selector .connectedlist,.ticker-tag-selector .connectedlist,.dataset-column-style-selector .connectedlist{flex:1;min-width:0}.dataset-column-selector .connectedlist .text-info,.ticker-tag-selector .connectedlist .text-info,.dataset-column-style-selector .connectedlist .text-info{color:#121a5e !important;font-weight:bold}.dataset-column-selector .connectedlist .ui-sortable,.ticker-tag-selector .connectedlist .ui-sortable,.dataset-column-style-selector .connectedlist .ui-sortable{width:100% !important;background-color:#74acfa !important}.dataset-column-selector .connectedlist .li-sortable,.ticker-tag-selector .connectedlist .li-sortable,.dataset-column-style-selector .connectedlist .li-sortable{width:calc(100% - 12px)}.ticker-tag-selector,.dataset-column-style-selector{flex-wrap:wrap}.ticker-tag-selector .ticker-tag-styles,.ticker-tag-selector .dataset-column-styles,.dataset-column-style-selector .ticker-tag-styles,.dataset-column-style-selector .dataset-column-styles{width:100%}.ticker-tag-selector .ticker-tag-styles .ticker-tag-style-title,.ticker-tag-selector .ticker-tag-styles .dataset-col-style-title,.ticker-tag-selector .dataset-column-styles .ticker-tag-style-title,.ticker-tag-selector .dataset-column-styles .dataset-col-style-title,.dataset-column-style-selector .ticker-tag-styles .ticker-tag-style-title,.dataset-column-style-selector .ticker-tag-styles .dataset-col-style-title,.dataset-column-style-selector .dataset-column-styles .ticker-tag-style-title,.dataset-column-style-selector .dataset-column-styles .dataset-col-style-title{writing-mode:vertical-lr;font-size:1.2rem;color:#121a5e}.ticker-tag-selector .ticker-tag-styles .ticker-tag-style,.ticker-tag-selector .ticker-tag-styles .dataset-col-style,.ticker-tag-selector .dataset-column-styles .ticker-tag-style,.ticker-tag-selector .dataset-column-styles .dataset-col-style,.dataset-column-style-selector .ticker-tag-styles .ticker-tag-style,.dataset-column-style-selector .ticker-tag-styles .dataset-col-style,.dataset-column-style-selector .dataset-column-styles .ticker-tag-style,.dataset-column-style-selector .dataset-column-styles .dataset-col-style{display:flex}.ticker-tag-selector .ticker-tag-styles .ticker-tag-style-properties,.ticker-tag-selector .ticker-tag-styles .dataset-col-style-properties,.ticker-tag-selector .dataset-column-styles .ticker-tag-style-properties,.ticker-tag-selector .dataset-column-styles .dataset-col-style-properties,.dataset-column-style-selector .ticker-tag-styles .ticker-tag-style-properties,.dataset-column-style-selector .ticker-tag-styles .dataset-col-style-properties,.dataset-column-style-selector .dataset-column-styles .ticker-tag-style-properties,.dataset-column-style-selector .dataset-column-styles .dataset-col-style-properties{border-left:6px solid #74acfa;padding-left:12px;margin-left:6px}.ticker-tag-selector .ticker-tag-styles .ticker-tag-style-properties .form-group,.ticker-tag-selector .ticker-tag-styles .dataset-col-style-properties .form-group,.ticker-tag-selector .dataset-column-styles .ticker-tag-style-properties .form-group,.ticker-tag-selector .dataset-column-styles .dataset-col-style-properties .form-group,.dataset-column-style-selector .ticker-tag-styles .ticker-tag-style-properties .form-group,.dataset-column-style-selector .ticker-tag-styles .dataset-col-style-properties .form-group,.dataset-column-style-selector .dataset-column-styles .ticker-tag-style-properties .form-group,.dataset-column-style-selector .dataset-column-styles .dataset-col-style-properties .form-group{margin-bottom:.5rem}.xibo-command-builder .command-type{display:block;width:100%}.xibo-command-builder .command-inputs{border-radius:0 0 6px 6px;padding:12px 6px;margin:0px 1px 4px 1px;background-color:#e8f1fe}.xibo-command-builder .command-inputs .col-12{max-width:100%}.xibo-command-builder .command-inputs .intent-name{width:100%;margin:6px 0}.xibo-command-builder .command-inputs .intent-type-container{font-size:0}.xibo-command-builder .command-inputs .intent-type-container .intent-type-label{width:30%;font-size:14px}.xibo-command-builder .command-inputs .intent-type-container .intent-type{width:70%}.xibo-command-builder .command-inputs .intent-extra-element{display:flex;gap:2px;margin-bottom:2px}.xibo-command-builder .command-inputs .intent-extra-element select{padding:0;width:30%}.xibo-command-builder .command-preview{border-radius:6px;padding:8px !important}.playlist-mixer .mixer-playlist-container{padding:.4rem .2rem 0 .2rem !important}.playlist-mixer .subplaylist-item-row>*,.playlist-mixer .subplaylist-items-header>*{margin-right:2px}.playlist-mixer .subplaylist-item-row .subplaylist-id-container-header,.playlist-mixer .subplaylist-items-header .subplaylist-id-container-header{margin-left:70px}.playlist-mixer .subplaylist-item-row .subplaylist-spots-container,.playlist-mixer .subplaylist-item-row .subplaylist-spots-length-container,.playlist-mixer .subplaylist-items-header .subplaylist-spots-container,.playlist-mixer .subplaylist-items-header .subplaylist-spots-length-container{width:100px}.playlist-mixer .subplaylist-item-row .subplaylist-spots-container input,.playlist-mixer .subplaylist-item-row .subplaylist-spots-length-container input,.playlist-mixer .subplaylist-items-header .subplaylist-spots-container input,.playlist-mixer .subplaylist-items-header .subplaylist-spots-length-container input{width:100%}.playlist-mixer .subplaylist-item-row .subplaylist-id-container,.playlist-mixer .subplaylist-items-header .subplaylist-id-container{width:100px}.playlist-mixer .subplaylist-item-row .subplaylist-id-container .select2-container,.playlist-mixer .subplaylist-items-header .subplaylist-id-container .select2-container{min-width:100% !important}.playlist-mixer .subplaylist-item-row .subplaylist-spots-fill-container,.playlist-mixer .subplaylist-items-header .subplaylist-spots-fill-container{width:120px}.playlist-mixer .subplaylist-item-row .subplaylist-spots-fill-container .select2-container,.playlist-mixer .subplaylist-items-header .subplaylist-spots-fill-container .select2-container{min-width:100% !important}.playlist-mixer .subplaylist-items-footer{position:sticky;left:0;bottom:0;padding:10px;width:100%;text-align:center !important}.canvas-widget-control{padding:8px;background-color:#1775f6}.canvas-widget-control .canvas-widget-control-dropdown{color:#e8f1fe;margin:0}.canvas-widget-control .canvas-widget-control-dropdown .input-info-container{display:inline-block;float:none;padding:0}.canvas-widget-control .canvas-widget-control-dropdown .canvas-widget-control-add{cursor:pointer;float:right;padding:0 6px;border-radius:4px}.canvas-widget-control .canvas-widget-control-dropdown .canvas-widget-control-add i{margin-right:4px}.canvas-widget-control .canvas-widget-control-dropdown .canvas-widget-control-add:hover{background-color:#085dd2}.widget-info-container{text-align:center;padding:6px;background-color:#74acfa;color:#f3f8ff;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.widget-info-container .widget-info-name{font-weight:bold}.snippet-selector{margin-top:-12px}.snippet-selector .select2-selection{background-color:#e8f1fe !important}.snippet-selector .select2-selection__placeholder{color:#121a5e !important;font-weight:bold}.panel-group{margin-left:-1rem;padding-left:1.2rem;border-left:6px solid #e8f1fe}.panel-group .panel-heading{background-color:#e8f1fe;padding:1rem;margin:.5rem -1.5rem .5rem -1.5rem;cursor:pointer}.panel-group .panel-heading .panel-title{font-size:1.1rem;font-weight:bold;color:#1775f6;margin:0}.panel-group .panel-heading .help-block{margin-top:.5rem}.panel-group .panel-heading i{font-size:1rem}.panel-group .panel-heading[aria-expanded=true] .fa-chevron-up{display:inline-block}.panel-group .panel-heading[aria-expanded=true] .fa-chevron-down{display:none}.panel-group .panel-heading[aria-expanded=false] .fa-chevron-up{display:none}.panel-group .panel-heading[aria-expanded=false] .fa-chevron-down{display:inline-block}.panel-group .panel-collapse{padding:1rem 0 .25rem 0}#errorMessage{margin-left:15px;box-sizing:border-box;width:calc(100% - 30px)}#errorMessage p{margin-bottom:0}select[readonly].select2-hidden-accessible+.select2-container{pointer-events:none;touch-action:none}select[readonly].select2-hidden-accessible+.select2-container .select2-selection{background:#eee;box-shadow:none}select[readonly].select2-hidden-accessible+.select2-container .select2-selection__arrow,select[readonly].select2-hidden-accessible+.select2-container .select2-selection__clear{display:none}.developer-template-controls-container{overflow:auto;max-height:calc(100vh - 400px)}.developer-template-controls-container .developer-template-controls{display:flex;gap:16px;margin-bottom:6px}.developer-template-controls-container .developer-template-controls .developer-template-placeholder{width:100%;height:calc(100vh - 410px);display:flex;justify-content:center;align-items:center;font-size:18px;color:#0e4694;background-color:#e8f1fe;border-radius:6px}.developer-template-controls-container .developer-template-controls .developer-template-control-item{background-color:#dcedff;padding:16px;border-radius:4px;display:flex;flex-direction:column;align-items:center;gap:12px;min-width:360px;max-width:360px}.developer-template-controls-container .developer-template-controls .developer-template-control-item .developer-template-control-form{display:flex;flex-direction:column;flex:1;gap:18px}.developer-template-controls-container .developer-template-controls .developer-template-control-item .developer-template-control-form .xibo-form-input{margin-bottom:.5rem}.developer-template-controls-container .developer-template-controls .developer-template-control-item .developer-template-control-form .xibo-form-input label,.developer-template-controls-container .developer-template-controls .developer-template-control-item .developer-template-control-form .xibo-form-input .input-info-container{float:left}.developer-template-controls-container .developer-template-controls .developer-template-control-item .developer-template-control-form .player-compat-items{display:grid;grid-template-columns:repeat(4, 1fr);gap:3px 6px;padding:6px;background-color:#b9d6fc;border-radius:6px}.developer-template-controls-container .developer-template-controls .developer-template-control-item .developer-template-control-form .option-item{display:inline-flex;align-items:center;gap:6px;background-color:#b9d6fc;padding:6px;border-radius:6px;margin-bottom:4px}.developer-template-controls-container .developer-template-controls .developer-template-control-item .developer-template-control-form .test-container .test-title,.developer-template-controls-container .developer-template-controls .developer-template-control-item .developer-template-control-form .test-container .condition-title{font-weight:bold}.developer-template-controls-container .developer-template-controls .developer-template-control-item .developer-template-control-form .test-container .test-item{background-color:#b9d6fc;border-radius:6px;padding:6px;margin-bottom:6px}.developer-template-controls-container .developer-template-controls .developer-template-control-item .developer-template-control-form .test-container .test-item-properties{display:flex;gap:6px}.developer-template-controls-container .developer-template-controls .developer-template-control-item .developer-template-control-form .test-container .condition-item{background-color:#d1e4fd;padding:6px;border-radius:8px;margin-bottom:6px}.developer-template-controls-container .developer-template-controls .developer-template-control-item .developer-template-control-form .test-container .test-conditions-container{margin:6px 0 6px 34px}.developer-template-controls-container .developer-template-controls .developer-template-control-item .developer-template-control-form .test-container .item-header{display:flex;justify-content:space-between;margin-bottom:6px}.developer-template-controls-container .developer-template-controls .developer-template-control-item .developer-template-control-item-controls{width:100%;display:flex;justify-content:space-between}.developer-template-controls-container .developer-template-controls .developer-template-control-item .developer-template-control-item-controls .item-move{cursor:col-resize;color:#74acfa}.developer-template-controls-container .developer-template-controls .developer-template-control-item .developer-template-control-item-controls .delete-btn{padding:0;color:#bf5555}.developer-template-controls-container .developer-template-controls .developer-template-control-item .developer-template-control-item-controls .item-move,.developer-template-controls-container .developer-template-controls .developer-template-control-item .developer-template-control-item-controls .delete-btn{font-size:24px}.image-replace-control .image-replace-control-area{height:80px;border-radius:4px;text-align:center;color:#000;background-color:#f3f8ff;padding:18px;border:2px solid #c0daff}.image-replace-control .image-replace-control-area.ui-droppable-active{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;position:relative;z-index:1011}.image-replace-control .image-replace-control-area.ui-droppable-active.ui-droppable-hover,.image-replace-control .image-replace-control-area.ui-droppable-active:hover{background-color:#fff}.color-gradient{background-color:#f3f8ff;padding:6px;border-left:8px solid #1775f6}.color-gradient .color-gradient-colours{display:flex;gap:6px}.color-gradient .color-gradient-colours .picker-container.colorpicker.colorpicker-with-alpha{min-width:150px}.fallback-data-content{margin-bottom:1rem}.fallback-data-content .fallback-data-record{padding:1rem;background-color:#fff;border:3px solid #74acfa;margin-bottom:.5rem;border-radius:.5rem;cursor:grab}.fallback-data-content .fallback-data-record .fallback-data-record-previews{margin-bottom:.6rem}.fallback-data-content .fallback-data-record .fb-btn-edit,.fallback-data-content .fallback-data-record .fallback-data-record-previews{display:block}.fallback-data-content .fallback-data-record .fallback-data-record-preview{display:flex;justify-content:space-between;margin-bottom:.2rem}.fallback-data-content .fallback-data-record .fallback-data-record-preview .fallback-data-record-preview-title{font-weight:bold}.fallback-data-content .fallback-data-record .fallback-data-record-preview .fallback-data-record-preview-title,.fallback-data-content .fallback-data-record .fallback-data-record-preview .fallback-data-record-preview-value{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fallback-data-content .fallback-data-record .fallback-data-record-preview.hidden{display:none}.fallback-data-content .fallback-data-record .fb-btn-save,.fallback-data-content .fallback-data-record .fallback-data-record-fields{display:none}.fallback-data-content .fallback-data-record.editing{border-color:#eb7857}.fallback-data-content .fallback-data-record.editing .fb-btn-edit,.fallback-data-content .fallback-data-record.editing .fallback-data-record-previews{display:none}.fallback-data-content .fallback-data-record.editing .fb-btn-save,.fallback-data-content .fallback-data-record.editing .fallback-data-record-fields{display:block}.fallback-data-content .fallback-data-record .fallback-property[data-is-required=true]{color:#bf5555;font-weight:bold}.fallback-data-content .fallback-data-record .fallback-data-record-buttons{display:flex;justify-content:space-between;gap:1rem}.fallback-data-content .fallback-data-record .fallback-data-record-buttons button{flex:1 1}.button-switch-input-group button{color:#1775f6;border-color:#1775f6}.button-switch-input-group button:not(.selected):hover{color:#1775f6;background-color:#c3dbfd}.button-switch-input-group button.selected{background-color:#1775f6;color:#fff}",""]),t.A=r},77096:function(e,t,a){"use strict";var n=a(31601),o=a.n(n),i=a(76314),r=a.n(i)()(o());r.push([e.id,"/*!\n * Copyright (C) 2023 Xibo Signage Ltd\n *\n * Xibo - Digital Signage - https://xibosignage.com\n *\n * This file is part of Xibo.\n *\n * Xibo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * any later version.\n *\n * Xibo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\n */.help-pane{position:fixed;bottom:0;right:10px;z-index:10000}.help-pane-card{width:18rem;display:none}.help-pane-card .close-icon{float:right;padding-top:3px;cursor:pointer}.help-pane-icon{text-align:right;padding:15px}.help-pane-icon i{font-size:48px;color:#1775f6;cursor:pointer}",""]),t.A=r},76314:function(e){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var a="",n=void 0!==t[5];return t[4]&&(a+="@supports (".concat(t[4],") {")),t[2]&&(a+="@media ".concat(t[2]," {")),n&&(a+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),a+=e(t),n&&(a+="}"),t[2]&&(a+="}"),t[4]&&(a+="}"),a})).join("")},t.i=function(e,a,n,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var r={};if(n)for(var l=0;l<this.length;l++){var s=this[l][0];null!=s&&(r[s]=!0)}for(var d=0;d<e.length;d++){var c=[].concat(e[d]);n&&r[c[0]]||(void 0!==i&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=i),a&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=a):c[2]=a),o&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=o):c[4]="".concat(o)),t.push(c))}},t}},31601:function(e){"use strict";e.exports=function(e){return e[1]}},17618:function(e,t,a){"use strict";a.r(t);var n=a(85072),o=a.n(n),i=a(97825),r=a.n(i),l=a(77659),s=a.n(l),d=a(55056),c=a.n(d),u=a(10540),p=a.n(u),f=a(41113),m=a.n(f),g=a(47731),h={};h.styleTagTransform=m(),h.setAttributes=c(),h.insert=s().bind(null,"head"),h.domAPI=r(),h.insertStyleElement=p(),o()(g.A,h),t.default=g.A&&g.A.locals?g.A.locals:void 0},58917:function(e,t,a){"use strict";a.r(t);var n=a(85072),o=a.n(n),i=a(97825),r=a.n(i),l=a(77659),s=a.n(l),d=a(55056),c=a.n(d),u=a(10540),p=a.n(u),f=a(41113),m=a.n(f),g=a(77096),h={};h.styleTagTransform=m(),h.setAttributes=c(),h.insert=s().bind(null,"head"),h.domAPI=r(),h.insertStyleElement=p(),o()(g.A,h),t.default=g.A&&g.A.locals?g.A.locals:void 0},85072:function(e){"use strict";var t=[];function a(e){for(var a=-1,n=0;n<t.length;n++)if(t[n].identifier===e){a=n;break}return a}function n(e,n){for(var i={},r=[],l=0;l<e.length;l++){var s=e[l],d=n.base?s[0]+n.base:s[0],c=i[d]||0,u="".concat(d," ").concat(c);i[d]=c+1;var p=a(u),f={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==p)t[p].references++,t[p].updater(f);else{var m=o(f,n);n.byIndex=l,t.splice(l,0,{identifier:u,updater:m,references:1})}r.push(u)}return r}function o(e,t){var a=t.domAPI(t);return a.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;a.update(e=t)}else a.remove()}}e.exports=function(e,o){var i=n(e=e||[],o=o||{});return function(e){e=e||[];for(var r=0;r<i.length;r++){var l=a(i[r]);t[l].references--}for(var s=n(e,o),d=0;d<i.length;d++){var c=a(i[d]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}i=s}}},77659:function(e){"use strict";var t={};e.exports=function(e,a){var n=function(e){if(void 0===t[e]){var a=document.querySelector(e);if(window.HTMLIFrameElement&&a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(e){a=null}t[e]=a}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(a)}},10540:function(e){"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},55056:function(e,t,a){"use strict";e.exports=function(e){var t=a.nc;t&&e.setAttribute("nonce",t)}},97825:function(e){"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(a){!function(e,t,a){var n="";a.supports&&(n+="@supports (".concat(a.supports,") {")),a.media&&(n+="@media ".concat(a.media," {"));var o=void 0!==a.layer;o&&(n+="@layer".concat(a.layer.length>0?" ".concat(a.layer):""," {")),n+=a.css,o&&(n+="}"),a.media&&(n+="}"),a.supports&&(n+="}");var i=a.sourceMap;i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,a)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},41113:function(e){"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var a=__webpack_module_cache__[e]={id:e,exports:{}};return __webpack_modules__[e](a,a.exports,__webpack_require__),a.exports}__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=function(e,t){for(var a in t)__webpack_require__.o(t,a)&&!__webpack_require__.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nc=void 0;var __webpack_exports__={};__webpack_require__(17618),__webpack_require__(64720),__webpack_require__(53439),__webpack_require__(58917),__webpack_require__(38537),__webpack_require__(22950),__webpack_require__(44447)})();